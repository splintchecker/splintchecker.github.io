<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./usenix01-final_files/filelist.xml">
<title>\documentclass{article}</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>David Evans</o:Author>
  <o:Template>daveoverflow_02_06_01.dot</o:Template>
  <o:LastAuthor>David Evans</o:LastAuthor>
  <o:Revision>4</o:Revision>
  <o:TotalTime>9</o:TotalTime>
  <o:LastPrinted>2001-05-11T21:03:00Z</o:LastPrinted>
  <o:Created>2001-05-11T21:07:00Z</o:Created>
  <o:LastSaved>2001-05-11T21:12:00Z</o:LastSaved>
  <o:Pages>8</o:Pages>
  <o:Words>8478</o:Words>
  <o:Characters>46629</o:Characters>
  <o:Company>University of Virginia</o:Company>
  <o:Lines>1295</o:Lines>
  <o:Paragraphs>287</o:Paragraphs>
  <o:CharactersWithSpaces>59346</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ActiveWritingStyle Lang="EN-US" VendorID="8" DLLVersion="513" NLCheck="0">1</w:ActiveWritingStyle>
  <w:ActiveWritingStyle Lang="FR" VendorID="9" DLLVersion="512" NLCheck="0">1</w:ActiveWritingStyle>
  <w:DoNotShowRevisions/>
  <w:DoNotPrintRevisions/>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.1in;
	text-indent:-.1in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	mso-list:l10 level1 lfo2;
	tab-stops:list .25in;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	mso-font-kerning:0pt;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
h3
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h5
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:13.0pt;
	font-family:"Times New Roman";
	font-weight:bold;
	font-style:italic;}
h6
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:6;
	font-size:10.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:8;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:9;
	font-size:10.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:11.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex2, li.MsoIndex2, div.MsoIndex2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:22.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex3, li.MsoIndex3, div.MsoIndex3
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:33.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex4, li.MsoIndex4, div.MsoIndex4
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:44.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex5, li.MsoIndex5, div.MsoIndex5
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:55.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex6, li.MsoIndex6, div.MsoIndex6
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:66.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex7, li.MsoIndex7, div.MsoIndex7
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:77.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex8, li.MsoIndex8, div.MsoIndex8
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:88.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndex9, li.MsoIndex9, div.MsoIndex9
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:99.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:11.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:22.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:33.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:44.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:55.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:66.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:77.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:88.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoNormalIndent, li.MsoNormalIndent, div.MsoNormalIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:center 3.0in right 6.0in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoIndexHeading, li.MsoIndexHeading, div.MsoIndexHeading
	{mso-style-next:"Index 1";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoTof, li.MsoTof, div.MsoTof
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:22.0pt;
	margin-bottom:.0001pt;
	text-indent:-22.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoEnvelopeAddress, li.MsoEnvelopeAddress, div.MsoEnvelopeAddress
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:2.0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-element:frame;
	mso-element-frame-width:5.5in;
	mso-element-frame-height:99.0pt;
	mso-element-frame-hspace:9.0pt;
	mso-element-wrap:auto;
	mso-element-anchor-horizontal:page;
	mso-element-left:center;
	mso-element-top:bottom;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";}
p.MsoEnvelopeReturn, li.MsoEnvelopeReturn, div.MsoEnvelopeReturn
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";}
span.MsoFootnoteReference
	{vertical-align:super;}
p.MsoEndnoteText, li.MsoEndnoteText, div.MsoEndnoteText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToa, li.MsoToa, div.MsoToa
	{mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:11.0pt;
	margin-bottom:.0001pt;
	text-indent:-11.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoMacroText, li.MsoMacroText, div.MsoMacroText
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:24.0pt 48.0pt 1.0in 96.0pt 120.0pt 2.0in 168.0pt 192.0pt 3.0in;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Tahoma;}
p.MsoToaHeading, li.MsoToaHeading, div.MsoToaHeading
	{mso-style-next:Normal;
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoList, li.MsoList, div.MsoList
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{mso-style-update:auto;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l9 level1 lfo5;
	tab-stops:list .25in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListNumber, li.MsoListNumber, div.MsoListNumber
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l8 level1 lfo8;
	tab-stops:list .25in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoList2, li.MsoList2, div.MsoList2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoList3, li.MsoList3, div.MsoList3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.75in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoList4, li.MsoList4, div.MsoList4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoList5, li.MsoList5, div.MsoList5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListBullet2, li.MsoListBullet2, div.MsoListBullet2
	{mso-style-update:auto;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l7 level1 lfo11;
	tab-stops:list .5in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListBullet3, li.MsoListBullet3, div.MsoListBullet3
	{mso-style-update:auto;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.75in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l6 level1 lfo14;
	tab-stops:list .75in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListBullet4, li.MsoListBullet4, div.MsoListBullet4
	{mso-style-update:auto;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l5 level1 lfo17;
	tab-stops:list 1.0in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListBullet5, li.MsoListBullet5, div.MsoListBullet5
	{mso-style-update:auto;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l4 level1 lfo20;
	tab-stops:list 1.25in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListNumber2, li.MsoListNumber2, div.MsoListNumber2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l3 level1 lfo23;
	tab-stops:list .5in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListNumber3, li.MsoListNumber3, div.MsoListNumber3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.75in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l2 level1 lfo26;
	tab-stops:list .75in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListNumber4, li.MsoListNumber4, div.MsoListNumber4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.0in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l1 level1 lfo29;
	tab-stops:list 1.0in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListNumber5, li.MsoListNumber5, div.MsoListNumber5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:1.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l0 level1 lfo32;
	tab-stops:list 1.25in;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:14.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-font-kerning:14.0pt;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoClosing, li.MsoClosing, div.MsoClosing
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:3.0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoSignature, li.MsoSignature, div.MsoSignature
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:3.0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	font-style:italic;
	mso-bidi-font-style:normal;}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListContinue, li.MsoListContinue, div.MsoListContinue
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListContinue2, li.MsoListContinue2, div.MsoListContinue2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListContinue3, li.MsoListContinue3, div.MsoListContinue3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.75in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListContinue4, li.MsoListContinue4, div.MsoListContinue4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListContinue5, li.MsoListContinue5, div.MsoListContinue5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoMessageHeader, li.MsoMessageHeader, div.MsoMessageHeader
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.75in;
	margin-bottom:.0001pt;
	text-indent:-.75in;
	mso-pagination:widow-orphan;
	background:#CCCCCC;
	mso-shading:windowtext;
	mso-pattern:gray-20 auto;
	border:none;
	mso-border-alt:solid windowtext .75pt;
	padding:0in;
	mso-padding-alt:1.0pt 1.0pt 1.0pt 1.0pt;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	text-align:center;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";}
p.MsoSalutation, li.MsoSalutation, div.MsoSalutation
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoDate, li.MsoDate, div.MsoDate
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextFirstIndent, li.MsoBodyTextFirstIndent, div.MsoBodyTextFirstIndent
	{mso-style-parent:"Body Text";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	text-indent:10.5pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextFirstIndent2, li.MsoBodyTextFirstIndent2, div.MsoBodyTextFirstIndent2
	{mso-style-parent:"Body Text Indent";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	text-indent:10.5pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoNoteHeading, li.MsoNoteHeading, div.MsoNoteHeading
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";}
p.MsoBodyText3, li.MsoBodyText3, div.MsoBodyText3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent2, li.MsoBodyTextIndent2, div.MsoBodyTextIndent2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	line-height:200%;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent3, li.MsoBodyTextIndent3, div.MsoBodyTextIndent3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBlockText, li.MsoBlockText, div.MsoBlockText
	{margin-top:0in;
	margin-right:1.0in;
	margin-bottom:6.0pt;
	margin-left:1.0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:black;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	background:navy;
	font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Courier New";}
p.MsoAutoSig, li.MsoAutoSig, div.MsoAutoSig
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p
	{margin-top:5.0pt;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
address
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	font-style:italic;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Tahoma;}
p.Mytle, li.Mytle, div.Mytle
	{mso-style-name:Mytle;
	mso-style-parent:"Heading 1";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.0in;
	text-indent:.5in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Reference, li.Reference, div.Reference
	{mso-style-name:Reference;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.3in;
	text-indent:-.3in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";}
p.References, li.References, div.References
	{mso-style-name:References;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-language:HE;}
p.Code, li.Code, div.Code
	{mso-style-name:Code;
	mso-style-parent:"Plain Text";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p.k, li.k, div.k
	{mso-style-name:k;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Message, li.Message, div.Message
	{mso-style-name:Message;
	mso-style-parent:Code;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Courier New";}
span.ReferenceFont
	{mso-style-name:ReferenceFont;
	mso-ansi-font-size:11.0pt;}
span.Keyword
	{mso-style-name:Keyword;
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;}
span.pubname
	{mso-style-name:pubname;
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	mso-ascii-font-family:Verdana;
	mso-hansi-font-family:Verdana;
	color:#003366;
	font-weight:bold;}
span.CodeText
	{mso-style-name:CodeText;
	mso-style-parent:Keyword;
	mso-ansi-font-size:9.0pt;
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:Arial;}
ins
	{mso-style-type:export-only;
	text-decoration:none;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 66.0pt 1.0in 66.0pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-even-footer:url("./usenix01-final_files/header.htm") ef1;
	mso-footer:url("./usenix01-final_files/header.htm") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
@page Section2
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-columns:2 even .25in;
	mso-even-footer:url("./usenix01-final_files/header.htm") ef1;
	mso-footer:url("./usenix01-final_files/header.htm") f1;
	mso-paper-source:0;}
div.Section2
	{page:Section2;}
 /* List Definitions */
@list l0
	{mso-list-id:-132;
	mso-list-type:simple;
	mso-list-template-ids:-36646284;}
@list l0:level1
	{mso-level-style-link:"List Number 5";
	mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l1
	{mso-list-id:-131;
	mso-list-type:simple;
	mso-list-template-ids:-611035324;}
@list l1:level1
	{mso-level-style-link:"List Number 4";
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;}
@list l2
	{mso-list-id:-130;
	mso-list-type:simple;
	mso-list-template-ids:1363805998;}
@list l2:level1
	{mso-level-style-link:"List Number 3";
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;}
@list l3
	{mso-list-id:-129;
	mso-list-type:simple;
	mso-list-template-ids:131999994;}
@list l3:level1
	{mso-level-style-link:"List Number 2";
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l4
	{mso-list-id:-128;
	mso-list-type:simple;
	mso-list-template-ids:-709097594;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet 5";
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5
	{mso-list-id:-127;
	mso-list-type:simple;
	mso-list-template-ids:-1465729178;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet 4";
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	margin-left:1.0in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6
	{mso-list-id:-126;
	mso-list-type:simple;
	mso-list-template-ids:-1442053132;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet 3";
	mso-level-text:\F0B7;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l7
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:919232630;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet 2";
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8
	{mso-list-id:-120;
	mso-list-type:simple;
	mso-list-template-ids:-1046293372;}
@list l8:level1
	{mso-level-style-link:"List Number";
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;}
@list l9
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:1160128618;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet";
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l10
	{mso-list-id:815029026;
	mso-list-template-ids:-1375303668;}
@list l10:level1
	{mso-level-start-at:2;
	mso-level-style-link:"Heading 1";
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.1in;
	text-indent:-.1in;}
@list l10:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l10:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l10:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l10:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="5121">
  <o:colormenu v:ext="edit" fillcolor="white"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=black vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=Code><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt;
font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoTitle>Statically Detecting Likely Buffer Overflow Vulnerabilities</p>

<p class=MsoNormal><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>David
Larochelle<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><i style='mso-bidi-font-style:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:
"MS Mincho"'>larochelle@cs.virginia.edu</span></i><i style='mso-bidi-font-style:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:
Arial;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></i></p>

<p class=MsoNormal align=center style='text-align:center'><i style='mso-bidi-font-style:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:
"MS Mincho"'>University of Virginia, Department of Computer Science<o:p></o:p></span></i></p>

<p class=MsoNormal align=center style='margin-top:6.0pt;text-align:center'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>David
Evans<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><i style='mso-bidi-font-style:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:
"MS Mincho"'>evans@cs.virginia.edu</span></i><i style='mso-bidi-font-style:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:
Arial;mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></i></p>

<p class=MsoNormal align=center style='text-align:center'><i style='mso-bidi-font-style:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:
"MS Mincho"'>University of Virginia, Department of Computer Science</span></i><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:
"MS Mincho"'>Abstract<o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify'>Buffer overflow attacks may be
today’s single most important security threat.<span style="mso-spacerun: yes"> 
</span>This paper presents a new approach to mitigating buffer overflow
vulnerabilities by detecting likely vulnerabilities through an analysis of the
program source code.<span style="mso-spacerun: yes">  </span>Our approach
exploits information provided in semantic comments and uses lightweight and
efficient static analyses.<span style="mso-spacerun: yes">   </span>This paper
describes an implementation of our approach that extends the LCLint
annotation-assisted static checking tool.<span style="mso-spacerun: yes"> 
</span>Our tool is as fast as a compiler and nearly as easy to use.<span
style="mso-spacerun: yes">  </span>We present experience using our approach to
detect buffer overflow vulnerabilities in two security-sensitive programs.</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

</div>

<b style='mso-bidi-font-weight:normal'><span style='font-size:12.0pt;
mso-bidi-font-size:10.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:
AR-SA'><br clear=all style='page-break-before:auto;mso-break-type:section-break'>
</span></b>

<div class=Section2>

<p class=MsoNormal style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt'>1.<span
style="mso-spacerun: yes">   </span>Introduction<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='font-size:14.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify'>Buffer overflow attacks are an
important and persistent security problem.<span style="mso-spacerun: yes"> 
</span>Buffer overflows account for approximately half of all security
vulnerabilities [CWPBW00, WFBA00].<span style="mso-spacerun: yes"> 
</span>Richard Pethia of CERT identified buffer overflow attacks as the single
most im­por­tant security problem at a recent software engineering conference
[Pethia00]; Brian Snow of the NSA predicted that buffer overflow attacks would
still be a problem in twenty years [Snow99].<span style="mso-spacerun: yes">   
</span></p>

<p class=MsoBodyText2 style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>Programs written in C are
particularly susceptible to buffer overflow attacks.<span style="mso-spacerun:
yes">  </span>Space and performance were more important design considerations
for C than safety.<span style="mso-spacerun: yes">  </span>Hence, C allows
direct pointer manipulations without any bounds checking.<span
style="mso-spacerun: yes">  </span>The standard C library includes many
functions that are unsafe if they are not used carefully.<span
style="mso-spacerun: yes">  </span>Nevertheless, many security-critical pro­grams
are written in C.</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:9.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Several run-time approaches to mitigating the risks associated
with buffer overflows have been proposed.<span style="mso-spacerun: yes"> 
</span>Despite their availability, these techniques are not used widely enough
to substantially mitigate the effectiveness of buffer overflow attacks.<span
style="mso-spacerun: yes">  </span>The next section describes representative
run-time approaches and speculates on why they are not more widely used.<span
style="mso-spacerun: yes">  </span>We propose, instead, to tackle the problem
by detecting likely buffer overflow vulnerabilities through a static analysis
of program source code.<span style="mso-spacerun: yes">  </span>We have im­ple­ment­ed
a prototype tool that does this by extending LCLint [Evans96].<span
style="mso-spacerun: yes">  </span>Our work differs from other work on static
detection of buffer overflows in three key ways: (1) we exploit semantic
comments added to source code to enable local checking of interprocedural
properties; (2) we focus on lightweight static checking techniques that have
good performance and scalability characteristics, but sacrifice soundness and
completeness; and (3) we introduce loop heuristics, a simple approach for
efficiently analyzing many loops found in typical programs.<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>The next section of this paper provides some background on buffer
overflow attacks and previous attempts to mitigate the problem.<span
style="mso-spacerun: yes">  </span>Section 3 gives an overview of our
approach.<span style="mso-spacerun: yes">  </span>In Section 4, we report on
our experience using our tool on </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>wu-ftpd</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
and </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>BIND</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>, two security-sensitive
programs.<span style="mso-spacerun: yes">  </span>The following two sec­tions
provide some details on how our analysis is done.<span style="mso-spacerun:
yes">  </span>Section&nbsp;7 compares our work to related work on buffer
overflow detection and static analysis.<span style="mso-spacerun: yes"> 
</span></span><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt;
mso-fareast-font-family:"MS Mincho"'><o:p></o:p></span></p>

<h1><a name="_Ref506140809"><![if !supportLists]>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Buffer Overflow Attacks and Defenses</a></h1>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>The simplest buffer overflow attack, <i style='mso-bidi-font-style:
normal'>stack smashing</i> [AlephOne96], overwrites a buffer on the stack to
replace the return address.<span style="mso-spacerun: yes">  </span>When the
function returns, instead of jumping to the return address, control will jump
to the address that was placed on the stack by the attacker.<span
style="mso-spacerun: yes">  </span>This gives the attacker the ability to
execute arbitrary code.<span style="mso-spacerun: yes">  </span>Programs
written in C are particularly susceptible to this type of attack.<span
style="mso-spacerun: yes">  </span>C provides direct low-level memory access
and pointer arithmetic without bounds checking.<span style="mso-spacerun:
yes">   </span>Worse, the standard C library provides unsafe functions (such as
</span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>gets</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>) that write an unbounded amount of
user input into a fixed size buffer without any bounds checking [ISO99].<span
style="mso-spacerun: yes">  </span>Buffers stored on the stack are often passed
to these functions.<span style="mso-spacerun: yes">  </span>To exploit such
vulnerabilities, an attacker merely has to enter an input larger than the size
of the buffer and encode an attack program binary in that input.<span
style="mso-spacerun: yes">  </span>The Internet Worm of 1988 [Spafford88, RE89]
exploited this type of buffer overflow vulnerability in </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>fingerd</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.<span style="mso-spacerun: yes"> 
</span>More so­phis­ti­ca­ted buffer overflow attacks may exploit unsafe buffer
usage on the heap.<span style="mso-spacerun: yes">  </span>This is harder,
since most programs do not jump to addresses loaded from the heap or to code
that is stored in the heap.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Several run-time solutions to buffer overflow attacks have been
proposed.<span style="mso-spacerun: yes">  </span>StackGuard [CPMH+98] is a com­pi­ler
that generates binaries that incorporate code designed to prevent stack
smashing attacks.<span style="mso-spacerun: yes">  </span>It places a special
value on the stack next to the return address, and checks that it has not been
tampered with before jumping.<span style="mso-spacerun: yes">  </span>Baratloo,
Singh and Tsai describe two run-time approaches: one replaces unsafe library
func­tions with safe implementations; the other modifies executables to perform
sanity checking of return ad­dress­es on the stack before they are used
[BST00].<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'>Software fault isolation (SFI) is
a technique that inserts bit mask instructions before memory operations to
prevent access of out-of-range memory [WLAG93].<span style="mso-spacerun:
yes">  </span>This alone does not offer much protection against typical buffer
overflow attacks since it would not prevent a program from writing to the stack
address where the return value is stored.<span style="mso-spacerun: yes"> 
</span>Generalizations of SFI can insert more expressive checking around
potentially dangerous operations <span style='mso-fareast-font-family:"MS Mincho"'>to
restrict the behavior of programs more generally.<span style="mso-spacerun:
yes">  </span>Examples include Janus, which observes and mediates behavior by
monitoring system calls [GWTB96]; Naccio [ET99, Evans00a] and PSLang/PoET [ES99­,
ES00] which transform object programs accord­ing to a safety policy; and
Generic Software Wrappers [FBF99] which wraps system calls with security
checking code.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Buffer overflow attacks can be made more difficult by modifications
to the operating system that put code and data in separate memory segments,
where the code segment is read-only and instructions cannot be executed from
the data segment.<span style="mso-spacerun: yes">  </span>This does not
eliminate the buffer overflow problem, however, since an attacker can still
overwrite an address stored on the stack to make the program jump to any point
in the code segment.<span style="mso-spacerun: yes">  </span>For programs that
use shared libraries, it is often possible for an attacker to jump to an
address in the code segment that can be used maliciously (e.g., a call to </span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
Arial'>system</span></span><span style='mso-fareast-font-family:"MS Mincho"'>).<span
style="mso-spacerun: yes">  </span>Developers decided against using this
approach in the Linux kernel since it did not solve the real problem and it
would prevent legitimate uses of self-modifying code [Torvalds98, Coolbaugh99].<i
style='mso-bidi-font-style:normal'> <o:p></o:p></i></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Despite the availability of these and other run-time approaches,
buffer overflow attacks remain a persistent problem.<span style="mso-spacerun:
yes">  </span>Much of this may be due to lack of awareness of the severity of
the problem and the availability of practical solutions.<span
style="mso-spacerun: yes">  </span>Nevertheless, there are legitimate reasons
why the run-time solutions are unacceptable in some environments.<span
style="mso-spacerun: yes">  </span>Run-time solutions always incur some
performance penalty (StackGuard reports performance overhead of up to 40%
[CBDP+99]).<span style="mso-spacerun: yes">  </span>The other problem with
run-time solutions is that while they may be able to detect or prevent a buffer
overflow attack, they effectively turn it into a denial-of-service attack.<span
style="mso-spacerun: yes">  </span>Upon detecting a buffer overflow, there is
often no way to recover other than terminating execution.<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Static checking overcomes these problems by detecting likely
vulnerabilities before deployment.<span style="mso-spacerun: yes"> 
</span>Detecting buffer overflow vulnerabilities by analyzing code in general
is an undecidable problem.</span><a style='mso-footnote-id:ftn1' href="#_ftn1"
name="_ftnref1" title=""><span class=MsoFootnoteReference><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><span
style='mso-special-character:footnote'><![if !supportFootnotes]>[1]<![endif]></span></span></span></a><span
style='mso-fareast-font-family:"MS Mincho"'><span style="mso-spacerun: yes"> 
</span>Nevertheless, it is possible to produce useful results using static
analysis.<span style="mso-spacerun: yes">  </span>Rather than attempting to
verify that a program has no buffer overflow vulnerabilities, we wish to have
reasonable confidence of detecting a high fraction of likely buffer overflow
vulnerabilities.<span style="mso-spacerun: yes">  </span>We are willing to
accept a solution that is both unsound and incomplete.<span
style="mso-spacerun: yes">  </span>This means that our checker will sometimes
generate false warnings and sometimes miss real problems.<span
style="mso-spacerun: yes">  </span>Our goal is to produce a tool that produces
useful results for real programs with a reasonable effort.<span
style="mso-spacerun: yes">  </span>The next section describes our
approach.<span style="mso-spacerun: yes">  </span>We compare our work with
other static approaches to detecting buffer overflow vulnerabilities in Section
<span style='mso-field-code:"REF _Ref506088607 \\r \\h &#1; \\* MERGEFORMAT"'>7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F005200650066003500300036003000380038003600300037000000</w:data>
</xml><![endif]--></span>.</span></p>

<h1 style='text-align:justify'><a name="_Ref505915643"><![if !supportLists]>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><![endif]>Approach</a></h1>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Our static analysis tool is built upon LCLint [EGHT94, Evans96,
Evans00b], an annotation-assisted lightweight static checking tool.<span
style="mso-spacerun: yes">  </span>Examples of problems detected by<span
style="mso-spacerun: yes">  </span>LCLint include </span>violations of
information hiding, inconsistent modifications of caller-visible state or uses
of global variables, misuses of possibly <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>NULL</span></span>
references, uses of dead storage, memory leaks and problems with parameters
aliasing.<span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">  </span>LCLint is actually used by working
programmers, especially in the open source development community [</span>Orcero<span
style='mso-fareast-font-family:"MS Mincho"'>00, PG00].<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Our approach is to exploit semantic comments (henceforth called <i
style='mso-bidi-font-style:normal'>annotations</i>) that are added to source
code and standard libraries.<span style="mso-spacerun: yes"> 
</span>Annotations describe programmer assumptions and intents. They are
treated as regular C comments by the compiler, but recognized as syntactic
entities by LCLint using the </span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'>@</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> following the </span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
Arial'>/*</span></span><span style='mso-fareast-font-family:"MS Mincho"'> to
identify a semantic comment.<span style="mso-spacerun: yes">  </span>For
example, the annotation </span><span class=CodeText><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:Arial'>/*@notnull@*/</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> can be used syntactically like a
type qualifier.<span style="mso-spacerun: yes">  </span>In a parameter
declaration, it indicates that the value passed for this parameter may not be </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>NULL</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.<span style="mso-spacerun: yes"> 
</span>Although annotations can be used on any declaration, for this discussion
we will focus exclusively on function and parameter declarations.<span
style="mso-spacerun: yes">  </span>We can also use annotations similarly in
declarations of global and local variables, types and type fields.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Annotations constrain the possible values a reference can contain
either before or after a function call.<span style="mso-spacerun: yes"> 
</span>For example, the </span><span class=CodeText><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:Arial'>/*@notnull@*/</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> annotation places a constraint on
the parameter value before the function body is entered.<span
style="mso-spacerun: yes">  </span>When LCLint checks the function body, it
assumes the initial value of the parameter is not </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>NULL</span></span><span style='mso-fareast-font-family:"MS Mincho"'>.<span
style="mso-spacerun: yes">  </span>When LCLint checks a call site, it reports a
warning unless it can determine that the value passed as the corresponding
parameter is never </span><span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>NULL</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Prior to this work, all annotations supported by LCLint classified
references as being in one of a small number of possible states.<span
style="mso-spacerun: yes">  </span>For example, the annotation </span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
Arial'>/*@null@*/</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
indicated that a reference may be </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>NULL</span></span><span style='mso-fareast-font-family:"MS Mincho"'>,
and the annotation </span><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:Arial'><a href="mailto:/*@notnull@*/"><span
style='text-decoration:none;text-underline:none'>/*@notnull@*/</span></a></span></span><span
style='mso-fareast-font-family:"MS Mincho"'> indicated that a reference is not </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>NULL</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.<span style="mso-spacerun: yes"> 
</span>In order to do useful checking of buffer overflow vulnerabilities, we
need annotations that are more expressive.<span style="mso-spacerun: yes"> 
</span>We are concerned with how much memory has been allocated for a buffer,
something that cannot be adequately modeled using a finite number of states.<span
style="mso-spacerun: yes">  </span>Hence, we need to extend LCLint to support a
more general annotation language.<span style="mso-spacerun: yes">  </span>The
annotations are more expressive, but still within the spirit of simple semantic
comments added to programs.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>The new annotations allow programmers to explicitly state function
preconditions and postconditions using </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>requires</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
and </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>ensures</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> clauses.</span><a
style='mso-footnote-id:ftn2' href="#_ftn2" name="_ftnref2" title=""><span
class=MsoFootnoteReference><span style='font-size:9.5pt;mso-bidi-font-size:
10.0pt;mso-fareast-font-family:"MS Mincho"'><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[2]<![endif]></span></span></span></a><span
style='mso-fareast-font-family:"MS Mincho"'><span style="mso-spacerun: yes"> 
</span>We can use these clauses to describe assumptions about buffers that are
passed to functions and constrain the state of buffers when functions
return.<span style="mso-spacerun: yes">  </span>For the analyses described in
this paper, four kinds of assumptions and constraints are used: </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minSet</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>, </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>maxSet</span></span><span style='mso-fareast-font-family:"MS Mincho"'>,
</span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minRead</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> and </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>maxRead</span></span><span style='mso-fareast-font-family:"MS Mincho"'>.</span><a
style='mso-footnote-id:ftn3' href="#_ftn3" name="_ftnref3" title=""><span
class=MsoFootnoteReference><span style='font-size:9.5pt;mso-bidi-font-size:
10.0pt;mso-fareast-font-family:"MS Mincho"'><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[3]<![endif]></span></span></span></a><span
style='mso-fareast-font-family:"MS Mincho"'> <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><span
style='mso-fareast-font-family:"MS Mincho"'>When used in a </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>requires</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> clause, the </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minSet</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> and </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>maxSet</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
annotations describe assumptions about the lowest and highest indices of a
buffer that may be safely used as an </span>lvalue<span style='mso-fareast-font-family:
"MS Mincho"'> (e.g., on the left-hand side of an assignment).<span
style="mso-spacerun: yes">  </span>For example, consider a function with an
array parameter </span><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:Arial'>a</span></span><span style='mso-fareast-font-family:
"MS Mincho"'> and an integer parameter </span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'>i</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> that has a pre­condition </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>requires maxSet(a) &gt;=
i</span></span><span style='mso-fareast-font-family:"MS Mincho"'>.<span
style="mso-spacerun: yes">  </span>The analysis assumes that at the beginning
of the function body, </span><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:Arial'>a[i]</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> may be used as an lvalue.<span
style="mso-spacerun: yes">  </span>If </span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'>a[i+1]</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> were used before any modifications
to the value of </span><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:Arial'>a</span></span><span style='mso-fareast-font-family:
"MS Mincho"'> or </span><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:Arial'>i</span></span><span style='mso-fareast-font-family:
"MS Mincho"'>, LCLint would generate a warning since the function preconditions
are not sufficient to guarantee that </span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'>a[i+1]</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> can be used safely as an
lvalue.<span style="mso-spacerun: yes">  </span>Arrays in C start with index </span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
Arial'>0</span></span><span style='mso-fareast-font-family:"MS Mincho"'>, so
the declaration <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><span style="mso-spacerun: yes">         </span></span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
Arial'>char buf[MAXSIZE]</span></span><span style='mso-fareast-font-family:
"MS Mincho"'> <o:p></o:p></span></p>

<p class=Code style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in'><span style='font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-bidi-font-family:"Courier New"'>generates the constraints <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><span style="mso-spacerun: yes">         </span></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxSet(buf) = MAXSIZE –
1</span></span><span style='mso-fareast-font-family:"MS Mincho"'> and </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minSet(buf) = 0</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'><span
style='mso-fareast-font-family:"MS Mincho"'>Similarly, the </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minRead</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> and </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>maxRead</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
constraints indicate the minimum and maximum indices of a buffer that may be
read safely.<span style="mso-spacerun: yes">  </span>The value of </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxRead</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> for a given buffer is always less
than or equal to the value of </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>maxSet</span></span><span style='mso-fareast-font-family:"MS Mincho"'>.<span
style="mso-spacerun: yes">  </span>In cases where there are elements of the
buffer have not yet been initialized, the value of </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>maxRead</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
may be lower than the value of </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>maxSet</span></span><span style='mso-fareast-font-family:"MS Mincho"'>.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>At a call site, LCLint checks that the preconditions implied by
the </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>requires</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> clause of the called function are
satisfied before the call.<span style="mso-spacerun: yes">  </span>Hence, for
the </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>requires
maxSet(a) &gt;= i</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
example, it would issue a warning if it cannot determine that the array passed
as </span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:Arial'>a</span></span><span style='mso-fareast-font-family:
"MS Mincho"'> is allocated to hold at least as many elements as the value
passed as </span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:Arial'>i</span></span><span style='mso-fareast-font-family:
"MS Mincho"'>.<span style="mso-spacerun: yes">  </span>If </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minSet</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> or </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>maxSet</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
is used in an </span><span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>ensures</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> clause, it indicates the state of a
buffer after the function returns.<span style="mso-spacerun: yes"> 
</span>Checking at the call site proceeds by assuming the postconditions are
true after the call returns.<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>For checking, we use an annotated version of the standard library
headers.<span style="mso-spacerun: yes">  </span>For example, the function </span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
Arial'>strcpy</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
is annotated as</span><a style='mso-footnote-id:ftn4' href="#_ftn4"
name="_ftnref4" title=""><span class=MsoFootnoteReference><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><span
style='mso-special-character:footnote'><![if !supportFootnotes]>[4]<![endif]></span></span></span></a><span
style='mso-fareast-font-family:"MS Mincho"'>: <o:p></o:p></span></p>

<p class=Code style='margin-top:6.0pt;text-align:justify'><span class=CodeText><span
style='mso-fareast-font-family:"MS Mincho"'>char *</span>strcpy (char *</span><span
class=CodeText><span style='mso-fareast-font-family:"MS Mincho"'>s1, const char
*s2)<span style="mso-spacerun: yes">     </span><o:p></o:p></span></span></p>

<p class=Code style='text-align:justify'><span class=CodeText><span
style='mso-fareast-font-family:"MS Mincho"'><span style="mso-spacerun:
yes"> </span>/*@requires maxSet(s1) &gt;= maxRead(s2)@*/ <o:p></o:p></span></span></p>

<p class=Code style='text-align:justify'><span class=CodeText><span
style='mso-fareast-font-family:"MS Mincho"'><span style="mso-spacerun:
yes"> </span>/*@ensures maxRead(s1) == maxRead(s2) /\ result == s1@*/;<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'><span
style='mso-fareast-font-family:"MS Mincho"'>The </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>requires</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
clause specifies the precondition that the buffer </span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'>s1</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> is allocated to hold at least as
many char­acters as are readable in the buffer </span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'>s2</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> (that is, the number of characters
up to and including its null terminator).<span style="mso-spacerun: yes"> 
</span>The postcondition reflects the behavior of </span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'>strcpy</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> – it copies the string pointed to
by </span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:Arial'>s2</span></span><span style='mso-fareast-font-family:
"MS Mincho"'> into the buffer </span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'>s1</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>, and returns that buffer.<span
style="mso-spacerun: yes">  </span>In </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>ensures</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
clauses, we use the </span><span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>result</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> keyword to denote the value
returned by the function.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Many buffer overflows result from using library functions such as </span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
Arial'>strcpy</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
in unsafe ways.<span style="mso-spacerun: yes">  </span>By annotating the
standard library, many buffer overflow vulnerabilities can be detected even
before adding any annotations to the target program.<span style="mso-spacerun:
yes">  </span>Selected annotated standard library functions are shown in
Appendix A.</span><span style="mso-spacerun: yes">   </span></p>

<h1 style='text-align:justify'><![if !supportLists]>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Experience</h1>

<p class=MsoNormal style='text-align:justify'>In order to test our approach, we
used our tool on <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>wu-ftpd</span></span>, a popular open source ftp
server, and <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>BIND </span></span>(Berkeley Internet Name Domain), a
set of domain name tools and libraries that is considered the reference
implementation of DNS.<span style="mso-spacerun: yes">  </span>This section
describes the process of running LCLint on these applications, and illustrates
how our checking detected both known and unknown buffer overflow
vulnerabilities in each<span style="mso-spacerun: yes">  </span>appli­cation.</p>

<h2>4.1 wu-ftpd</h2>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>We analyzed <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>wu-ftp-2.5.0</span></span><a style='mso-footnote-id:ftn5'
href="#_ftn5" name="_ftnref5" title=""><span class=MsoFootnoteReference><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[5]<![endif]></span></span></span></a>, a
version with known se­cur­ity vulnerabilities.<span style="mso-spacerun: yes"> 
</span></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Running
LCLint is similar to running a compiler.<span style="mso-spacerun: yes"> 
</span>It is typically run from the command line by listing the source code
files to check, along with flags that set checking parameters and control which
classes of warnings are reported.<span style="mso-spacerun: yes">  </span>It
takes just over a minute for LCLint to analyze all 17&nbsp;000 lines of <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>wu-ftpd</span></span>.<span style="mso-spacerun: yes"> 
</span>Running LCLint on the entire unmodified source code for <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>wu-ftpd</span></span> without adding any annotations
resulted in 243 warnings related to buffer overflow checking.</p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Consider a
representative message<a style='mso-footnote-id:ftn6' href="#_ftn6"
name="_ftnref6" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]>[6]<![endif]></span></span></a>:</p>

<p class=Message>ftpd.c:1112:2: Possible out-of-bounds store.<span
style="mso-spacerun: yes">  </span>Unable to </p>

<p class=Message><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes"> </span><span style="mso-spacerun: yes"> </span>resolve
constraint: </p>

<p class=Message><span style="mso-spacerun: yes">      </span>maxRead
((entry-&gt;arg[0] @ ftpd.c:1112:23)) &lt;= (1023)</p>

<p class=Message><span style="mso-spacerun: yes">   </span>needed to satisfy
precondition: </p>

<p class=Message><span style="mso-spacerun: yes">      </span>requires maxSet
((ls_short @ ftpd.c:1112:14)) </p>

<p class=Message><span style="mso-spacerun: yes">                  </span>&gt;=
maxRead ((entry-&gt;arg[0] @ ftpd.c:1112:23))</p>

<p class=Message><span style="mso-spacerun: yes">   </span>derived from strcpy
precondition:</p>

<p class=Message><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes">   </span>requires maxSet (&lt;param 1&gt;) &gt;=
maxRead (&lt;param 2&gt;)<span class=Keyword><span style='font-size:8.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'> <o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;text-align:justify'>Relevant code fragments are shown below
with line 1112 in bold:<span style="mso-spacerun: yes">  </span></p>

<p class=Code><span class=CodeText>char<span style="mso-spacerun: yes"> 
</span>ls_short[1024];<o:p></o:p></span></p>

<p class=Code><span class=CodeText>…<o:p></o:p></span></p>

<p class=Code><span class=CodeText>extern struct aclmember * getaclentry(char
*keyword, struct aclmember **next);<o:p></o:p></span></p>

<p class=Code><span class=CodeText>…<o:p></o:p></span></p>

<p class=Code><span class=CodeText>int main(int argc, char **argv, char **envp)<o:p></o:p></span></p>

<p class=Code><span class=CodeText>{<o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes">   </span>…<o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes">  
</span>entry = (struct aclmember *) NULL;<o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes">   </span>if
(getaclentry(&quot;ls_short&quot;, &amp;entry) <o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes">      
</span>&amp;&amp; entry-&gt;arg[0] <o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes">      
</span>&amp;&amp; (int)strlen(entry-&gt;arg[0]) &gt; 0) <o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes">     
</span>{<o:p></o:p></span></p>

<p class=Code><span class=CodeText><b style='mso-bidi-font-weight:normal'><span
style="mso-spacerun: yes">        </span>strcpy(ls_short,entry-&gt;arg[0]);<o:p></o:p></b></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes">       
</span>…<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'>This code is
part of the initialization code that reads configuration files.<span
style="mso-spacerun: yes">  </span>Several buffer overflow vul­ner­a­bil­i­­ties
were found in the <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>wu-ftpd</span></span> initialization code.<span
style="mso-spacerun: yes">  </span>Although this vulnerability is not likely to
be exploited, it can cause security holes if an untrustworthy user is able to
alter configuration files.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'><span
style='mso-fareast-font-family:"MS Mincho"'>The warning message indicates that </span>a
possible out-of-bounds store was detected on line 1112 and <span
style='mso-fareast-font-family:"MS Mincho"'>contains information about the
constraint LCLint was unable to resolve.<span style="mso-spacerun: yes"> 
</span>The warning results from the function call to </span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>strcpy</span></span>.<span
style="mso-spacerun: yes">  </span>LCLint generates a pre­con­dit­ion
constraint corresponding to the <span class=CodeText><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:
Arial'>strcpy</span></span> <span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>requires</span></span> clause <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxSet(s1) &gt;=
maxRead(s2)</span></span><span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;mso-ascii-font-family:"Times New Roman";mso-fareast-font-family:
"MS Mincho";mso-hansi-font-family:"Times New Roman"'> </span></span>by
substituting the actual parameters: </p>

<p class=MsoNormal style='text-align:justify'><span style="mso-spacerun:
yes">   </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>maxSet (ls_short @ ftpd.c:1112:14) &gt;= maxRead
(entry-&gt;arg[0] @ ftpd.c:1112:23)</span></span>.<span style="mso-spacerun:
yes">  </span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'>Note that the
locations of the expressions passed as actual parameters are recorded in the
constraint.<span style="mso-spacerun: yes">  </span>Since values of expressions
may change through the code, it is important that constraints identify values
at particular program points.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'>The global
variable <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>ls_short</span></span>
was declared as an array of 1024 characters.<span style="mso-spacerun: yes"> 
</span>Hence, LCLint determines <span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>maxSet (ls_short)</span></span>
is 1023.<span style="mso-spacerun: yes">  </span>After the call to <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>getaclentry</span></span>,
the local <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>entry-&gt;arg[0]</span></span>
points to a string of arbitrary length read from the configuration file.<span
style="mso-spacerun: yes">  </span>Because there are no annotations on the <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>getaclentry</span></span>
function, LCLint does not assume anything about its behavior.<span
style="mso-spacerun: yes">  </span>In particular, the value of <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>maxRead (entry-&gt;arg[0])</span></span> is unknown. LCLint reports
a possible buffer misuse, since the constraint derived from the <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>strcpy</span></span> <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>requires</span></span> clause may not be satisfied if the
value of <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>maxRead (entry-&gt;arg[0])</span></span> is greater
than 1023.</p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:9.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'>To fix this problem, we
modified the code to handle these values safely by using<span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'> strncpy</span></span>.<span style="mso-spacerun:
yes">  </span>Since <span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>ls_short</span></span>
is a fixed size buffer, a simple change to use <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>strncpy</span></span> and store a null character at
the end of the buffer is sufficient to ensure that the code is safe.<a
style='mso-footnote-id:ftn7' href="#_ftn7" name="_ftnref7" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]>[7]<![endif]></span></span></a><span
style="mso-spacerun: yes">  </span></p>

<p class=MsoPlainText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoPlainText style='margin-bottom:6.0pt;text-align:justify'>In other
cases, eliminating a vulnerability involved both changing the code and adding
annotations.<span style="mso-spacerun: yes">  </span>For example, LCLint
generated a warning for a call to <span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New"'>strcpy</span> in the function <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>acl_getlimit</span></span>:
</p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>int acl_getlimit(char *class, char *msgpathbuf) {<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes"> </span>int limit;<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes"> </span>struct
aclmember *entry = NULL;<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes"> </span>if (msgpathbuf) *msgpathbuf = '\0';<o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes"> </span>while (getaclentry(&quot;limit&quot;,
&amp;entry)) {<o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">   </span>…<o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">   </span>if (!strcasecmp(class, entry-&gt;arg[0]))<o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">   </span>{<o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">     </span>…<o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">     </span>if (entry-&gt;arg[3] <o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">         </span>&amp;&amp; msgpathbuf != NULL)<o:p></o:p></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">       </span><b style='mso-bidi-font-weight:normal'>strcpy(msgpathbuf,
entry-&gt;arg[3]);<o:p></o:p></b></span></span></p>

<p class=MsoPlainText><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">     </span>…<o:p></o:p></span></span></p>

<p class=MsoPlainText style='margin-top:6.0pt;margin-right:0in;margin-bottom:
6.0pt;margin-left:0in;text-align:justify'>If the size of <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>msgputhbuf</span></span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'> </span></span>is
less than the length of the string in <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>entry-&gt;arg[3]</span></span>, there is a buffer
overflow.<span style="mso-spacerun: yes">  </span>To fix this we replaced the <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>strcpy </span></span>call
with a safe call to <span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>strncpy</span></span><span
class=CodeText><span style='mso-ansi-font-size:10.0pt;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>:</span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun:
yes"> </span>strncpy(msgpathbuf, entry-&gt;arg[3], 199);<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun:
yes"> </span>msgpathbuf[199] = '\0';</span></span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'><span
style="mso-spacerun: yes">         </span></span></span></p>

<p class=MsoPlainText style='margin-top:6.0pt;margin-right:0in;margin-bottom:
6.0pt;margin-left:0in;text-align:justify'>and added a <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>requires</span></span>
clause to the function declaration:</p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes"> </span><a
href="mailto:/*@requires"><span style='color:windowtext;text-decoration:none;
text-underline:none'>/*@requires</span></a> maxSet(msgpathbuf) &gt;= 199@*/<o:p></o:p></span></span></p>

<p class=MsoPlainText style='margin-top:6.0pt;text-align:justify'>The <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>requires</span></span> clause documents an assumption (that
may be incorrect) about the size of the buffer passed to <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>acl_getlimit</span></span>.<span
style="mso-spacerun: yes">  </span>Because of the constraints denoted by the <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>requires</span></span> clauses, LCLint does not report a
warning for the call to <span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>strncpy</span></span>.
</p>

<p class=MsoPlainText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoPlainText style='text-align:justify'>When call sites are checked,
LCLint produces a warn­ing if it is unable to determine that this <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>requires</span></span> clause is satisfied.<span
style="mso-spacerun: yes">  </span>Originally, we had modified the function <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>acl_getlimit</span></span>
by adding the precondition <span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>maxSet (msgpathbuf) &gt;= 1023</span></span>.<span
style="mso-spacerun: yes">  </span>After adding this precondition, LCLint
produced a warning for a call site that passed a 200-byte buffer to <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>acl_getlimit</span></span>.<span
style="mso-spacerun: yes">  </span>Hence, we re­placed the <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>requires</span></span>
clause with the stronger constraint and used 199 as the parameter to <span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>strncpy</span>.</p>

<p class=MsoPlainText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>This vulnerability was still
present in the current ver­sion of <span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span>.<span
style="mso-spacerun: yes">  </span>We contacted the <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span>
developers who acknowledged the bug but did not consider it security critical
since the string in question is read from a local file not user input
[Luckin01, Lundberg01].</p>

<p class=MsoPlainText style='text-align:justify'><span style="mso-spacerun:
yes"> </span></p>

<p class=MsoPlainText style='text-align:justify'>In addition to the previously
unreported buffer overflows in the initialization code, LCLint detected a known
buffer overflow in <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>wu-ftpd</span></span>.<span style="mso-spacerun:
yes">  </span>The buffer overflow occurs in the function <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>do_elem</span></span> shown below, which passes a
global buffer and its parameters to the library function <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>strcat</span></span>.<span style="mso-spacerun:
yes">  </span>The function <span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>mapping_chdir</span></span>
calls <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>do_elem</span></span>
with a value entered by the remote user as its parameter.<span
style="mso-spacerun: yes">  </span>Because <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span>
fails to perform sufficient bounds checking, a remote user is able to exploit
this vulnerability to overflow the buffer by carefully creating a series of
directories and executing the <span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>cd</span></span> command.<a
style='mso-footnote-id:ftn8' href="#_ftn8" name="_ftnref8" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]>[8]<![endif]></span></span></a></p>

<p class=MsoPlainText style='text-align:justify'><span style="mso-spacerun:
yes"> </span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>char mapped_path [200];<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>…<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>void do_elem(char *dir) {<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">   </span>…<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">   </span>if
(!(mapped_path[0] == '/' <o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">      
</span>&amp;&amp; mapped_path[1] == '\0'))<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">     </span><b>strcat
(mapped_path, &quot;/&quot;);<o:p></o:p></b></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><b
style='mso-bidi-font-weight:normal'><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">   </span>strcat (mapped_path, dir);<o:p></o:p></span></b></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>}<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoPlainText style='margin-bottom:6.0pt;text-align:justify'>LCLint
generates warnings for the unsafe calls to <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>strcat</span></span>.<span style="mso-spacerun:
yes">  </span>This was fixed in latter versions of <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span>
by calling <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>strncat</span></span>
instead of <span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:
"Courier New"'>strcat</span>. </p>

<p class=MsoPlainText style='margin-bottom:6.0pt;text-align:justify'>Because of
the limitations of static checking, LCLint some­­times generates spurious error
messages.<span style="mso-spacerun: yes">  </span>If the user believes the code
is correct, annotations can be added to precisely suppress spurious
messages.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoPlainText style='margin-bottom:6.0pt;text-align:justify'>Often the
code was too complex for LCLint to analyze correctly.<span style="mso-spacerun:
yes">  </span>For example, LCLint reports a spurious warning for this code
fragment since it cannot determine that <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>((1.0*j*rand()) / (RAND_MAX + 1.0))</span></span>
always produces a value between <span class=CodeText><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:
Arial'>1</span></span> and <span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>j</span></span>:</p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">  </span></span></span><span
class=CodeText><span lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial;mso-ansi-language:FR'>i =
passive_port_max <o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial;mso-ansi-language:FR'><span style="mso-spacerun:
yes">      </span>– passive_port_min + 1;<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial;mso-ansi-language:FR'><span style="mso-spacerun:
yes">  </span></span></span><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>port_array
= calloc (i, sizeof (int));<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">  </span>for (i =
3; … &amp;&amp; (i &gt; 0); i--) {<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">    </span></span></span><span
class=CodeText><span lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial;mso-ansi-language:FR'>for
(j = passive_port_max <o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial;mso-ansi-language:FR'><span style="mso-spacerun:
yes">             </span>– passive_port_min + 1;<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial;mso-ansi-language:FR'><span style="mso-spacerun:
yes">         </span></span></span><span class=CodeText><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:
Arial'>… &amp;&amp; (j &gt; 0); j--) {<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">       </span>k =
(int) ((1.0 * j * rand()) <o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'><span style="mso-spacerun: yes">                 
</span></span></span><span class=CodeText><span lang=FR style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial;
mso-ansi-language:FR'>/ (RAND_MAX + 1.0));<o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial;mso-ansi-language:FR'><span style="mso-spacerun:
yes">       </span>pasv_port_array [j-1] <o:p></o:p></span></span></p>

<p class=MsoPlainText style='text-align:justify'><span class=CodeText><span
lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial;mso-ansi-language:FR'><span style="mso-spacerun:
yes">          </span>= <b style='mso-bidi-font-weight:normal'>port_array [k]</b>;<o:p></o:p></span></span></p>

<p class=MsoPlainText style='margin-top:6.0pt;text-align:justify'>Determining
that the <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>port_array[k]</span></span>
reference is safe would require far deeper analysis and more precise
specifications than is feasible within a lightweight static checking tool.</p>

<p class=MsoPlainText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoPlainText style='text-align:justify'>Detecting buffer overflows
with LCLint is an iterative process.<span style="mso-spacerun: yes">  
</span>Many of the constraints we found involved functions that are potentially
unsafe.<span style="mso-spacerun: yes">  </span>We added function preconditions
to satisfy these constraints where possible.<span style="mso-spacerun: yes"> 
</span>In certain cases, the code was too convoluted for LCLint to determine
that our preconditions satisfied the constraints.<span style="mso-spacerun:
yes">  </span>After convincing ourselves the code was correct, we added
annotations to suppress the spurious warnings.</p>

<p class=MsoPlainText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoPlainText style='text-align:justify'>Before any annotations were
added, running LCLint on <span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span> re­sulted in
243 warn­ings each corresponding to an unresolved constraint.<span
style="mso-spacerun: yes">   </span>We added 22 annotations to the source code
through an iterative process similar to the examples described above.<span
style="mso-spacerun: yes">  </span>Nearly all of the annotations were used to
indicate preconditions constraining the value of <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>maxSet</span></span>
for function parameters.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoPlainText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoPlainText style='text-align:justify'>After adding these annotations
and modifying the code, running LCLint produced 143 warnings.<span
style="mso-spacerun: yes">  </span>Of these, 88 reported unresolved constraints
involving <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxSet</span></span>.<span
style="mso-spacerun: yes">  </span>While we believe the remaining warnings did
not indicate bugs in <span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span>, LCLint’s
analyses were not sufficiently powerful to determine the code was safe.<span
style="mso-spacerun: yes">  </span>Although this is a higher number of spurious
warnings than we would like, most of the spurious warnings can be quickly
understood and suppressed by the user.<span style="mso-spacerun: yes">  </span>The
source code contains 225 calls to the potentially buffer overflowing functions <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>strcat</span></span>, <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>strcpy</span></span>, <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>strncat</span></span>, <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>strncpy</span></span><span
class=CodeText><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>,
</span></span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>fgets</span></span>
and <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>gets</span></span>.<span
style="mso-spacerun: yes">  </span>Only 18 of the unresolved warnings resulted
from calls to these functions.<span style="mso-spacerun: yes">  </span>Hence,
LCLint is able to determine that 92% of these calls are safe
automatically.<span style="mso-spacerun: yes">  </span>The other warnings all
dealt with classes of problems that could not be detected through simple
lexical techniques. </p>

<h2>4.2 BIND</h2>

<p class=MsoNormal style='text-align:justify'><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>
is a key component of the Internet infrastructure.<span style="mso-spacerun:
yes">  </span>Recently, the Wall Street Journal iden­ti­fied buffer overflow
vulnerabilities in <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>BIND</span></span> as a critical threat to the
Internet [WSJ01].<span style="mso-spacerun: yes">  </span>We focus on <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>named</span></span>, the DNS sever portion of <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>BIND</span></span>, in this case study.<span
style="mso-spacerun: yes">  </span>We analyzed <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>
version 8.2.2p7<a style='mso-footnote-id:ftn9' href="#_ftn9" name="_ftnref9"
title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[9]<![endif]></span></span></a>, a version
with known bugs.<span style="mso-spacerun: yes">  </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>
is larger and more complex than <span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span>. The
name server portion of <span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>, <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>named</span></span>, contains approximately 47 000 lines of
C including shared li­bra­ries.<span style="mso-spacerun: yes">  </span>LCLint
took less than three and a half minutes to check all of the <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>named</span></span> code.<span style="mso-spacerun: yes"> 
</span></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>We limited our analysis to a
subset of <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>named</span></span> because of the time required for
human analysis. We focused on three files: <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>ns_req.c</span></span>
and two library files that contain functions which are called extensively by <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>ns_req.c</span></span>:<span style="mso-spacerun: yes"> 
</span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>ns_name.c</span></span> and <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>ns_sign.c</span></span>.<span
style="mso-spacerun: yes">  </span>These files contain slightly more than 3 000
lines of code.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>
makes extensive use of functions in its internal library rather than C library
functions. In order to accurately analyze individual files, we needed to
annotate the library header files.<span style="mso-spacerun: yes">  </span>The
most accurate way to annotate the library would be to iteratively run LCLint on
the library and add annotations.<span style="mso-spacerun: yes"> 
</span>However, the library was extremely large and contains deeply nested call
chains.<span style="mso-spacerun: yes">  </span>To avoid the human analysis
this would require, we added annotations to some of the library functions
without annotating all the dependent functions.<span style="mso-spacerun:
yes">  </span>In many cases, we were able to guess preconditions by using
comments or the names of function parameters.<span style="mso-spacerun: yes"> 
</span>For example, several functions took a pointer parameter (<span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>p</span></span>) and another parameter encoding it size (<span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>psize</span></span>), from which we inferred a precondition <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>MaxSet(p) &gt;= (psize – 1)</span></span>.<span
style="mso-spacerun: yes">  </span>After annotating selected <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>BIND</span></span> library functions, we were able to check
the chosen files without needing to fully annotate all of <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>LCLint produces warnings for a
series of unguarded buffer writes in the function <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>req_query</span></span>.<span style="mso-spacerun:
yes">  </span>The code in question is called in response to a specific type of
query which requests information concerning the domain name server version. <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>BIND</span></span> appends a response to the buffer
containing the query that includes a global string read from a configuration
file.<span style="mso-spacerun: yes">  </span>If the default configuration is
used, the code is safe because this function is only called with buffers that
are large enough to store the response.<span style="mso-spacerun: yes"> 
</span>However, the restrictions on the safe use of this function are not
obvious and could easily be overlooked by someone modifying the code.<span
style="mso-spacerun: yes">  </span>Additionally, it is possible that an
administrator could reconfigure <span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span> to use a
value for the server version string large enough to make the code unsafe.<span
style="mso-spacerun: yes">  </span>The <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>
developers agreed that a bounds check should be inserted to eliminate this risk
[Andrews01].</p>

<p class=MsoNormal style='text-align:justify'><span style="mso-spacerun:
yes"> </span></p>

<p class=MsoNormal style='text-align:justify'><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>
uses extensive run time bounds checking. This type of defensive programming is important
for writing secure programs, but does not guarantee that a program is
secure.<span style="mso-spacerun: yes">  </span>LCLint detected a known buffer
overflow in a function that used run time checking but specified buffer sizes
incorrectly.<a style='mso-footnote-id:ftn10' href="#_ftn10" name="_ftnref10"
title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[10]<![endif]></span></span></a></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>The function <span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:"Times New Roman"'>ns_req</span> examines a DNS query and
gen­er­ates a response.<span style="mso-spacerun: yes">  </span>As part of its
message processing, it looks for a signature and signs its response with the
function <span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:
"Courier New";mso-bidi-font-family:"Times New Roman"'>ns_sign</span>.<span
style="mso-spacerun: yes">  </span>LCLint reported that it was unable to
satisfy a precondition for <span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>ns_sign</span><span
style='font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'> </span>that
requires the size of the message buffer be accurately described by a size
parameter.<span style="mso-spacerun: yes">  </span>This precondition was added
when we initially annotated the shared library.<span style="mso-spacerun:
yes">  </span>A careful hand analysis of this function reveals that to due to
careless modification of variables denoting buffer length, it is possible for
the buffer length to be specified incorrectly if the message contains a
signature but a valid key is not found.<span style="mso-spacerun: yes"> 
</span>This buffer overflow vulnerability was introduced when a digital
signature feature was added to <span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span> (ironically to
increase security).<span style="mso-spacerun: yes">  </span>Static analysis
tools can be used to quickly alert programmers to assumptions that are broken
by incremental code changes.</p>

<p class=MsoNormal style='text-align:justify'><span style='mso-tab-count:2'>                                </span><span
style='color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:black'>Based
on our case studies, we believe that LCLint is a useful tool for improving the
security of programs.<span style="mso-spacerun: yes">  </span>It does not
detect all possible buffer overflow vulnerabilities, and it can generate
spurious warnings.<span style="mso-spacerun: yes">  </span>In practice,
however, it provides programmers concerned about security vulnerabilities with
useful assistance, even for large, complex programs.<span style="mso-spacerun:
yes">  </span>In addition to aiding in the detection of exploitable buffer
overflows, the process of adding annotations to code encourages a disciplined
style of programming and produces programs that include reliable and precise
documentation. </span></p>

<h1 style='text-align:justify'><![if !supportLists]>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Implementation</h1>

<p class=MsoNormal style='text-align:justify'>Our analysis is implemented by combining
traditional compiler data flow analyses with constraint generation and
resolution.<span style="mso-spacerun: yes">  </span>Programs are analyzed at
the function level; all interprocedural analyses are done using the information
contained in annotations.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>We support four types of constraints corresponding to the
annotations introduced in Section <span style='mso-field-code:"PAGEREF _Ref505915643 \\h"'>2<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F005200650066003500300035003900310035003600340033000000</w:data>
</xml><![endif]--></span>: </span><span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxSet</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>, </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>minSet</span></span><span style='mso-fareast-font-family:"MS Mincho"'>,
</span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxRead</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>, and </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>minRead</span></span><span style='mso-fareast-font-family:"MS Mincho"'>.<span
style="mso-spacerun: yes">  </span>Constraints can also contain constants and
variables and allow the arithmetic operations: </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>+</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
and </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>-</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.<span style="mso-spacerun: yes"> 
</span>Terms in constraints can refer to any C expression, although our
analysis will not be able to evaluate some C expressions statically.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyText2 style='margin-bottom:6.0pt;text-align:justify'>The full
constraint grammar is: <i style='mso-bidi-font-style:normal'><o:p></o:p></i></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><i
style='mso-bidi-font-style:normal'><span lang=FR style='font-size:9.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
FR'>constraint</span></i><span lang=FR style='font-size:9.5pt;mso-bidi-font-size:
10.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'> </span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>Þ</span></span><span
lang=FR style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'> (</span><span class=Keyword><span lang=FR
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>requires</span></span><span lang=FR
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'> | </span><span class=Keyword><span lang=FR
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>ensures</span></span><span lang=FR
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'>) <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><i
style='mso-bidi-font-style:normal'><span lang=FR style='font-size:9.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
FR'>constraintExpression relOp constraintExpression<o:p></o:p></span></i></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><i
style='mso-bidi-font-style:normal'><span lang=FR style='font-size:9.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
FR'>relationalOp</span></i><span lang=FR style='font-size:9.5pt;mso-bidi-font-size:
10.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'> </span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;font-family:Symbol;mso-ascii-font-family:
"Times New Roman";mso-fareast-font-family:"MS Mincho";mso-hansi-font-family:
"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:Symbol'><span
style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>Þ</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'> </span><span class=Keyword><span lang=FR
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>==</span></span><span lang=FR
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'> | </span><span class=Keyword><span lang=FR
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>&gt;</span></span><span lang=FR
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'> | </span><span class=Keyword><span lang=FR
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>&gt;=</span></span><span lang=FR
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'> | </span><span class=Keyword><span lang=FR
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>&lt;</span></span><span lang=FR
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'> | </span><span class=Keyword><span lang=FR
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>&lt;=<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><i
style='mso-bidi-font-style:normal'><span lang=FR style='font-size:9.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
FR'>constraintExpression</span></i><span lang=FR style='font-size:9.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";mso-ansi-language:
FR'> </span><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt;font-family:
Symbol;mso-ascii-font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>Þ</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'> <span lang=FR><o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><span lang=FR
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">    </span><i
style='mso-bidi-font-style:normal'>constraintExpression binaryOp
constraintExpresion<o:p></o:p></i></span></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><span lang=FR
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho";
mso-ansi-language:FR'><span style="mso-spacerun: yes">  </span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>|
<i style='mso-bidi-font-style:normal'>unaryOp</i> </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>( </span></span><i style='mso-bidi-font-style:normal'><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>constraintExpression</span></i><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
</span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>)<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes">  </span>| <i style='mso-bidi-font-style:normal'>term</i><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><i
style='mso-bidi-font-style:normal'><span style='font-size:9.5pt;mso-bidi-font-size:
10.0pt;mso-fareast-font-family:"MS Mincho"'>binaryOp</span></i><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
</span><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt;font-family:Symbol;
mso-ascii-font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>Þ</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
</span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>+</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
| </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>-</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><i
style='mso-bidi-font-style:normal'><span style='font-size:9.5pt;mso-bidi-font-size:
10.0pt;mso-fareast-font-family:"MS Mincho"'>unaryOp</span></i><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
</span><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt;font-family:Symbol;
mso-ascii-font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>Þ</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
</span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxSet</span></span><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
| </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxRead</span></span><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
| </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minSet</span></span><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
| </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minRead</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:13.5pt;text-align:justify'><i
style='mso-bidi-font-style:normal'><span style='font-size:9.5pt;mso-bidi-font-size:
10.0pt;mso-fareast-font-family:"MS Mincho"'>term</span></i><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
</span><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt;font-family:Symbol;
mso-ascii-font-family:"Times New Roman";mso-fareast-font-family:"MS Mincho";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>Þ</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>
<i style='mso-bidi-font-style:normal'>variable</i> | C <i style='mso-bidi-font-style:
normal'>expression</i> | <i style='mso-bidi-font-style:normal'>literal </i></span><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'>|
</span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>result</span></span><span
style='mso-fareast-font-family:"MS Mincho"'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Source-code annotations allow arbitrary constraints (as defined by
our constraint grammar) to be specified as the preconditions and postconditions
of functions.<span style="mso-spacerun: yes">  </span>Constraints can be
conjoined (using </span><span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>/\</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>), but there is no support for
disjunction.<span style="mso-spacerun: yes">  </span>All variables used in
constraints have an associated location.<span style="mso-spacerun: yes"> 
</span>Since the value stored by a variable may change in the function body, it
is important that the constraint resolver can distinguish the value at
different points in the program execution.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>Constraints are generated at the
expression level and stored in the corresponding node in the parse tree.<span
style="mso-spacerun: yes">  </span>Constraint resolution is integrated with the
checking by resolving constraints at the statement level as checking traverses
up the parse tree.<span style="mso-spacerun: yes">  </span>Although this limits
the power of our analysis, it ensures that it will be fast and simple. The
remainder of this section describes briefly how constraints are represented,
generated and resolved.<span style='mso-fareast-font-family:"MS Mincho"'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Constraints are generated for C statements by traversing the parse
tree and generating constraints for each subexpression.</span><span
class=MsoFootnoteReference><span style='font-size:9.5pt;mso-bidi-font-size:
10.0pt'> </span></span><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt'><span
style="mso-spacerun: yes"> </span></span><span style='mso-fareast-font-family:
"MS Mincho"'>We determine constraints for a statement by conjoining the
constraints of its subexpressions.<span style="mso-spacerun: yes">  </span>This
assumes subexpressions cannot change state that is used by other subexpressions
of the same expression.<span style="mso-spacerun: yes">  </span>The semantics
of C make this a valid assumption for nearly all expressions – it is undefined
behavior in C for two subexpressions not separated by a sequence point to read
and write the same data.<span style="mso-spacerun: yes">  </span>Since LCLint
detects and warns about this type of undefined behavior, it is reasonable for
the buffer overflow checking to rely on this assumption.<span
style="mso-spacerun: yes">  </span>A few C expressions do have intermediate
sequence points (such as the comma operator which specifies that the left operand
is always evaluated first) and cannot be analyzed correctly by our simplified
assumptions.<span style="mso-spacerun: yes">  </span>In practice, this has not
been a serious limitation for our analysis.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:9.5pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>Constraints are resolved at the statement level in the parse tree
and above using axiomatic semantics techniques.<span style="mso-spacerun:
yes">  </span>Our analysis attempts to resolve constraints using postconditions
of earlier statements and function preconditions.<span style="mso-spacerun:
yes">  </span>To aid in constraint resolution, we simplify constraints using
standard algebraic techniques such as combining constants and substituting terms.<span
style="mso-spacerun: yes">  </span>We also use constraint-specific
simplification rules such as </span><span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxSet(<i
style='mso-bidi-font-style:normal'>ptr</i> + <i style='mso-bidi-font-style:
normal'>i</i>) = maxSet(<i style='mso-bidi-font-style:normal'>ptr</i>) - <i
style='mso-bidi-font-style:normal'>i</i></span></span><span style='mso-fareast-font-family:
"MS Mincho"'>.<span style="mso-spacerun: yes">  </span>We have similar rules
for </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxRead</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>, </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>minSet</span></span><span style='mso-fareast-font-family:"MS Mincho"'>,
and </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>minRead</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=k style='margin-bottom:6.0pt'><span style='mso-fareast-font-family:
"MS Mincho"'>Constraints for statement lists are produced using normal
axiomatic semantics rules and simple logic to combine the constraints of
individual statements.<span style="mso-spacerun: yes">  </span>For example, the
code fragment<o:p></o:p></span></p>

<p class=Code style='text-align:justify'><span class=CodeText><i
style='mso-bidi-font-style:normal'><span lang=FR style='mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>1</span></i></span><span class=CodeText><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'><span
style='mso-tab-count:1'>      </span>t++;<o:p></o:p></span></span></p>

<p class=Code style='text-align:justify'><span class=CodeText><i
style='mso-bidi-font-style:normal'><span lang=FR style='mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>2</span></i></span><span class=CodeText><span
lang=FR style='mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'><span
style='mso-tab-count:1'>      </span>*t = ‘x’;<o:p></o:p></span></span></p>

<p class=Code style='text-align:justify'><span class=CodeText><i
style='mso-bidi-font-style:normal'><span style='mso-fareast-font-family:"MS Mincho"'>3</span></i></span><span
class=CodeText><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:1'>      </span>t++;<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in'><span style='mso-fareast-font-family:"MS Mincho"'>leads to the
constraints: <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in;text-align:justify'><span
class=Keyword><span lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>requires
maxSet(t @ 1:1) &gt;= 1</span></span><span lang=FR style='mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in;text-align:justify'><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>ensures maxRead(t @ 3:4)
&gt;= -1 </span></span><span style='mso-fareast-font-family:"MS Mincho"'>and</span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'> <o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-left:.25in;text-align:justify'><span
class=Keyword><span lang=FR style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho";mso-ansi-language:FR'>ensures
(t @ 3:4) = (t @ 1:1) + 2</span></span><span lang=FR style='mso-fareast-font-family:
"MS Mincho";mso-ansi-language:FR'>.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'><span
style='mso-fareast-font-family:"MS Mincho"'>The assignment to </span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:
Arial'>*t</span></span><span style='mso-fareast-font-family:"MS Mincho"'> on
line 2 produces the constraint </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>requires maxSet(t @ 2:2) &gt;= 0</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.<span style="mso-spacerun: yes"> 
</span>The increment on line 1 produces the constraint </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>ensures (t@1:4) =
(t@1:1) + 1</span></span><span style='mso-fareast-font-family:"MS Mincho"'>.<span
style="mso-spacerun: yes">  </span>The increment constraint is substituted into
the </span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>maxSet</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> constraint to produce </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>requires maxSet (t@1:1 +
1) &gt;= 0</span></span><span style='mso-fareast-font-family:"MS Mincho"'>.<span
style="mso-spacerun: yes">  </span>Using the constraint-specific simplification
rule, this simplifies to </span><span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>requires
maxSet (t@1:1) - 1 &gt;= 0 </span></span><span style='mso-fareast-font-family:
"MS Mincho"'>which further simplifies to </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>requires maxSet(t @ 1:1) &gt;= 1</span></span><span
style='mso-fareast-font-family:"MS Mincho"'>.</span><span style='font-size:
9.5pt;mso-bidi-font-size:10.0pt;mso-fareast-font-family:"MS Mincho"'><o:p></o:p></span></p>

<h1 style='text-align:justify'><![if !supportLists]>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Control Flow</h1>

<p class=MsoNormal style='text-align:justify'>Statements involving control flow
such as <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>while</span></span>
and <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>for</span></span> loops
and <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>if</span></span>
statements, require more complex analysis than simple statement lists.<span
style="mso-spacerun: yes">  </span>For <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>if</span></span> statements and loops, the
predicate often provides a guard that makes a possibly unsafe operation
safe.<span style="mso-spacerun: yes">  </span>In order to analyze such
constructs well, LCLint must take into account the value of the predicate on
different code paths.<span style="mso-spacerun: yes">  </span>For each
predicate, LCLint generates three lists of postcondition constraints: those
that hold regardless of the truth value of the predicate, those that hold when
the predicate evaluates to true, and those that hold when the predicate
evaluates to false.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>To analyze an
<span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>if</span></span>
statement, we develop branch specific guards based on our analysis of the
predicate and use these guards to resolve constraints within the body.<span
style="mso-spacerun: yes">  </span>For example, in the statement </p>

<p class=MsoNormal style='text-align:justify'><span style="mso-spacerun:
yes">   </span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:Arial'>if (sizeof (s1) &gt; strlen (s2))<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-align:justify'><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-fareast-font-family:"MS Mincho";mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes">    </span>strcpy(s1, s2);</span></span><span
style='mso-fareast-font-family:"MS Mincho"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'>if <span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>s1</span>
is a fixed-size array, <span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'>sizeof (s1)</span> will be equal to <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>maxSet(s1) + 1</span></span>.<span style="mso-spacerun:
yes">  </span>Thus the if predicate allows LCLint to determine that the
constraint <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>maxSet(s1) &gt;= maxRead(s2)</span></span> holds on
the true branch.<span style="mso-spacerun: yes">  </span>Based on this
constraint LCLint determines that <span style='mso-fareast-font-family:"MS Mincho"'>the
call to </span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-fareast-font-family:"MS Mincho";
mso-bidi-font-family:Arial'>strcpy</span></span><span style='mso-fareast-font-family:
"MS Mincho"'> is safe.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'>Looping constructs present
additional problems.<span style="mso-spacerun: yes">  </span>Previous versions
of LCLint made a gross simplification of loop behavior: all <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>for</span></span> and <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>while</span></span> loops
in the program were analyzed as though the body executed either zero or one
times.<span style="mso-spacerun: yes">  </span>Although this is clearly a
ridiculous assumption, it worked surprisingly well for the types of analyses
done by LCLint.<span style="mso-spacerun: yes">  </span>For the buffer overflow
analyses, this simplified view of loop semantics does not provide satisfactory
results – to determine whether <span class=CodeText><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:
Arial'>buf[i]</span></span> is a potential buffer overflow, we need to know the
range of values <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>i</span></span>
may represent.<span style="mso-spacerun: yes">  </span>Analyzing the loop as
though its body executed only once would not provide enough information about
the possible values of <span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>i</span></span>.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>In a typical program verifier,
loops are handled by requiring programmers to provide loop invariants.<span
style="mso-spacerun: yes">  </span>Despite considerable effort [Wegbreit75, Cousot77,
Collins88, IS97, DLNS98, SI98], no one has yet been able to produce tools that
generate suitable loop invariants automatically.<span style="mso-spacerun:
yes">  </span>Some promising work has been done towards discovering likely
invariants by executing programs [ECGN99], but these techniques require
well-constructed test suites and many problems remain before this could be used
to produce the kinds of loop invariants we need.<span style="mso-spacerun:
yes">  </span>Typical programmers are not able or willing to annotate their
code with loop invariants, so for LCLint to be effective we needed a method for
handling loops that produces better results than our previous gross
simplification method, but did not require expensive analyses or
programmer-supplied loop invariants. </p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>Our solution is to take advantage
of the idioms used by typical C programmers.<span style="mso-spacerun: yes"> 
</span>Rather than attempt to handle all possible loops in a general way, we
observe that a large fraction of the loops in most C programs are written in a
stylized and structured way.<span style="mso-spacerun: yes">  </span>Hence, we
can develop heuristics for identifying and analyzing loops that match certain
common idioms.<span style="mso-spacerun: yes">  </span>When a loop matches a
known idiom, corresponding heuristics can be used to guess how many times the
loop body will execute.<span style="mso-spacerun: yes">  </span>This
information is used to add additional preconditions to the loop body that
constrain the values of variables inside the loop.<span style="mso-spacerun:
yes">  </span></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>To further simplify the analysis,
we assume that any buffer overflow that occurs in the loop will be apparent in
either the first or last iterations.<span style="mso-spacerun: yes"> 
</span>This is a reasonable assumption in almost all cases, since it would be
quite rare for a program to contain a loop where the extreme values of loop
variables were not on the first and last iterations.<span style="mso-spacerun:
yes">  </span>This allows simpler and more efficient loop checking. To analyze
the first iteration of the loop, we treat the loop as an <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>if</span></span> statement and use the techniques
described above.<span style="mso-spacerun: yes">  </span>To analyze the last
iteration we use a series of heuristics to determine the number of loop
iterations and generate additional constraints based on this analysis.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>An example
loop heuristic analyzes loops of the form</p>

<p class=Code style='text-align:justify'><span class=CodeText><span
style="mso-spacerun: yes">  </span>for (<i style='mso-bidi-font-style:normal'>index</i>
= 0; <i style='mso-bidi-font-style:normal'>expr</i>; <i style='mso-bidi-font-style:
normal'>index</i>++) <i style='mso-bidi-font-style:normal'>body</i><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'>where the <span
class=CodeText><i style='mso-bidi-font-style:normal'><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:
Arial'>body</span></i></span> and <span class=CodeText><i style='mso-bidi-font-style:
normal'><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:
"Courier New";mso-bidi-font-family:Arial'>expr</span></i></span> do not modify
the <span class=CodeText><i style='mso-bidi-font-style:normal'><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>index</span></i></span> variable and <span
class=CodeText><i style='mso-bidi-font-style:normal'><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:
Arial'>body</span></i></span> does not contain a statement (e.g., a <span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>break</span></span>) that
could interfere with normal loop execution.<span style="mso-spacerun: yes"> 
</span>Analyses performed by the original LCLint are used to aid loop heuristic
pattern matching.<span style="mso-spacerun: yes">  </span>For example, we use
LCLint’s modification analyses to determine that the loop body does not modify
the index variable.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>For a loop that matches this
idiom, it is reasonable to assume that the number of iterations can be
determined solely from the loop predicate.<span style="mso-spacerun: yes">  
</span>As with <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>if</span></span>
statements, we generate three lists of postcondition constraints for the loop
test.<span style="mso-spacerun: yes">  </span>We determine the terminating
condition of the loop by examining the list of postcondition constraints that
apply specifically to the true branch.<span style="mso-spacerun: yes"> 
</span>Within these constraints, we look for constraints of the form <span
class=Keyword><i style='mso-bidi-font-style:normal'><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>index</span></i></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'> &lt;= <i style='mso-bidi-font-style:normal'>e</i></span></span>.<span
style="mso-spacerun: yes">  </span>For each of these constraints, we search the
increment part of the loop header for constraints matching the form <span
class=Keyword><i style='mso-bidi-font-style:normal'><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>index</span></i></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'> = <i style='mso-bidi-font-style:normal'>index</i> + 1</span></span>.<span
style="mso-spacerun: yes">  </span>If we find a constraint of this form, we
assume the loop runs for <span class=Keyword><i style='mso-bidi-font-style:
normal'><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:
Arial'>e</span></i></span> iterations.</p>

<p class=MsoNormal style='text-align:justify'><span style="mso-spacerun:
yes"> </span></p>

<p class=MsoNormal style='text-align:justify'>Of course, many loops that match
this heuristic will not execute for <span class=Keyword><i style='mso-bidi-font-style:
normal'><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:
Arial'>e</span></i></span> iterations. Changes to global state or other
variables in the loop body could affect the value of <span class=Keyword><i
style='mso-bidi-font-style:normal'><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>e</span></i></span>.<span style="mso-spacerun: yes"> 
</span>Hence, our analysis is not sound or complete.<span style="mso-spacerun:
yes">  </span>For the programs we have tried so far, we have found this
heuristic works correctly.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=k style='margin-bottom:6.0pt'>Abstract syntax trees for loops are
converted to a canonical form to increase their chances of matching a known
heuristic.<span style="mso-spacerun: yes">  </span>After canonicalization, this
loop pattern matches a surprisingly high number of cases.<span
style="mso-spacerun: yes">  </span>For example, in the loop </p>

<p class=MsoNormal style='text-align:justify'><span style="mso-spacerun:
yes">   </span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>for (i = 0;
buffer[i]; i++) <i style='mso-bidi-font-style:normal'>body </i></span></span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'>the
postconditions of the loop predicate when the body executes would include the
constraint <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>ensures i&nbsp;&lt; maxRead(buffer)</span></span>.<span
style="mso-spacerun: yes">  </span>This would match the pattern so LCLint could
determine that the loop executes for <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>maxRead(buffer)</span></span>
iterations.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>Several other heuristics are used
to match other common loop idioms used in C programs.<span style="mso-spacerun:
yes">  </span>We can generalize the first heuristic to cases where the initial
index value is not known.<span style="mso-spacerun: yes">  </span>If LCLint can
calculate a reasonable upper bound on the number of iterations (for example, if
we can determine that the initial value of the index is always non-negative),
it can determine an upper bound on the number of loop iterations.<span
style="mso-spacerun: yes">  </span>This can generate false positives if LCLint
overestimates the actual number of loop iterations, but usually gives a good
enough approximation for our purposes.</p>

<p class=MsoFootnoteText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-bottom:6.0pt;text-align:justify'>Another
heuristic recognizes a common loop form in which a loop increments and tests a
pointer.<span style="mso-spacerun: yes">  </span>Typically, these loops match
the pattern:</p>

<p class=MsoNormal style='text-align:justify'><span style="mso-spacerun:
yes">   </span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>for (<i
style='mso-bidi-font-style:normal'>init</i>; *<i style='mso-bidi-font-style:
normal'>buf</i>; <i style='mso-bidi-font-style:normal'>buf</i>++)<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'>A heuristic
detects this loop form and assumes that loop executes for <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>maxRead(buf)</span></span>
iterations.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>After estimating the number of loop
iterations, we use a series of heuristics to generate reasonable constraints
for the last iteration.<span style="mso-spacerun: yes">  </span>To do this, we
calculate the value of each variable in the last iteration.<span
style="mso-spacerun: yes">  </span>If a variable is incremented in the loop, we
estimate that in the last iteration the variable is the sum of the number of
loop iterations and the value of the variable in the first iteration.<span
style="mso-spacerun: yes">  </span>For the loop to be safe, all loop
preconditions involving the variable must be satisfied for the values of the
variable in both the first and last iterations.<span style="mso-spacerun:
yes">  </span>This heuristic gives satisfactory results in many cases.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>Our heuristics were initially
developed based on our analysis of <span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span>.<span
style="mso-spacerun: yes">  </span>We found that our heuristics were effective
for <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>BIND</span></span> also.<span style="mso-spacerun: yes"> 
</span>To handle <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>BIND</span></span>, a few addi­tional heuristics were
added.<span style="mso-spacerun: yes">  </span>In particular, <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>BIND</span></span> fre­quently used comparisons of pointer
addresses to ensure a memory accesses is safe.<span style="mso-spacerun: yes"> 
</span>Without an appro­priate heuristic, LCLint generated spurious warnings
for these cases.<span style="mso-spacerun: yes">  </span>We added appropriate
heuristics to handle these situations correctly.<span style="mso-spacerun:
yes">  </span>While we expect experience with additional programs would lead to
the addition of new loop heuristics, it is encouraging that only a few
additional heuristics were needed to analyze <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>.
</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>Although no collection of loop
heuristics will be able to correctly analyze all loops in C programs, our
experience so far indicates that a small number of loop heuristics can be used
to correctly analyze most loops in typical C programs.<span
style="mso-spacerun: yes">  </span>This is not as surprising as it might seem –
most programmers learn to code loops from reading examples in standard texts or
other people’s code.<span style="mso-spacerun: yes">  </span>A few simple loop
idioms are sufficient for programming many computations.</p>

<h1 style='text-align:justify'><a name="_Ref506088607"><![if !supportLists]>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><![endif]>Related
Work</a></h1>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'>In Section
<span style='mso-field-code:"REF _Ref506140809 \\r \\h &#1; \\* MERGEFORMAT"'>2<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F005200650066003500300036003100340030003800300039000000</w:data>
</xml><![endif]--></span>, we described run-time approaches to the buffer
overflow problem.<span style="mso-spacerun: yes">  </span>In this section, we
compare our work to other work on static analysis.<span style="mso-spacerun:
yes">  </span></span></p>

<p class=MsoFootnoteText style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'>It is possible to find some program flaws using lexical analysis
alone.<span style="mso-spacerun: yes">  </span>Unix </span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-font-family:
"MS Mincho"'>grep</span></span><span style='mso-fareast-font-family:"MS Mincho"'>
is often used to perform a crude analysis by searching for potentially unsafe
library function calls.<span style="mso-spacerun: yes">  </span></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>ITS4</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> is a lexical analysis tool that
searches for security problems using a database of potentially dangerous
constructs [VBKM00].<span style="mso-spacerun: yes">  </span>Lexical analysis
techniques are fast and simple, but their power is very limited since they do
not take into account the syntax or semantics of the program.<o:p></o:p></span></p>

<p class=MsoFootnoteText style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText2 style='text-align:justify'>More precise checking requires
a deeper analysis of the program.<span style="mso-spacerun: yes">  </span>Our
work builds upon considerable work on constraint-based analysis
techniques.<span style="mso-spacerun: yes">  </span>We do not attempt to
summarize foundational work here.<span style="mso-spacerun: yes">  </span>For a
summary see [Aiken99].<span style="mso-spacerun: yes">  </span></p>

<p class=MsoBodyText2 style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoPlainText style='text-align:justify'>Proof-carrying code [NL 96,
Necula97] is a technique where a proof is distributed with an executable and a
verifier checks the proof guarantees the executable has certain
properties.<span style="mso-spacerun: yes">  </span>Proof-carrying code has
been used to enforce safety policies constraining readable and writeable memory
locations.<span style="mso-spacerun: yes">  </span>Automatic con­struc­tion of
proofs of memory safety for programs written in an unsafe language, however, is
beyond current capabilities.</p>

<p class=MsoFootnoteText style='text-align:justify'><span style='mso-fareast-font-family:
"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'>Wagner, et al. have developed
a system to statically detect buffer overflows in C [WFBA00, Wagner00].<span
style="mso-spacerun: yes">  </span>They used their tool effectively to find
both known and unknown buffer overflow vulnerabilities in a version of <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>sendmail</span></span>.<span style="mso-spacerun: yes"> 
</span>Their approach formulates the problem as an integer range analysis
problem by treating C strings as an abstract type accessed through library
functions and modeling pointers as integer ranges for allocated size and
length.<span style="mso-spacerun: yes">  </span>A consequence of modeling
strings as an abstract data type is that buffer overflows involving
non-character buffers cannot be detected.<span style="mso-spacerun: yes"> 
</span>Their system generates constraints similar to those generated by LCLint
for operations involving strings.<span style="mso-spacerun: yes">  </span>These
constraints are not generated from annotations, but constraints for standard
library functions are built in to the tool.<span style="mso-spacerun: yes"> 
</span>Flow insensitive analysis is used to resolve the constraints.<span
style="mso-spacerun: yes">  </span>Without the localization provided by
annotations, it was believed that flow sensitive analyses would not scale well
enough to handle real programs.<span style="mso-spacerun: yes">  </span>Flow
insensitive analysis is less accurate and does not allow special handling of
loops or <span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>if</span></span>
statements.</p>

<p class=MsoPlainText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoPlainText style='text-align:justify'>Dor, Rodeh and Sagiv have
developed a system that detects unsafe string operations in C programs [DRS01].<span
style="mso-spacerun: yes">  </span>Their system performs a source-to-source
trans­for­ma­tion that instruments a program with additional variables that
describe string attributes and contains <span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>assert</span></span> statements that check for
unsafe string op­er­a­tions.<span style="mso-spacerun: yes">  </span>The
instrumented program is then analyzed statically using integer analysis to
determine possible assertion failures.<span style="mso-spacerun: yes"> 
</span>This approach can handle many com­plex properties such as over­lapping
pointers.<span style="mso-spacerun: yes">  </span>However, in the worst case
the number of variables in the instrumented program is quadratic in the number
of variables in the original program.<span style="mso-spacerun: yes"> 
</span>To date, it has only been used on small example programs.</p>

<p class=MsoPlainText style='text-align:justify'><span style='display:none;
mso-hide:all'><span style="mso-spacerun: yes"> </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='display:none;
mso-hide:all'>Wagner’s prototype has been used effectively to find both known
and previously unknown buffer overflow vulnerabilities in </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial;display:none;mso-hide:all'>sendmail</span></span><span
style='display:none;mso-hide:all'>. <span style="mso-spacerun:
yes"> </span>Wagner’s prototype is known scale to fairly large
applications.<span style="mso-spacerun: yes">  </span>Versions of LCLint
without buffer overflow checking scaled to vary large applications. The nature
of our modifications suggests that our version of LCLint would continue to
scale to very large applications. <o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='display:none;
mso-hide:all;background:aqua;mso-highlight:aqua'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><span style='display:none;
mso-hide:all;background:aqua;mso-highlight:aqua'>Wagner’s tool does not require
adding annotations.<span style="mso-spacerun: yes">  </span>This makes the
up-front effort required to use the tool less than that required in order to
use LCLint.<span style="mso-spacerun: yes">  </span>However, human evaluation
of error messages is by far the most time consuming part program analysis.<span
style="mso-spacerun: yes">  </span>As with LCLint, Wagner’s prototype produces
a large number of spurious messages, and it is up to the programmer to
determine which messages are spurious.<span style="mso-spacerun: yes"> 
</span>If a large amount of time is spent on human analysis, the additional
time spent on adding annotations is not likely to be significant.<span
style="mso-spacerun: yes">  </span>A process of human input and repeated
checking may actually be faster than simply generating less accurate error
messages.</span><span style='display:none;mso-hide:all'><span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p class=MsoPlainText style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyText2 style='text-align:justify'>A few tools have been
developed to detect array bounds errors in languages other than C.<span
style="mso-spacerun: yes">  </span>John McHugh developed a verification system
that detects array bounds errors in the Gypsy language [McHugh84].<span
style="mso-spacerun: yes">  </span>Extended Static Checking uses an automatic
theorem-prover to detect array index bounds errors in Modula-3 and Java
[DLNS98].<span style="mso-spacerun: yes">  </span>Extended Static Checking uses
information in annotations to assist checking.<span style="mso-spacerun: yes"> 
</span>Detecting array bounds errors in C programs is harder than for Modula-3
or Java, since those languages do not provide pointer arithmetic. </p>

<h1 style='text-align:justify'><![if !supportLists]>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Conclusions</h1>

<p class=MsoNormal style='text-align:justify'>We have presented a lightweight
static analysis tool for detecting buffer overflow vulnerabilities.<span
style="mso-spacerun: yes">  </span>It is neither sound nor complete; hence, it
misses some vul­ner­a­bilities and produces some spurious warnings.<span
style="mso-spacerun: yes">  </span>Despite this, our experience so far
indicates that it is useful.<span style="mso-spacerun: yes">  </span>We were
able to find both known and previously unknown buffer overflow vulnerabilities
in <span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>wu-ftpd</span></span> and <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>BIND</span></span>
with a reasonable amount of effort using our approach.<span
style="mso-spacerun: yes">  </span>Further, the process of adding annotations
is a con­struct­ive and useful step for understanding of a program and
improving its maintainability.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=k>We believe it is realistic (albeit perhaps optimistic) to be­lieve
programmers would be willing to add annota­tions to their programs if they are
used to efficiently and clearly detect likely buffer overflow vulnerabilities
(and other bugs) in their programs.<span style="mso-spacerun: yes">  </span>An
informal sam­pling of tens of thousands of emails received from LCLint users
indicates that about one quarter of LCLint users add the annotations supported
by previously released versions of LCLint to their programs.<span
style="mso-spacerun: yes">  </span>Perhaps half of those use annotations in
sophisticated ways (and occasionally in ways the authors never imagined).<span
style="mso-spacerun: yes">  </span>Although the annotations required for effectively
detecting buffer overflow vul­ner­abilities are somewhat more complicated, they
are only an incremental step beyond previous annotations.<span
style="mso-spacerun: yes">  </span>In most cases, and certainly for
security-sensitive programs, the benefits of doing so should far outweigh the
effort required.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>These techniques, and static checking
in general, will not provide the complete solution to the buffer overflow
problem.<span style="mso-spacerun: yes">  </span>We are optimistic, though,
that this work repre­sents a step towards that goal.</p>

<h1 style='margin-top:12.0pt;margin-right:0in;margin-bottom:6.0pt;margin-left:
0in;text-align:justify;text-indent:0in;mso-list:none;tab-stops:.5in'>Availability</h1>

<p class=MsoNormal style='text-align:justify'>LCLint source code and binaries
for several platforms are available from <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'><a href="http://lclint.cs.virginia.edu">http://lclint.cs.virginia.edu</a></span></span>.</p>

<h1 style='margin-top:12.0pt;margin-right:0in;margin-bottom:6.0pt;margin-left:
0in;text-align:justify;text-indent:0in;mso-list:none;tab-stops:.5in'>Acknowledgements</h1>

<p class=MsoNormal style='text-align:justify'>We would like to thank the NASA
Langley Research Center for supporting this work.<span style="mso-spacerun:
yes">  </span>David Evans is also supported by an NSF CAREER Award.<span
style="mso-spacerun: yes">  </span>We thank John Knight, John McHugh, Chenxi
Wang, Joel Winstead and the anonymous reviewers for their helpful and
insightful comments.</p>

<h1 style='margin-top:12.0pt;margin-right:0in;margin-bottom:6.0pt;margin-left:
0in;text-align:justify;text-indent:0in;mso-list:none;tab-stops:.5in'>References</h1>

<p class=Reference>[Aiken99] Alexander Aiken.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Introduction to Set
Constraint-Based Program Analysis</i>.<span style="mso-spacerun: yes"> 
</span>Science of Computer Programming, Volume 35, Numbers 2-3.<span
style="mso-spacerun: yes">  </span>November 1999.</p>

<p class=Reference>[AlephOne96] Aleph One.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Smashing the Stack for Fun and
Profit</i>.<span style="mso-spacerun: yes">  </span>BugTraq Archives.<span
style="mso-spacerun: yes">  </span><span class=Keyword><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>http://immunix.org/StackGuard/profit.html.</span></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></span></p>

<p class=Reference><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Times New Roman"'>[</span></span><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt'>Andrews01] Mark Andrews. Personal
communication, May 2001.<span class=Keyword><span style='mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></span></span></p>

<p class=Reference>[BST00] Arash Baratloo, Navjot Singh and Timothy Tsai.<span
style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:normal'>Transparent
Run-Time Defense Against Stack-Smashing Attacks</i>.<span style="mso-spacerun:
yes">  </span>9<sup>th</sup> USENIX Security Symposium, August 2000. </p>

<p class=Reference>[Collins88] William J. Collins.<span style="mso-spacerun:
yes">  </span><i style='mso-bidi-font-style:normal'>The Trouble with For-Loop
Invariants</i>.<span style="mso-spacerun: yes">  </span>19<sup> th</sup> SIGCSE
Technical Symposium on Computer Science Education, February 1988. </p>

<p class=References><span class=ReferenceFont><span style='mso-ansi-font-size:
10.0pt'>[Coolbaugh99] </span></span>Liz Coolbaugh. <i style='mso-bidi-font-style:
normal'>Buffer Overflow Protection from Kernel Patches</i>.<span
style="mso-spacerun: yes">  </span><span class=ReferenceFont><span
style='mso-ansi-font-size:10.0pt'>Linux Weekly News, </span></span>http://lwn.net/1999/1230/security.php3.<span
class=ReferenceFont><span style='mso-ansi-font-size:10.0pt'><o:p></o:p></span></span></p>

<p class=Reference>[Cousot77] Patrick Cousot and Radhia Cousot. <i
style='mso-bidi-font-style:normal'>Abstract Interpretation: A Unified Lattice
Model for Static Analysis of Programs by Construction or Approximation of
Fixpoints</i>.<span style="mso-spacerun: yes">  </span>Fourth<sup> </sup><span
style="mso-spacerun: yes"> </span>ACM Sympo­sium on Principles of Programming
Languages, January 1977.</p>

<p class=Reference>[CPMH+98] Crispin Cowan, Calton Pu, David Maier, Heather
Hinton, Peat Bakke, Steve Beattie, Aaron Grier, Perry Wagle and Qian
Zhang.<span style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:
normal'>Automatic Detection and Prevention of Buffer-Overflow Attacks</i>.<span
style="mso-spacerun: yes">  </span>7<sup>th</sup> USENIX Security Symposium,
January 1998.</p>

<p class=Reference>[CBDP+99] Crispin Cowan, Steve Beattie, Ryan Finnin Day,
Calton Pu, Perry Wagle and Erik Walthinsen.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Protecting Systems from Stack
Smashing Attacks with StackGuard</i>.<span style="mso-spacerun: yes">  </span>Linux
Expo.<span style="mso-spacerun: yes">  </span>May 1999.<span
style="mso-spacerun: yes">  </span>(Updated statistics at <span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>http://immunix.org/StackGuard/performance.html</span></span>)</p>

<p class=Reference>[CWPBW00] Crispin Cowan, Perry Wagle, Calton Pu, Steve
Beattie and Jonathan Walpole.<span style="mso-spacerun: yes">  </span><i
style='mso-bidi-font-style:normal'>Buffer Overflows: Attacks and Defenses for
the Vulnerability of the Decade.</i> <span style="mso-spacerun:
yes"> </span>DARPA Information Survivability Conference and Exposition.<span
style="mso-spacerun: yes">  </span>January 2000.</p>

<p class=Reference>[DLNS98] David Detlefs, K. Rustan M. Leino, Greg Nelson and
James B. Saxe.<span style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:
normal'>Extended Static Checking</i>.<span style="mso-spacerun: yes"> 
</span>Research Report, Compaq Systems Research Center.<span
style="mso-spacerun: yes">  </span>December 18, 1998.</p>

<p class=Reference>[DRS01] Nurit Dor, Michael Rodeh and Mooly Sagiv.<span
style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:normal'>Cleanness
Checking of String Manipulations in C Programs via Integer Analysis</i>.<span
style="mso-spacerun: yes">  </span>8th International Static Analysis
Symposium.<span style="mso-spacerun: yes">  </span>To appear, July 2001.</p>

<p class=Reference>[ES99] Úlfar Erlingsson and Fred B. Schneider. <i
style='mso-bidi-font-style:normal'>SASI Enforcement of Security Policies: A
Retrospective</i>. New Security Paradigms Workshop.<span style="mso-spacerun:
yes">  </span>September 1999.</p>

<p class=Reference>[ES00] Ulfar Erlingsson and Fred B. Schneider.<span
style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:normal'>IRM
Enforcement of Java Stack Inspection</i>.<span style="mso-spacerun: yes"> 
</span>IEEE Symposium on Security and Privacy.<span style="mso-spacerun: yes"> 
</span>May 2000.</p>

<p class=Reference>[ECGN99] Michael D. Ernst, Jake Cockrell, William G.
Griswold and David Notkin.<span style="mso-spacerun: yes">   </span><i
style='mso-bidi-font-style:normal'>Dynamically Discovering Likely Program
Invariants to Support Program Evolution.</i><span style="mso-spacerun: yes"> 
</span>International Conference on Software Engineering.<span
style="mso-spacerun: yes">  </span>May 1999.</p>

<p class=References>[EGHT94] David Evans, John Guttag, Jim Horning and Yang Meng
Tan. <i style='mso-bidi-font-style:normal'>LCLint: A Tool for Using
Specifications to Check Code</i>. SIGSOFT Symposium on the Foundations of
Software Engineering.<span style="mso-spacerun: yes">  </span>December 1994.</p>

<p class=References>[Evans96] David Evans.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Static Detection of Dynamic Memory
Errors</i>.<span style="mso-spacerun: yes">  </span>SIGPLAN Conference on
Programming Language Design and Implementation.<span style="mso-spacerun:
yes">  </span>May 1996.</p>

<p class=References>[ET99] David Evans and Andrew Twyman.<span
style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:normal'>Flexible
Policy-Directed Code Safety</i>.<span style="mso-spacerun: yes">  </span>IEEE
Symposium on Security and Privacy.<span style="mso-spacerun: yes">  </span>May
1999.</p>

<p class=References>[Evans00a] David Evans.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Policy-Directed Code Safety</i>.<span
style="mso-spacerun: yes">  </span>MIT PhD Thesis.<span style="mso-spacerun:
yes">  </span>February 2000.</p>

<p class=Reference>[Evans00b] David Evans.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Annotation-Assisted Lightweight
Static Checking</i>.<span style="mso-spacerun: yes">  </span>First
International Workshop on Automated Program Analysis, Testing and
Verification.<span style="mso-spacerun: yes">  </span>June 2000.</p>

<p class=Reference>[Evans00c] David Evans.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'><span lang=FR style='mso-ansi-language:
FR'>LCLint User’s Guide, Version 2.5.</span></i><span lang=FR style='mso-ansi-language:
FR'><span style="mso-spacerun: yes">  </span></span>May 2000. <span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>http://lclint.cs.virginia.edu/guide/</span></span></p>

<p class=References>[FBF99<!--[if supportFields]><span style='mso-element:field-begin'></span>
XE &quot;Fraser99&quot; <![endif]--><!--[if supportFields]><span
style='mso-element:field-end'></span><![endif]-->] Timothy Fraser, Lee Badger
and Mark Feldman.<span style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:
normal'>Hardening COTS Software with Generic Software Wrappers. </i>IEEE
Symposium on Security and Privacy.<span style="mso-spacerun: yes">  </span>May
1999.<i style='mso-bidi-font-style:normal'> <o:p></o:p></i></p>

<p class=References><span class=ReferenceFont><span style='mso-ansi-font-size:
10.0pt'>[GWTB96</span></span><!--[if supportFields]><span class=ReferenceFont><span
style='mso-ansi-font-size:10.0pt'><span style='mso-element:field-begin'></span>
XE &quot;</span></span>Goldberg96&quot;<span class=ReferenceFont><span
style='mso-ansi-font-size:10.0pt'> </span></span><![endif]--><!--[if supportFields]><span
class=ReferenceFont><span style='mso-ansi-font-size:10.0pt'><span
style='mso-element:field-end'></span></span></span><![endif]--><span
class=ReferenceFont><span style='mso-ansi-font-size:10.0pt'>] Ian Goldberg,
David Wagner, Randi Thomas and Eric A. Brewer.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>A Secure Environment for Untrusted
Helper Applications: Confining the Wily Hacker</i>.<span style="mso-spacerun:
yes">  </span>6<sup>th</sup> USENIX Security Symposium. July 1996.<o:p></o:p></span></span></p>

<p class=References><span class=ReferenceFont><span style='mso-ansi-font-size:
10.0pt'>[GH93] John V. Guttag and James J. Horning, editors, with Stephen J.
Garland, Kevin D. Jones, Andrés Modet and Jennette M. Wing.<span
style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:normal'>Larch:
Languages and Tools for Formal Specification.<span style="mso-spacerun: yes"> 
</span></i>Springer-Verlag.<span style="mso-spacerun: yes">  </span>1993.<o:p></o:p></span></span></p>

<p class=Reference>[IS97] A. Ireland and J. Stark.<span style="mso-spacerun:
yes">  </span><i style='mso-bidi-font-style:normal'>On the Automatic Discovery
of Loop Invariants</i>. 4<sup>th</sup> NASA Langley Formal Methods
Workshop.<span style="mso-spacerun: yes">  </span>September 1997. <span
class=ReferenceFont><span style='mso-ansi-font-size:10.0pt'><o:p></o:p></span></span></p>

<p class=Reference>[ISO99] ISO/IEC 9899 International Standard.<span
style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:normal'>Programming
Languages – C.<span style="mso-spacerun: yes">  </span></i>December 1999.<span
style="mso-spacerun: yes">  </span>Approved by ANSI May 2000. </p>

<p class=Reference>[LHSS00] David Larochelle, Yanlin Huang, Avneesh Saxena and
Seejo Sebastine.<span style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:
normal'>Static Detection of Buffer Overflows in C using LCLint</i>.<span
style="mso-spacerun: yes">  </span>Unpublished report available from the
authors.<span style="mso-spacerun: yes">  </span>May 2000.</p>

<p class=Reference>[Luckin01] Bob Luckin.<span style="mso-spacerun: yes"> 
</span>Personal communication, April 2001.</p>

<p class=Reference>[Lundberg01] Gregory A Lundberg.<span style="mso-spacerun:
yes">  </span>Personal communication, April 2001.</p>

<p class=Reference>[McHugh84] John McHugh.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Towards the Generation of Efficent
Code form Verified Programs</i>.<span style="mso-spacerun: yes"> 
</span>Technical Report 40, Institute for Computing Science, University of
Texas at Austin PhD Thesis, 1984.</p>

<p class=Reference>[Necula97] George C. Necula.<span style="mso-spacerun:
yes">  </span><i style='mso-bidi-font-style:normal'>Proof-Carrying Code</i>.<span
style="mso-spacerun: yes">  </span>24th ACM SIGPLAN-SIGACT Symposium on
Principles of Programming Langauges, January 1997.</p>

<p class=Reference>[NL96] George C. Necula and Peter Lee. <i style='mso-bidi-font-style:
normal'>Safe Kernel Extensions Without Run-Time Checking</i>. 2nd Symposium on
Operating Systems Design and Implementation, October 1996.<span
class=ReferenceFont><span style='mso-ansi-font-size:10.0pt'><o:p></o:p></span></span></p>

<p class=References>[Orcero00] David Santo Orcero.<span style="mso-spacerun:
yes">  </span><i style='mso-bidi-font-style:normal'>The Code Analyzer LCLint</i>.<span
style="mso-spacerun: yes">  </span>Linux Journal.<span style="mso-spacerun:
yes">  </span>May 2000.</p>

<p class=Reference>[Pethia00] Richard D. Pethia.<span style="mso-spacerun:
yes">  </span><i style='mso-bidi-font-style:normal'>Bugs in Programs</i>.<span
style="mso-spacerun: yes">  </span>Keynote address at SIGSOFT Foundations of
Software Engineering.<span style="mso-spacerun: yes">  </span>November 2000. </p>

<p class=References>[PG00] Pramode C E and Gopakumar C E.<span
style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:normal'>Static
Checking of C programs with LCLint</i>. Linux Gazette Issue 51.<span
style="mso-spacerun: yes">  </span>March 2000.</p>

<p class=Reference>[RE89] Jon Rochlis and Mark Eichin.<span
style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:normal'>With
Microscope and Tweezers: the Worm from MIT’s Perspective.</i><span
style="mso-spacerun: yes">  </span>Communications of the ACM.<span
style="mso-spacerun: yes">  </span>June 1989.</p>

<p class=Reference>[Snow99] Brian Snow.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Future of Security</i>.<span
style="mso-spacerun: yes">  </span>Panel presentation at IEEE Security and
Privacy.<span style="mso-spacerun: yes">  </span>May 1999.</p>

<p class=Reference>[Spafford88] Eugene Spafford.<span style="mso-spacerun:
yes">  </span><i style='mso-bidi-font-style:normal'>The Internet Worm Program:
An Analysis</i>.<span style="mso-spacerun: yes">  </span>Purdue Tech Report
832.<span style="mso-spacerun: yes">  </span>1988.</p>

<p class=Reference>[SI98] J. Stark and A. Ireland. <i style='mso-bidi-font-style:
normal'>Invariant Discovery Via Failed Proof Attempts</i>. 8th International
Workshop on Logic Based Program Synthesis and Transformation.<span
style="mso-spacerun: yes">  </span>June 1998.</p>

<p class=Reference>[Torvalds98] Linus Torvalds.<span style="mso-spacerun:
yes">  </span>Message archived in <i style='mso-bidi-font-style:normal'>Linux
Weekly News</i>. August 1998.<span style="mso-spacerun: yes">  </span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'><a href="http://lwn.net/980806/a/linus-noexec.html."><span
style='color:windowtext;text-decoration:none;text-underline:none'>http://lwn.net/980806/a/linus-noexec.html</span></a></span></span></p>

<p class=Reference>[VBKM00] John Viega, J.T. Bloch, Tadayoshi Kohno and Gary
McGraw<i style='mso-bidi-font-style:normal'>. ITS4 : A Static Vulnerability
Scanner for C and C++ Code</i>. Annual Computer Security Applications
Conference. December 2000.</p>

<p class=Reference>[WFBA00] David Wagner, Jeffrey S. Foster, Eric A. Brewer and
Alexander Aiken.<span style="mso-spacerun: yes">  </span><i style='mso-bidi-font-style:
normal'>A First Step Towards Automated Detection of Buffer Overrun
Vulnerabilities</i>.<i style='mso-bidi-font-style:normal'><span
style="mso-spacerun: yes">  </span></i>Network and Distributed System Security
Symposium.<span style="mso-spacerun: yes">  </span>February 2000.<i
style='mso-bidi-font-style:normal'> </i></p>

<p class=Reference>[Wagner00] David Wagner.<span style="mso-spacerun: yes"> 
</span><i style='mso-bidi-font-style:normal'>Static Analysis and Computer
Security: New Techniques for Software Assurance.</i><span style="mso-spacerun:
yes">  </span>University of California, Berkeley, PhD Thesis, 2000.</p>

<p class=Reference><span class=ReferenceFont><span style='mso-ansi-font-size:
10.0pt'>[WLAG93] </span></span>Robert Wahbe, Steven Lucco, Thomas E. Anderson
and Susan L. Graham.<span style="mso-spacerun: yes">  </span><span
class=ReferenceFont><i style='mso-bidi-font-style:normal'><span
style='mso-ansi-font-size:10.0pt'>Efficient Software-Based Fault Isolation.</span></i></span><span
class=ReferenceFont><span style='mso-ansi-font-size:10.0pt'><span
style="mso-spacerun: yes">  </span>14<sup>th</sup> ACM Symposium on Operating
Systems Principles, 1993. </span></span></p>

<p class=Reference>[Wegbreit75] Ben Wegbreit. <i style='mso-bidi-font-style:
normal'>Property Extraction in Well-Founded Property Sets</i>. IEEE
Transactions on Software Engineering, September 1975.</p>

<p class=Reference><span class=ReferenceFont><span style='mso-ansi-font-size:
10.0pt'>[WSJ01] The Wall Street Journal. <i style='mso-bidi-font-style:normal'>Researchers
Find Software Flaw Giving Hackers Key to Web Sites</i>.<span
style="mso-spacerun: yes">  </span></span></span>January 30, 2001.</p>

<p class=Reference><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2 style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;mso-list-ins:
Unknown 20010511T1709'><span class=ReferenceFont><span style='font-size:11.0pt;
mso-bidi-font-size:10.0pt;mso-fareast-font-family:"Times New Roman"'>A.<span
style="mso-spacerun: yes">  </span><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">Annotated
</ins>Selected <ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">C Library</ins> Functions</span></span><span
class=ReferenceFont><span style='font-size:9.5pt;mso-bidi-font-size:10.0pt;
font-weight:normal'><ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50"><o:p></o:p></ins></span></span></h2>

<p class=Code style='mso-list:none;mso-list-ins:Unknown 20010511T1709'><span
class=CodeText><ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">char *strcpy (char *s1, char *s2) </ins><o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes"> </span><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">/*@requires
</ins>m<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">axSet(s1) &gt;= </ins>ma<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">xRead(s2)@*/
</ins><o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes"> </span><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">/*@ensures
</ins>m<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">axRead(s1) == </ins>m<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">axRead
(s2)</ins> /\ r<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">esult == </ins>s1<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">@*/;<o:p></o:p></ins></span></p>

<p class=Code><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></ins></span></p>

<p class=Code><span class=CodeText><span style='mso-fareast-font-family:"MS Mincho"'><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">char
*strncpy (char *s1, char *s2, size_t n)</ins><o:p></o:p></span></span></p>

<p class=Code><span class=CodeText><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes"> </span><ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">/*@requires </ins>maxSet<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">(s1)
&gt;= n </ins>–<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50"> 1@*/ </ins><o:p></o:p></span></span></p>

<p class=Code><span class=CodeText><span style='mso-fareast-font-family:"MS Mincho"'><span
style="mso-spacerun: yes"> </span>/*<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">@ensures
</ins>maxRead<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50"> (s1) &lt;= </ins>maxRead<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">(s2)</ins>
/\<ins cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">
</ins>maxRead<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50"> (s1) &lt;= </ins>(<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">n</ins>
– 1) /\<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50"> result</ins> =<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">= </ins>s1<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">@*/; <o:p></o:p></ins></span></span></p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></ins></span></p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">char
*strcat (char *s1, char *s2) </ins><o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes"> </span><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">/*@requires
</ins>maxSet<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">(s1)</ins> <ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">&gt;=
(</ins>maxRead<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">(s1) </ins>+ maxRead<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">(s2))@*/</ins><o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes"> </span><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">/*@ensures
</ins>maxRead<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">(s1) </ins>=<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">= </ins>maxRead<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">(s1)
+ </ins>maxRead<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">(s2)</ins> /\ result == s1<ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">@*/;<o:p></o:p></ins></span></p>

<p class=Code><span class=CodeText><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'>strncat (char *s1, char *s2, int n)</p>

<p class=Code>/*@requires maxSet(s1) &gt;= maxRead(s1) + n@*/</p>

<p class=Code>/*@ensures maxRead(result) &gt;= maxRead(s1) + n@*/;</p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></ins></span></p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">extern
size_t strlen (char *s) </ins><o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes">  </span><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">/*@ensures
result == </ins>maxRead<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">(s)@*/;<o:p></o:p></ins></span></p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></ins></span></p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">void
*calloc (size_t nobj, size_t size) </ins><o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes"> </span><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">/*@ensures
</ins>maxSet<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">(result) == nobj@*/;<o:p></o:p></ins></span></p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50"><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></ins></span></p>

<p class=Code style='text-indent:0in;mso-text-indent-alt:0in;mso-list:none;
mso-list-ins:Unknown 20010511T1709'><span class=CodeText><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">void
*malloc (size_t size)<span style="mso-spacerun: yes">  </span></ins><o:p></o:p></span></p>

<p class=Code><span class=CodeText><span style="mso-spacerun: yes"> </span><ins
cite="mailto:Computer%20Science%20Department" datetime="2001-02-01T18:50">/*@ensures
</ins>maxSet<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50">(result) == size@*/;<o:p></o:p></ins></span></p>

<p class=Code style='text-align:justify'><span class=ReferenceFont><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-align:justify'><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>These annotations were
determined based on ISO C standard [ISO99].<span style="mso-spacerun: yes"> 
</span>Note that the semantics of </span></span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>strncpy</span></span><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'> and </span></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New"'>strncat</span></span><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'> are different – </span></span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>strncpy</span></span><span
class=ReferenceFont><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>
writes exactly </span></span><span class=ReferenceFont><span style='font-size:
9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>n</span></span><span
class=ReferenceFont><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>
characters to the buffer but does not guarantee that a null character is added;
</span></span><span class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New"'>strncat</span></span><span
class=ReferenceFont><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>
appends </span></span><span class=ReferenceFont><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New"'>n</span></span><span
class=ReferenceFont><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>
characters to the buffer and a null character.<span style="mso-spacerun: yes"> 
</span>The </span></span><span class=Keyword><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>ensures</span></span><span
class=ReferenceFont><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>
clauses reveal these differences clearly.<span style="mso-spacerun: yes"> 
</span><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-align:justify'><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-align:justify'><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>The full specifications for </span></span><span
class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:Arial'>malloc</span></span><span
class=ReferenceFont><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>
and </span></span><span class=CodeText><span style='font-size:9.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>calloc</span></span><span
class=ReferenceFont><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>
also include </span></span><span class=CodeText><span style='font-size:9.0pt;
mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:Arial'>null</span></span><span
class=ReferenceFont><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>
annotations on the result that indicate that they may return </span></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>NULL</span></span><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>.<span style="mso-spacerun:
yes">  </span>Existing LCLint checking detects dereferencing a potentially null
pointer.<span style="mso-spacerun: yes">  </span>As a result, the implicit
actual postcondition for </span></span><span class=CodeText><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>malloc</span></span><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'> is </span></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>maxSet(result) == size </span></span><span class=Keyword><span
style='font-size:9.0pt;mso-bidi-font-size:10.0pt;font-family:Symbol;mso-ascii-font-family:
Arial;mso-hansi-font-family:Arial;mso-char-type:symbol;mso-symbol-font-family:
Symbol'><span style='mso-char-type:symbol;mso-symbol-font-family:Symbol'>Ú</span></span></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'> result == null</span></span><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>.<span style="mso-spacerun:
yes">  </span>LCLint does not support general disjunctions, but possibly </span></span><span
class=Keyword><span style='font-size:9.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>NULL</span></span><span class=ReferenceFont><span
style='font-size:11.0pt;mso-bidi-font-size:10.0pt'> values can be handled
straightforwardly.<ins cite="mailto:Computer%20Science%20Department"
datetime="2001-02-01T18:50"><o:p></o:p></ins></span></span></p>

<p class=Reference><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<div style='mso-element:footnote-list'><![if !supportFootnotes]><br clear=all>

<hr align=left size=1 width="33%">

<![endif]>

<div style='mso-element:footnote' id=ftn1>

<p class=MsoFootnoteText style='text-align:justify'><a style='mso-footnote-id:
ftn1' href="#_ftnref1" name="_ftn1" title=""><span class=MsoFootnoteReference><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[1]<![endif]></span></span></span></a> We
can trivially reduce the halting problem to the buffer overflow detection
problem by inserting code that causes a buffer overflow before all halt
instructions.</p>

</div>

<div style='mso-element:footnote' id=ftn2>

<p class=MsoFootnoteText style='text-align:justify'><a style='mso-footnote-id:
ftn2' href="#_ftnref2" name="_ftn2" title=""><span class=MsoFootnoteReference><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[2]<![endif]></span></span></span></a><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'> The original Larch C
interface language LCL [GH93], on which LCLint’s annotation language was based,
did include a notion of general preconditions and post­conditions specified by </span><span
class=Keyword><span style='font-size:8.5pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>requires</span></span><span style='font-size:9.5pt;
mso-bidi-font-size:10.0pt'> and </span><span class=Keyword><span
style='font-size:8.5pt;mso-bidi-font-size:10.0pt;font-family:Arial'>ensures</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'> clauses.<o:p></o:p></span></p>

</div>

<div style='mso-element:footnote' id=ftn3>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn3' href="#_ftnref3"
name="_ftn3" title=""><span class=MsoFootnoteReference><span style='font-size:
9.5pt;mso-bidi-font-size:10.0pt'><span style='mso-special-character:footnote'><![if !supportFootnotes]>[3]<![endif]></span></span></span></a>
<span style='mso-fareast-font-family:"MS Mincho"'>LCLint also supports a </span><span
class=Keyword><span style='font-size:8.5pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-fareast-font-family:"MS Mincho"'>nullterminated</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> annotation that denotes storage that
is terminated by the null character.<span style="mso-spacerun: yes"> 
</span>Many C library functions require null-terminated strings, and can
produce buffer overflow vulnerabilities if they are passed a string that is not
properly null-terminated.<span style="mso-spacerun: yes">  </span>We do not
cover the </span><span class=Keyword><span style='font-size:8.5pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-font-family:"MS Mincho"'>nullterminated</span></span><span
style='mso-fareast-font-family:"MS Mincho"'> annotation and related checking in
this paper.<span style="mso-spacerun: yes">  </span>For information on it, see
[LHSS00].</span></p>

</div>

<div style='mso-element:footnote' id=ftn4>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn4' href="#_ftnref4"
name="_ftn4" title=""><span class=MsoFootnoteReference><span style='font-size:
9.5pt;mso-bidi-font-size:10.0pt'><span style='mso-special-character:footnote'><![if !supportFootnotes]>[4]<![endif]></span></span></span></a>
The standard library specification of <span class=CodeText><span
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
mso-bidi-font-family:Arial'>strcpy</span></span> also includes other LCLint
annotations: a <span class=Keyword><span style='font-size:8.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>modifies</span></span> clause that indicates that the
only thing that may be modified by <span class=CodeText><span style='font-size:
8.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";mso-bidi-font-family:
Arial'>strcpy</span></span> is the storage referenced by <span class=CodeText><span
style='font-family:"Courier New";mso-bidi-font-family:Arial'>s1</span></span>,
an <span class=Keyword><span style='font-size:8.0pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>out</span></span> annotation on <span class=CodeText><span
style='font-family:"Courier New";mso-bidi-font-family:Arial'>s1</span></span>
to indicate that it need not point to defined storage when <span
class=CodeText><span style='font-family:"Courier New";mso-bidi-font-family:
Arial'>strcpy</span></span> is called, a <span class=Keyword><span
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>unique</span></span>
annotation on <span class=CodeText><span style='font-family:"Courier New";
mso-bidi-font-family:Arial'>s1</span></span> to indicate that it may not alias
the same storage as <span class=CodeText><span style='font-family:"Courier New";
mso-bidi-font-family:Arial'>s2</span></span>, and a <span class=Keyword><span
style='font-size:8.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>returned</span></span>
annotation on <span class=CodeText><span style='font-family:"Courier New";
mso-bidi-font-family:Arial'>s1</span></span> to indicate that the returned
pointer references the same storage as <span class=CodeText><span
style='font-family:"Courier New";mso-bidi-font-family:Arial'>s1</span></span>.<span
style="mso-spacerun: yes">  </span>For clarity, the examples in this paper show
only the annotations directly relevant to detecting buffer overflow
vulnerabilities.<span style="mso-spacerun: yes">  </span>For more information
on other LCLint annotations, see [Evans96, Evans00c].</p>

</div>

<div style='mso-element:footnote' id=ftn5>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn5' href="#_ftnref5"
name="_ftn5" title=""><span class=MsoFootnoteReference><span style='font-size:
9.5pt;mso-bidi-font-size:10.0pt'><span style='mso-special-character:footnote'><![if !supportFootnotes]>[5]<![endif]></span></span></span></a>
The source code for <span style='font-size:8.5pt;mso-bidi-font-size:10.0pt;
font-family:Arial;mso-bidi-font-family:"Times New Roman"'>wu-ftpd</span> is
available from <span class=Keyword><span style='font-size:8.5pt;mso-bidi-font-size:
10.0pt;font-family:Arial'>http://www.wu-ftpd.org</span></span>.<span
style="mso-spacerun: yes">  </span>We analyzed the version in <span
style='font-size:8.5pt;mso-bidi-font-size:10.0pt;font-family:Arial;mso-bidi-font-family:
"Times New Roman"'>ftp://ftp.wu-ftpd.org/pub/wu-ftpd-attic/wu-ftpd-2.5.0.tar.gz</span>.<span
style="mso-spacerun: yes">    </span>We configured <span class=Keyword><span
style='font-size:8.5pt;mso-bidi-font-size:10.0pt;font-family:Arial'>wu-ftpd</span></span>
using the default configuration for FreeBSD systems.<span style="mso-spacerun:
yes">  </span>Since LCLint performs most of its analyses on code that has been
pre-processed, our analysis did not examine platform-specific code in <span
class=Keyword><span style='font-size:8.5pt;mso-bidi-font-size:10.0pt;
font-family:Arial'>wu-ftpd</span></span> for platforms other than FreeBSD.</p>

</div>

<div style='mso-element:footnote' id=ftn6>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn6' href="#_ftnref6"
name="_ftn6" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[6]<![endif]></span></span></a> For our
prototype implementation, we have not yet attempted to produce messages that
can easily be interpreted by typical programmers.<span style="mso-spacerun:
yes">  </span>Instead, we generate error messages that reveal information
useful to the LCLint developers.<span style="mso-spacerun: yes"> 
</span>Generating good error messages is a challenging problem; we plan to
devote more effort to this before publicly releasing our tool.</p>

</div>

<div style='mso-element:footnote' id=ftn7>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn7' href="#_ftnref7"
name="_ftn7" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[7]<![endif]></span></span></a> Because <span
class=CodeText><span style='font-family:"Courier New";mso-bidi-font-family:
Arial'>strncpy</span></span> does not guarantee null termination, it is
necessary to explicitly put a null character at the end of the buffer.</p>

</div>

<div style='mso-element:footnote' id=ftn8>

<p class=MsoFootnoteText style='text-align:justify'><a style='mso-footnote-id:
ftn8' href="#_ftnref8" name="_ftn8" title=""><span class=MsoFootnoteReference><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[8]<![endif]></span></span></span></a><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'> </span>Advisories for this
vulnerability can be found at <span class=Keyword><span style='font-family:
Arial'>http://www.cert.org/advisories/CA-1999-13.html </span></span>and<span
class=Keyword><span style='font-family:Arial'>
ftp://www.auscert.org.au/security/advisory/AA-1999.01.wu-ftpd.mapping_chdir.vul</span></span><span
style='font-size:9.5pt;mso-bidi-font-size:10.0pt'>. <o:p></o:p></span></p>

</div>

<div style='mso-element:footnote' id=ftn9>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn9' href="#_ftnref9"
name="_ftn9" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[9]<![endif]></span></span></a> The source
code is available at <span class=Keyword><span style='font-family:Arial'>ftp://ftp.isc.org/isc/bind/src/8.2.2-P7/bind-src.tar.gz</span></span></p>

</div>

<div style='mso-element:footnote' id=ftn10>

<p class=MsoFootnoteText style='text-align:justify'><a style='mso-footnote-id:
ftn10' href="#_ftnref10" name="_ftn10" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]>[10]<![endif]></span></span></a>
An advisory for this vulnerability can be found at <span style='font-family:
Arial;mso-bidi-font-family:"Times New Roman"'>http://lwn.net/2001/0201/a/covert-bind.php3</span>.</p>

</div>

</div>

</body>

</html>
