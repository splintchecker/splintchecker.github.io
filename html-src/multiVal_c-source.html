<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>multiVal.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.3 on Fri Nov 3 18:57:43 2000 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>multiVal.c</h1><a href="multiVal_c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">** LCLint - annotation-assisted static program checker</font>
00003 <font class="comment">** Copyright (C) 1994-2000 University of Virginia,</font>
00004 <font class="comment">**         Massachusetts Institute of Technology</font>
00005 <font class="comment">**</font>
00006 <font class="comment">** This program is free software; you can redistribute it and/or modify it</font>
00007 <font class="comment">** under the terms of the GNU General Public License as published by the</font>
00008 <font class="comment">** Free Software Foundation; either version 2 of the License, or (at your</font>
00009 <font class="comment">** option) any later version.</font>
00010 <font class="comment">** </font>
00011 <font class="comment">** This program is distributed in the hope that it will be useful, but</font>
00012 <font class="comment">** WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00014 <font class="comment">** General Public License for more details.</font>
00015 <font class="comment">** </font>
00016 <font class="comment">** The GNU General Public License is available from http://www.gnu.org/ or</font>
00017 <font class="comment">** the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston,</font>
00018 <font class="comment">** MA 02111-1307, USA.</font>
00019 <font class="comment">**</font>
00020 <font class="comment">** For information on lclint: lclint-request@cs.virginia.edu</font>
00021 <font class="comment">** To report a bug: lclint-bug@cs.virginia.edu</font>
00022 <font class="comment">** For more information: http://lclint.cs.virginia.edu</font>
00023 <font class="comment">*/</font>
00024 <font class="comment">/*</font>
00025 <font class="comment">** multiVal.c</font>
00026 <font class="comment">*/</font>
00027 
00028 <font class="preprocessor"># include "lclintMacros.nf"</font>
00029 <font class="preprocessor"># include "basic.h"</font>
00030 
<a name="l00031"></a><a class="code" href="multiVal_c.html#a0">00031</a> <font class="comment">/*@only@*/</font> multiVal <a class="code" href="multiVal_c.html#a0">multiVal_unknown</a> ()<font class="keyword"></font>
00032 <font class="keyword"></font>{
00033   <font class="keywordflow">return</font> multiVal_undefined;
00034 }
00035 
00036 <font class="keyword">static</font> <font class="comment">/*@special@*/</font> <font class="comment">/*@notnull@*/</font> multiVal multiVal_create (mvkind kind)
00037    <font class="comment">/*@defines result-&gt;kind@*/</font>
00038 {
00039   multiVal mv = (multiVal) dmalloc (<font class="keyword">sizeof</font> (*mv));
00040 
00041   mv-&gt;kind = kind;
00042   <font class="keywordflow">return</font> mv;
00043 }
00044 
<a name="l00045"></a><a class="code" href="multiVal_c.html#a2">00045</a> <font class="comment">/*@only@*/</font> multiVal <a class="code" href="multiVal_c.html#a2">multiVal_makeInt</a> (<font class="keywordtype">long</font> x)<font class="keyword"></font>
00046 <font class="keyword"></font>{
00047   multiVal mv = multiVal_create (MVLONG);
00048 
00049   mv-&gt;value.ival = x;
00050   <font class="keywordflow">return</font> mv;
00051 }
00052 
<a name="l00053"></a><a class="code" href="multiVal_c.html#a3">00053</a> <font class="comment">/*@only@*/</font> multiVal <a class="code" href="multiVal_c.html#a3">multiVal_makeChar</a> (<font class="keywordtype">char</font> x)<font class="keyword"></font>
00054 <font class="keyword"></font>{
00055   multiVal mv = multiVal_create (MVCHAR);
00056     mv-&gt;value.cval = x;
00057     <font class="keywordflow">return</font> mv;
00058 }
00059 
<a name="l00060"></a><a class="code" href="multiVal_c.html#a4">00060</a> <font class="comment">/*@only@*/</font> multiVal <a class="code" href="multiVal_c.html#a4">multiVal_makeDouble</a> (<font class="keywordtype">double</font> x)<font class="keyword"></font>
00061 <font class="keyword"></font>{
00062   multiVal mv = multiVal_create (MVDOUBLE);
00063 
00064     mv-&gt;value.fval = x;
00065     <font class="keywordflow">return</font> mv;
00066 }
00067 
<a name="l00068"></a><a class="code" href="multiVal_c.html#a5">00068</a> <font class="comment">/*@only@*/</font> multiVal <a class="code" href="multiVal_c.html#a5">multiVal_makeString</a> (<font class="comment">/*@only@*/</font> cstring s)<font class="keyword"></font>
00069 <font class="keyword"></font>{
00070   multiVal mv = multiVal_create (MVSTRING);
00071 
00072   mv-&gt;value.sval = s;
00073   <font class="keywordflow">return</font> mv;
00074 }
00075 
00076 
<a name="l00077"></a><a class="code" href="multiVal_c.html#a6">00077</a> <font class="comment">/*@only@*/</font> multiVal <a class="code" href="multiVal_c.html#a6">multiVal_copy</a> (multiVal m)<font class="keyword"></font>
00078 <font class="keyword"></font>{
00079   multiVal r;
00080 
00081   <font class="keywordflow">if</font> (multiVal_isUndefined (m))
00082     {
00083       <font class="keywordflow">return</font> multiVal_undefined;
00084     }
00085 
00086   r = multiVal_create (m-&gt;kind);
00087       
00088   <font class="keywordflow">switch</font> (m-&gt;kind)
00089     {
00090     <font class="keywordflow">case</font> MVLONG:
00091       r-&gt;value.ival = m-&gt;value.ival;
00092       <font class="keywordflow">break</font>;
00093     <font class="keywordflow">case</font> MVCHAR:
00094       r-&gt;value.cval = m-&gt;value.cval;
00095       <font class="keywordflow">break</font>;
00096     <font class="keywordflow">case</font> MVDOUBLE:
00097       r-&gt;value.fval = m-&gt;value.fval;
00098       <font class="keywordflow">break</font>;
00099     <font class="keywordflow">case</font> MVSTRING:
00100       r-&gt;value.sval = <a class="code" href="cstring_c.html#a9">cstring_copy</a> (m-&gt;value.sval);
00101       <font class="keywordflow">break</font>;
00102     }
00103   
00104   <font class="keywordflow">return</font> r;
00105 }
00106 
<a name="l00107"></a><a class="code" href="multiVal_c.html#a7">00107</a> multiVal <a class="code" href="multiVal_c.html#a7">multiVal_invert</a> (multiVal m)<font class="keyword"></font>
00108 <font class="keyword"></font>{
00109   <font class="keywordflow">if</font> (multiVal_isUndefined (m))
00110     {
00111       <font class="keywordflow">return</font> multiVal_undefined;
00112     }
00113       
00114   <font class="keywordflow">switch</font> (m-&gt;kind)
00115     {
00116     <font class="keywordflow">case</font> MVLONG:
00117       <font class="keywordflow">return</font> <a class="code" href="multiVal_c.html#a2">multiVal_makeInt</a> (-1 * m-&gt;value.ival);
00118     <font class="keywordflow">case</font> MVCHAR:
00119       BADBRANCHCONT;
00120       <font class="keywordflow">return</font> multiVal_undefined;
00121     <font class="keywordflow">case</font> MVDOUBLE:
00122       <font class="keywordflow">return</font> <a class="code" href="multiVal_c.html#a4">multiVal_makeDouble</a> (-1.0 * m-&gt;value.fval);
00123     <font class="keywordflow">case</font> MVSTRING:
00124       BADBRANCHCONT;
00125       <font class="keywordflow">return</font> multiVal_undefined;
00126     }
00127 
00128   BADEXIT;
00129 }
00130 
<a name="l00131"></a><a class="code" href="multiVal_c.html#a8">00131</a> <font class="keywordtype">long</font> <a class="code" href="multiVal_c.html#a8">multiVal_forceInt</a> (multiVal m)<font class="keyword"></font>
00132 <font class="keyword"></font>{
00133   llassert (multiVal_isInt (m));
00134 
00135   <font class="keywordflow">return</font> m-&gt;value.ival;
00136 }
00137 
<a name="l00138"></a><a class="code" href="multiVal_c.html#a9">00138</a> <font class="keywordtype">char</font> <a class="code" href="multiVal_c.html#a9">multiVal_forceChar</a> (multiVal m)<font class="keyword"></font>
00139 <font class="keyword"></font>{
00140   llassert (multiVal_isChar (m));
00141   
00142   <font class="keywordflow">return</font> m-&gt;value.cval;
00143 }
00144 
<a name="l00145"></a><a class="code" href="multiVal_c.html#a10">00145</a> <font class="keywordtype">double</font> <a class="code" href="multiVal_c.html#a10">multiVal_forceDouble</a> (multiVal m)<font class="keyword"></font>
00146 <font class="keyword"></font>{
00147   llassert (multiVal_isDouble (m));
00148 
00149   <font class="keywordflow">return</font> m-&gt;value.fval;
00150 }
00151 
<a name="l00152"></a><a class="code" href="multiVal_c.html#a11">00152</a> <font class="comment">/*@dependent@*/</font> <font class="comment">/*@observer@*/</font> cstring <a class="code" href="multiVal_c.html#a11">multiVal_forceString</a> (multiVal m)<font class="keyword"></font>
00153 <font class="keyword"></font>{
00154   llassert (multiVal_isString (m));
00155 
00156   <font class="keywordflow">return</font> m-&gt;value.sval;
00157 }
00158 
<a name="l00159"></a><a class="code" href="multiVal_c.html#a12">00159</a> <font class="keywordtype">bool</font> <a class="code" href="multiVal_c.html#a12">multiVal_isInt</a> (multiVal m)<font class="keyword"></font>
00160 <font class="keyword"></font>{
00161   <font class="keywordflow">return</font> (multiVal_isDefined (m) &amp;&amp; m-&gt;kind == MVLONG);
00162 }
00163 
<a name="l00164"></a><a class="code" href="multiVal_c.html#a13">00164</a> <font class="keywordtype">bool</font> <a class="code" href="multiVal_c.html#a13">multiVal_isChar</a> (multiVal m)<font class="keyword"></font>
00165 <font class="keyword"></font>{
00166   <font class="keywordflow">return</font> (multiVal_isDefined (m) &amp;&amp; m-&gt;kind == MVCHAR);
00167 }
00168 
<a name="l00169"></a><a class="code" href="multiVal_c.html#a14">00169</a> <font class="keywordtype">bool</font> <a class="code" href="multiVal_c.html#a14">multiVal_isDouble</a> (multiVal m)<font class="keyword"></font>
00170 <font class="keyword"></font>{
00171   <font class="keywordflow">return</font> (multiVal_isDefined (m) &amp;&amp; m-&gt;kind == MVDOUBLE);
00172 }
00173 
<a name="l00174"></a><a class="code" href="multiVal_c.html#a15">00174</a> <font class="keywordtype">bool</font> <a class="code" href="multiVal_c.html#a15">multiVal_isString</a> (multiVal m)<font class="keyword"></font>
00175 <font class="keyword"></font>{
00176   <font class="keywordflow">return</font> (multiVal_isDefined (m) &amp;&amp; m-&gt;kind == MVSTRING);
00177 }
00178 
<a name="l00179"></a><a class="code" href="multiVal_c.html#a16">00179</a> <font class="comment">/*@only@*/</font> cstring <a class="code" href="multiVal_c.html#a16">multiVal_unparse</a> (multiVal m)<font class="keyword"></font>
00180 <font class="keyword"></font>{
00181   <font class="keywordflow">if</font> (multiVal_isDefined (m))
00182     {
00183       <font class="keywordflow">switch</font> (m-&gt;kind)
00184         {
00185         <font class="keywordflow">case</font> MVLONG:
00186           <font class="keywordflow">return</font> <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%d"</font>, (<font class="keywordtype">int</font>)m-&gt;value.ival);
00187         <font class="keywordflow">case</font> MVCHAR:
00188                   <font class="keywordflow">return</font> <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"'%h'"</font>, m-&gt;value.cval);
00189         <font class="keywordflow">case</font> MVDOUBLE:
00190           <font class="keywordflow">return</font> <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%f"</font>, (<font class="keywordtype">float</font>)m-&gt;value.fval);
00191         <font class="keywordflow">case</font> MVSTRING:
00192           <font class="keywordflow">return</font> <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%s"</font>, m-&gt;value.sval);
00193         }
00194       BADEXIT;
00195     }
00196   <font class="keywordflow">else</font>
00197     {
00198       <font class="keywordflow">return</font> (cstring_makeLiteral (<font class="stringliteral">"?"</font>));
00199     }
00200 }
00201 
<a name="l00202"></a><a class="code" href="multiVal_c.html#a17">00202</a> <font class="comment">/*@only@*/</font> cstring <a class="code" href="multiVal_c.html#a17">multiVal_dump</a> (multiVal m)<font class="keyword"></font>
00203 <font class="keyword"></font>{
00204   <font class="keywordflow">if</font> (multiVal_isDefined (m))
00205     {
00206       <font class="keywordflow">switch</font> (m-&gt;kind)
00207         {
00208         <font class="keywordflow">case</font> MVLONG:
00209           <font class="keywordflow">return</font> (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"i%d"</font>, (<font class="keywordtype">int</font>)m-&gt;value.ival));
00210         <font class="keywordflow">case</font> MVCHAR:
00211           <font class="keywordflow">return</font> (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"c%d"</font>, (<font class="keywordtype">int</font>)m-&gt;value.cval));
00212         <font class="keywordflow">case</font> MVDOUBLE:
00213           <font class="keywordflow">return</font> (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"d%f"</font>, (<font class="keywordtype">float</font>)m-&gt;value.fval));
00214         <font class="keywordflow">case</font> MVSTRING:
00215           <font class="keywordflow">return</font> (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"s%s"</font>, m-&gt;value.sval));
00216         }
00217       BADEXIT;
00218     }
00219   <font class="keywordflow">else</font>
00220     {
00221       <font class="keywordflow">return</font> (cstring_undefined);
00222     }
00223 }
00224 
<a name="l00225"></a><a class="code" href="multiVal_c.html#a18">00225</a> <font class="comment">/*@only@*/</font> multiVal <a class="code" href="multiVal_c.html#a18">multiVal_undump</a> (<font class="keywordtype">char</font> **s)<font class="keyword"></font>
00226 <font class="keyword"></font>{
00227   <font class="keywordtype">char</font> tchar = **s;
00228 
00229   <font class="keywordflow">switch</font> (tchar)
00230     {
00231     <font class="keywordflow">case</font> <font class="charliteral">'i'</font>:
00232       (*s)++;
00233       <font class="keywordflow">return</font> <a class="code" href="multiVal_c.html#a2">multiVal_makeInt</a> (getInt (s));
00234     <font class="keywordflow">case</font> <font class="charliteral">'c'</font>:
00235       (*s)++;
00236       <font class="keywordflow">return</font> <a class="code" href="multiVal_c.html#a3">multiVal_makeChar</a> ((<font class="keywordtype">char</font>) <a class="code" href="general_c.html#a16">getInt</a> (s));
00237     <font class="keywordflow">case</font> <font class="charliteral">'d'</font>:
00238       (*s)++;
00239       <font class="keywordflow">return</font> <a class="code" href="multiVal_c.html#a4">multiVal_makeDouble</a> (getDouble (s));
00240     <font class="keywordflow">case</font> <font class="charliteral">'s'</font>:
00241       {
00242         cstring st = cstring_undefined;
00243 
00244         (*s)++;
00245         <font class="keywordflow">while</font> (**s != <font class="charliteral">'#'</font>)
00246           {
00247             st = <a class="code" href="cstring_c.html#a37">cstring_appendChar</a> (st, **s);
00248             (*s)++;
00249           }
00250 
00251         <font class="keywordflow">return</font> <a class="code" href="multiVal_c.html#a5">multiVal_makeString</a> (st);
00252       }
00253     <font class="keywordflow">case</font> <font class="charliteral">'@'</font>:
00254     <font class="keywordflow">case</font> <font class="charliteral">'#'</font>:
00255       <font class="keywordflow">return</font> <a class="code" href="multiVal_c.html#a0">multiVal_unknown</a> ();
00256     BADDEFAULT;
00257     }
00258   
00259   BADEXIT;
00260 }
00261 
<a name="l00262"></a><a class="code" href="multiVal_c.html#a19">00262</a> <font class="keywordtype">int</font> <a class="code" href="multiVal_c.html#a19">multiVal_compare</a> (multiVal m1, multiVal m2)<font class="keyword"></font>
00263 <font class="keyword"></font>{
00264   <font class="keywordflow">if</font> (multiVal_isUndefined (m1))
00265     {
00266       <font class="keywordflow">if</font> (multiVal_isUndefined (m2)) 
00267         {
00268           <font class="keywordflow">return</font> 0;
00269         }
00270 
00271       <font class="keywordflow">else</font> <font class="keywordflow">return</font> -1;
00272     }
00273   <font class="keywordflow">if</font> (multiVal_isUndefined (m2))
00274     {
00275       <font class="keywordflow">return</font> -1;
00276     }
00277 
00278   COMPARERETURN (generic_compare (m1-&gt;kind, m2-&gt;kind));
00279 
00280   <font class="keywordflow">switch</font> (m1-&gt;kind)
00281     {
00282     <font class="keywordflow">case</font> MVLONG:   <font class="keywordflow">return</font> (generic_compare (m1-&gt;value.ival, m2-&gt;value.ival));
00283     <font class="keywordflow">case</font> MVCHAR:   <font class="keywordflow">return</font> (generic_compare (m1-&gt;value.cval, m2-&gt;value.cval));
00284     <font class="keywordflow">case</font> MVDOUBLE: <font class="keywordflow">return</font> (generic_compare (m1-&gt;value.fval, m2-&gt;value.fval));
00285     <font class="keywordflow">case</font> MVSTRING: <font class="keywordflow">return</font> (<a class="code" href="cstring_c.html#a25">cstring_compare</a> (m1-&gt;value.sval, m2-&gt;value.sval));
00286     }
00287 
00288   BADEXIT;
00289 }
00290 
<a name="l00291"></a><a class="code" href="multiVal_c.html#a20">00291</a> <font class="keywordtype">void</font> <a class="code" href="multiVal_c.html#a20">multiVal_free</a> (<font class="comment">/*@only@*/</font> multiVal m)<font class="keyword"></font>
00292 <font class="keyword"></font>{
00293   <font class="keywordflow">if</font> (multiVal_isDefined (m))
00294     {
00295       <font class="keywordflow">if</font> (m-&gt;kind == MVSTRING)
00296         {
00297           <a class="code" href="cstring_c.html#a27">cstring_free</a> (m-&gt;value.sval);
00298         }
00299       
00300       <a class="code" href="general_c.html#a0">sfree</a> (m);
00301     }
00302 }
00303 
00304 
00305 
00306 
</div></pre><hr><address><small>Generated at Fri Nov 3 18:57:43 2000 for LCLint by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.3 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
