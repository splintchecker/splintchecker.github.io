<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>guardSet.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.3 on Fri Nov 3 18:57:41 2000 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>guardSet.c</h1><a href="guardSet_c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">** LCLint - annotation-assisted static program checker</font>
00003 <font class="comment">** Copyright (C) 1994-2000 University of Virginia,</font>
00004 <font class="comment">**         Massachusetts Institute of Technology</font>
00005 <font class="comment">**</font>
00006 <font class="comment">** This program is free software; you can redistribute it and/or modify it</font>
00007 <font class="comment">** under the terms of the GNU General Public License as published by the</font>
00008 <font class="comment">** Free Software Foundation; either version 2 of the License, or (at your</font>
00009 <font class="comment">** option) any later version.</font>
00010 <font class="comment">** </font>
00011 <font class="comment">** This program is distributed in the hope that it will be useful, but</font>
00012 <font class="comment">** WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00014 <font class="comment">** General Public License for more details.</font>
00015 <font class="comment">** </font>
00016 <font class="comment">** The GNU General Public License is available from http://www.gnu.org/ or</font>
00017 <font class="comment">** the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston,</font>
00018 <font class="comment">** MA 02111-1307, USA.</font>
00019 <font class="comment">**</font>
00020 <font class="comment">** For information on lclint: lclint-request@cs.virginia.edu</font>
00021 <font class="comment">** To report a bug: lclint-bug@cs.virginia.edu</font>
00022 <font class="comment">** For more information: http://lclint.cs.virginia.edu</font>
00023 <font class="comment">*/</font>
00024 <font class="comment">/*</font>
00025 <font class="comment">** guardSet.c</font>
00026 <font class="comment">**</font>
00027 <font class="comment">** if x is in true guards, then x is not null on this branch,</font>
00028 <font class="comment">**                          and x is "probably" null on the other branch.</font>
00029 <font class="comment">** if x is in false guards, then x is "probably" null on this branch,</font>
00030 <font class="comment">**                          and x is not null on the other branch.</font>
00031 <font class="comment">**</font>
00032 <font class="comment">** Either guards is obsolete and should be removed soon.</font>
00033 <font class="comment">*/</font>
00034 
00035 <font class="preprocessor"># include "lclintMacros.nf"</font>
00036 <font class="preprocessor"># include "basic.h"</font>
00037 
<a name="l00038"></a><a class="code" href="guardSet_c.html#a0">00038</a> guardSet <a class="code" href="guardSet_c.html#a0">guardSet_new</a> ()<font class="keyword"></font>
00039 <font class="keyword"></font>{
00040   <font class="keywordflow">return</font> guardSet_undefined;
00041 }
00042 
00043 <font class="keyword">static</font> <font class="comment">/*@notnull@*/</font> <font class="comment">/*@special@*/</font> guardSet guardSet_newEmpty (<font class="keywordtype">void</font>)
00044    <font class="comment">/*@defines result@*/</font>
00045    <font class="comment">/*@post:isnull result-&gt;tguard, result-&gt;fguard@*/</font>
00046 {
00047   guardSet g = (guardSet) dmalloc (<font class="keyword">sizeof</font> (*g));
00048 
00049   g-&gt;tguard = sRefSet_undefined;
00050   g-&gt;fguard = sRefSet_undefined;
00051 
00052   <font class="keywordflow">return</font> g;
00053 }
00054 
<a name="l00055"></a><a class="code" href="guardSet_c.html#a2">00055</a> sRefSet <a class="code" href="guardSet_c.html#a2">guardSet_getTrueGuards</a> (guardSet g)<font class="keyword"></font>
00056 <font class="keyword"></font>{
00057   
00058   <font class="keywordflow">if</font> (guardSet_isDefined (g))
00059     {
00060       <font class="keywordflow">return</font> (g-&gt;tguard);
00061     }
00062   <font class="keywordflow">else</font>
00063     {
00064       <font class="keywordflow">return</font> (sRefSet_undefined);
00065     }
00066 }
00067 
<a name="l00068"></a><a class="code" href="guardSet_c.html#a3">00068</a> <font class="keywordtype">void</font> <a class="code" href="guardSet_c.html#a3">guardSet_delete</a> (guardSet g, sRef s)<font class="keyword"> </font>
00069 <font class="keyword"></font>{
00070   <font class="keywordtype">bool</font> res;
00071   llassert (guardSet_isDefined (g));
00072   res = <a class="code" href="sRefSet_c.html#a7">sRefSet_delete</a> (g-&gt;tguard, s);
00073   
00074   <font class="comment">/*</font>
00075 <font class="comment">  ** This assertion is no longer always true:</font>
00076 <font class="comment">  ** llassert (res);</font>
00077 <font class="comment">  */</font>
00078 }
00079 
<a name="l00080"></a><a class="code" href="guardSet_c.html#a4">00080</a> <font class="comment">/*@dependent@*/</font> <font class="comment">/*@exposed@*/</font> sRefSet <a class="code" href="guardSet_c.html#a4">guardSet_getFalseGuards</a> (guardSet g)<font class="keyword"></font>
00081 <font class="keyword"></font>{
00082   <font class="keywordflow">if</font> (guardSet_isDefined (g))
00083     { 
00084       <font class="keywordflow">return</font> (g-&gt;fguard);
00085     }
00086   <font class="keywordflow">else</font>
00087     {
00088       <font class="keywordflow">return</font> (sRefSet_undefined);
00089     }
00090 }
00091 
<a name="l00092"></a><a class="code" href="guardSet_c.html#a5">00092</a> guardSet <a class="code" href="guardSet_c.html#a5">guardSet_or</a> (<font class="comment">/*@returned@*/</font> <font class="comment">/*@unique@*/</font> guardSet s, guardSet t)<font class="keyword"></font>
00093 <font class="keyword"></font>{
00094   
00095   llassert (NOALIAS (s, t));
00096 
00097   <font class="keywordflow">if</font> (s == guardSet_undefined)
00098     {
00099       <font class="keywordflow">if</font> (t == guardSet_undefined)
00100         {
00101           <font class="keywordflow">return</font> s;
00102         }
00103 
00104       s = guardSet_newEmpty ();
00105     }
00106 
00107   <font class="keywordflow">if</font> (t == guardSet_undefined)
00108     {
00109       <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (s-&gt;tguard);
00110       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a0">sRefSet_new</a> ();
00111     }
00112   <font class="keywordflow">else</font>
00113     {
00114       sRefSet last;
00115 
00116       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a15">sRefSet_intersect</a> (last = s-&gt;tguard, t-&gt;tguard);
00117       <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (last);
00118       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a12">sRefSet_union</a> (s-&gt;fguard, t-&gt;fguard);
00119     }
00120   
00121   
00122   <font class="keywordflow">return</font> s;
00123 }
00124 
<a name="l00125"></a><a class="code" href="guardSet_c.html#a6">00125</a> guardSet <a class="code" href="guardSet_c.html#a6">guardSet_and</a> (<font class="comment">/*@returned@*/</font> <font class="comment">/*@unique@*/</font> guardSet s, guardSet t)<font class="keyword"></font>
00126 <font class="keyword"></font>{
00127   llassert (NOALIAS (s, t));
00128 
00129   <font class="keywordflow">if</font> (s == guardSet_undefined)
00130     {
00131       <font class="keywordflow">if</font> (t == guardSet_undefined)
00132         {
00133           <font class="keywordflow">return</font> s;
00134         }
00135 
00136       s = guardSet_newEmpty ();
00137     }
00138 
00139   <font class="keywordflow">if</font> (t == guardSet_undefined)
00140     {
00141       <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (s-&gt;fguard);
00142       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a0">sRefSet_new</a> ();
00143     }
00144   <font class="keywordflow">else</font>
00145     {
00146       sRefSet last;
00147 
00148       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a12">sRefSet_union</a> (s-&gt;tguard, t-&gt;tguard);
00149 
00150       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a15">sRefSet_intersect</a> (last = s-&gt;fguard, t-&gt;fguard);
00151       <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (last);
00152     }
00153   
00154   <font class="keywordflow">return</font> s;
00155 }
00156 
<a name="l00157"></a><a class="code" href="guardSet_c.html#a7">00157</a> <font class="comment">/*@only@*/</font> guardSet <a class="code" href="guardSet_c.html#a7">guardSet_union</a> (<font class="comment">/*@only@*/</font> guardSet s, guardSet t)<font class="keyword"></font>
00158 <font class="keyword"></font>{
00159   <font class="keywordflow">if</font> (t == guardSet_undefined) <font class="keywordflow">return</font> s; 
00160 
00161   llassert (NOALIAS (s, t));
00162 
00163   <font class="keywordflow">if</font> (guardSet_isDefined (s)) 
00164     {
00165       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a12">sRefSet_union</a> (s-&gt;tguard, t-&gt;tguard);
00166       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a12">sRefSet_union</a> (s-&gt;fguard, t-&gt;fguard);
00167     }
00168   <font class="keywordflow">else</font>
00169     {
00170       s = guardSet_newEmpty ();
00171 
00172       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a19">sRefSet_newCopy</a> (t-&gt;tguard);
00173       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a19">sRefSet_newCopy</a> (t-&gt;fguard);
00174     }
00175 
00176   <font class="keywordflow">return</font> s;
00177 }
00178 
<a name="l00179"></a><a class="code" href="guardSet_c.html#a8">00179</a> guardSet <a class="code" href="guardSet_c.html#a8">guardSet_levelUnion</a> (<font class="comment">/*@only@*/</font> guardSet s, guardSet t, <font class="keywordtype">int</font> lexlevel)<font class="keyword"></font>
00180 <font class="keyword"></font>{
00181   <font class="keywordflow">if</font> (t == guardSet_undefined) <font class="keywordflow">return</font> s;
00182 
00183   llassert (NOALIAS (s, t));
00184 
00185   <font class="keywordflow">if</font> (guardSet_isDefined (s))
00186     {
00187       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a16">sRefSet_levelUnion</a> (s-&gt;tguard, t-&gt;tguard, lexlevel);
00188       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a16">sRefSet_levelUnion</a> (s-&gt;fguard, t-&gt;fguard, lexlevel);
00189     }
00190   <font class="keywordflow">else</font>
00191     {
00192       s = guardSet_newEmpty ();
00193 
00194       <font class="comment">/* should be necessary! */</font>
00195 
00196       <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (s-&gt;tguard);
00197       <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (s-&gt;fguard);
00198 
00199       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a20">sRefSet_levelCopy</a> (t-&gt;tguard, lexlevel);
00200       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a20">sRefSet_levelCopy</a> (t-&gt;fguard, lexlevel);
00201     }
00202 
00203   <font class="keywordflow">return</font> s;
00204 }
00205 
00206 guardSet 
<a name="l00207"></a><a class="code" href="guardSet_c.html#a9">00207</a>   <a class="code" href="guardSet_c.html#a9">guardSet_levelUnionFree</a> (<font class="comment">/*@returned@*/</font> <font class="comment">/*@unique@*/</font> guardSet s,
00208                            <font class="comment">/*@only@*/</font> guardSet t, <font class="keywordtype">int</font> lexlevel)<font class="keyword"></font>
00209 <font class="keyword"></font>{
00210   <font class="keywordflow">if</font> (t == guardSet_undefined) <font class="keywordflow">return</font> s;
00211 
00212   <font class="keywordflow">if</font> (guardSet_isDefined (s))
00213     {
00214       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a16">sRefSet_levelUnion</a> (s-&gt;tguard, t-&gt;tguard, lexlevel);
00215       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a16">sRefSet_levelUnion</a> (s-&gt;fguard, t-&gt;fguard, lexlevel);
00216     }
00217   <font class="keywordflow">else</font>
00218     {
00219       s = guardSet_newEmpty ();
00220 
00221       <font class="comment">/* should be necessary! */</font>
00222 
00223       <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (s-&gt;tguard);
00224       <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (s-&gt;fguard);
00225 
00226       s-&gt;tguard = <a class="code" href="sRefSet_c.html#a20">sRefSet_levelCopy</a> (t-&gt;tguard, lexlevel);
00227       s-&gt;fguard = <a class="code" href="sRefSet_c.html#a20">sRefSet_levelCopy</a> (t-&gt;fguard, lexlevel);
00228     }
00229 
00230   <a class="code" href="guardSet_c.html#a16">guardSet_free</a> (t);
00231   <font class="keywordflow">return</font> s;
00232 }
00233 
<a name="l00234"></a><a class="code" href="guardSet_c.html#a10">00234</a> <font class="keywordtype">void</font> <a class="code" href="guardSet_c.html#a10">guardSet_flip</a> (guardSet g)<font class="keyword"></font>
00235 <font class="keyword"></font>{
00236   <font class="keywordflow">if</font> (g != guardSet_undefined)
00237     {
00238       sRefSet tmp = g-&gt;tguard;
00239 
00240       g-&gt;tguard = g-&gt;fguard;      
00241       g-&gt;fguard = tmp;
00242     }
00243 }
00244 
<a name="l00245"></a><a class="code" href="guardSet_c.html#a11">00245</a> <font class="comment">/*@only@*/</font> guardSet <a class="code" href="guardSet_c.html#a11">guardSet_invert</a> (<font class="comment">/*@temp@*/</font> guardSet g)<font class="keyword"></font>
00246 <font class="keyword"></font>{
00247   <font class="keywordflow">if</font> (g != guardSet_undefined)
00248     {
00249       guardSet ret = guardSet_newEmpty ();
00250 
00251       ret-&gt;tguard = <a class="code" href="sRefSet_c.html#a19">sRefSet_newCopy</a> (g-&gt;fguard);      
00252       ret-&gt;fguard = <a class="code" href="sRefSet_c.html#a19">sRefSet_newCopy</a> (g-&gt;tguard);
00253 
00254       <font class="keywordflow">return</font> ret;
00255     }
00256   <font class="keywordflow">return</font> guardSet_undefined;
00257 }
00258 
<a name="l00259"></a><a class="code" href="guardSet_c.html#a12">00259</a> <font class="comment">/*@only@*/</font> guardSet <a class="code" href="guardSet_c.html#a12">guardSet_copy</a> (<font class="comment">/*@temp@*/</font> guardSet g)<font class="keyword"></font>
00260 <font class="keyword"></font>{
00261   <font class="keywordflow">if</font> (g != guardSet_undefined)
00262     {
00263       guardSet ret = guardSet_newEmpty ();
00264 
00265       ret-&gt;tguard = <a class="code" href="sRefSet_c.html#a19">sRefSet_newCopy</a> (g-&gt;tguard);      
00266       ret-&gt;fguard = <a class="code" href="sRefSet_c.html#a19">sRefSet_newCopy</a> (g-&gt;fguard);
00267 
00268       <font class="keywordflow">return</font> ret;
00269     }
00270   <font class="keywordflow">return</font> guardSet_undefined;
00271 }
00272   
<a name="l00273"></a><a class="code" href="guardSet_c.html#a13">00273</a> guardSet <a class="code" href="guardSet_c.html#a13">guardSet_addTrueGuard</a> (<font class="comment">/*@returned@*/</font> guardSet g, sRef s)<font class="keyword"></font>
00274 <font class="keyword"></font>{
00275   <font class="keywordflow">if</font> (sRef_isMeaningful (s))
00276     {
00277       <font class="keywordflow">if</font> (g == guardSet_undefined)
00278         {
00279           g = guardSet_newEmpty ();
00280         }
00281       
00282       g-&gt;tguard = <a class="code" href="sRefSet_c.html#a4">sRefSet_insert</a> (g-&gt;tguard, s);
00283     }
00284 
00285   <font class="keywordflow">return</font> g;
00286 }
00287 
<a name="l00288"></a><a class="code" href="guardSet_c.html#a14">00288</a> guardSet <a class="code" href="guardSet_c.html#a14">guardSet_addFalseGuard</a> (<font class="comment">/*@returned@*/</font> guardSet g, sRef s)<font class="keyword"></font>
00289 <font class="keyword"></font>{
00290   <font class="keywordflow">if</font> (sRef_isMeaningful (s))
00291     {
00292       <font class="keywordflow">if</font> (g == guardSet_undefined)
00293         {
00294           g = guardSet_newEmpty ();
00295         }
00296       
00297       g-&gt;fguard = <a class="code" href="sRefSet_c.html#a4">sRefSet_insert</a> (g-&gt;fguard, s);
00298     }
00299 
00300   <font class="keywordflow">return</font> g;
00301 }
00302 
<a name="l00303"></a><a class="code" href="guardSet_c.html#a15">00303</a> <font class="comment">/*@only@*/</font> cstring <a class="code" href="guardSet_c.html#a15">guardSet_unparse</a> (guardSet g)<font class="keyword"></font>
00304 <font class="keyword"></font>{
00305   <font class="keywordflow">if</font> (g == guardSet_undefined)
00306     {
00307       <font class="keywordflow">return</font> (cstring_makeLiteral (<font class="stringliteral">"&lt;no guards&gt;"</font>));
00308     }
00309   <font class="keywordflow">else</font>
00310     {
00311       <font class="keywordflow">return</font> (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"not null: %q / prob null: %q"</font>,
00312                        sRefSet_unparseDebug (g-&gt;tguard),
00313                        <a class="code" href="sRefSet_c.html#a37">sRefSet_unparseDebug</a> (g-&gt;fguard)));
00314     }
00315 }
00316 
<a name="l00317"></a><a class="code" href="guardSet_c.html#a16">00317</a> <font class="keywordtype">void</font> <a class="code" href="guardSet_c.html#a16">guardSet_free</a> (<font class="comment">/*@only@*/</font> guardSet g)<font class="keyword"></font>
00318 <font class="keyword"></font>{
00319   <font class="keywordflow">if</font> (g == guardSet_undefined) <font class="keywordflow">return</font>;
00320 
00321   <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (g-&gt;tguard);
00322   <a class="code" href="sRefSet_c.html#a39">sRefSet_free</a> (g-&gt;fguard);
00323   
00324   <a class="code" href="general_c.html#a0">sfree</a> (g);
00325 }
00326 
00327 <font class="keywordtype">bool</font>
<a name="l00328"></a><a class="code" href="guardSet_c.html#a17">00328</a> <a class="code" href="guardSet_c.html#a17">guardSet_isGuarded</a> (guardSet g, sRef s)<font class="keyword"></font>
00329 <font class="keyword"></font>{
00330   <font class="keywordflow">if</font> (g == guardSet_undefined) <font class="keywordflow">return</font> FALSE;
00331   
00332   <font class="keywordflow">return</font> (<a class="code" href="sRefSet_c.html#a27">sRefSet_member</a> (g-&gt;tguard, s));
00333 }
00334 
00335 <font class="keywordtype">bool</font>
<a name="l00336"></a><a class="code" href="guardSet_c.html#a18">00336</a> <a class="code" href="guardSet_c.html#a18">guardSet_isProbableNull</a> (guardSet g, sRef s)<font class="keyword"></font>
00337 <font class="keyword"></font>{
00338   <font class="keywordtype">bool</font> ret;
00339 
00340   <font class="keywordflow">if</font> (g == guardSet_undefined) <font class="keywordflow">return</font> FALSE;
00341 
00342   ret = <a class="code" href="sRefSet_c.html#a27">sRefSet_member</a> (g-&gt;fguard, s);
00343   <font class="keywordflow">return</font> ret;
00344 }
00345 
<a name="l00346"></a><a class="code" href="guardSet_c.html#a19">00346</a> <font class="keywordtype">bool</font> <a class="code" href="guardSet_c.html#a19">guardSet_isEmpty</a> (guardSet g)<font class="keyword"></font>
00347 <font class="keyword"></font>{
00348   <font class="keywordflow">if</font> (guardSet_isDefined (g))
00349     {
00350       <font class="keywordflow">return</font> (sRefSet_isEmpty (g-&gt;tguard) &amp;&amp; sRefSet_isEmpty (g-&gt;fguard));
00351     }
00352   <font class="keywordflow">else</font>
00353     {
00354       <font class="keywordflow">return</font> TRUE;
00355     }
00356 }
</div></pre><hr><address><small>Generated at Fri Nov 3 18:57:41 2000 for LCLint by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.3 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
