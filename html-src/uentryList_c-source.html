<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>uentryList.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.3 on Fri Nov 3 18:57:45 2000 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>uentryList.c</h1><a href="uentryList_c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">** LCLint - annotation-assisted static program checker</font>
00003 <font class="comment">** Copyright (C) 1994-2000 University of Virginia,</font>
00004 <font class="comment">**         Massachusetts Institute of Technology</font>
00005 <font class="comment">**</font>
00006 <font class="comment">** This program is free software; you can redistribute it and/or modify it</font>
00007 <font class="comment">** under the terms of the GNU General Public License as published by the</font>
00008 <font class="comment">** Free Software Foundation; either version 2 of the License, or (at your</font>
00009 <font class="comment">** option) any later version.</font>
00010 <font class="comment">** </font>
00011 <font class="comment">** This program is distributed in the hope that it will be useful, but</font>
00012 <font class="comment">** WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00014 <font class="comment">** General Public License for more details.</font>
00015 <font class="comment">** </font>
00016 <font class="comment">** The GNU General Public License is available from http://www.gnu.org/ or</font>
00017 <font class="comment">** the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston,</font>
00018 <font class="comment">** MA 02111-1307, USA.</font>
00019 <font class="comment">**</font>
00020 <font class="comment">** For information on lclint: lclint-request@cs.virginia.edu</font>
00021 <font class="comment">** To report a bug: lclint-bug@cs.virginia.edu</font>
00022 <font class="comment">** For more information: http://lclint.cs.virginia.edu</font>
00023 <font class="comment">*/</font>
00024 <font class="comment">/*</font>
00025 <font class="comment">** uentryList.c (from slist_template.c)</font>
00026 <font class="comment">*/</font>
00027 
00028 <font class="preprocessor"># include "lclintMacros.nf"</font>
00029 <font class="preprocessor"># include "basic.h"</font>
00030 
00031 <font class="comment">/*@only@*/</font> <font class="comment">/*@notnull@*/</font> uentryList
<a name="l00032"></a><a class="code" href="uentryList_c.html#a0">00032</a> <a class="code" href="uentryList_c.html#a0">uentryList_new</a> ()<font class="keyword"></font>
00033 <font class="keyword"></font>{
00034   uentryList s = (uentryList) dmalloc (<font class="keyword">sizeof</font> (*s));
00035   
00036   s-&gt;nelements = 0;
00037   s-&gt;nspace = uentryListBASESIZE;
00038   s-&gt;elements = (uentry *) 
00039     dmalloc (<font class="keyword">sizeof</font> (*s-&gt;elements) * uentryListBASESIZE);
00040   s-&gt;current = 0;
00041 
00042   <font class="keywordflow">return</font> (s);
00043 }
00044 
00045 <font class="comment">/*@only@*/</font> uentryList
<a name="l00046"></a><a class="code" href="uentryList_c.html#a1">00046</a> <a class="code" href="uentryList_c.html#a1">uentryList_single</a> (<font class="comment">/*@keep@*/</font> uentry el)<font class="keyword"></font>
00047 <font class="keyword"></font>{
00048   uentryList s = (uentryList) dmalloc (<font class="keyword">sizeof</font> (*s));
00049   
00050   s-&gt;nelements = 1;
00051   s-&gt;nspace = uentryListBASESIZE - 1;
00052   s-&gt;elements = (uentry *) dmalloc (<font class="keyword">sizeof</font> (*s-&gt;elements) * uentryListBASESIZE);
00053   
00054   s-&gt;elements[0] = el;
00055   s-&gt;current = 0;
00056 
00057   <font class="keywordflow">return</font> (s);
00058 }
00059 
00060 <font class="keyword">static</font> <font class="keywordtype">void</font>
00061 uentryList_grow (uentryList s)<font class="keyword"></font>
00062 <font class="keyword"></font>{
00063   <font class="keywordtype">int</font> i;
00064   uentry *newelements;
00065 
00066   llassert (!uentryList_isUndefined (s));
00067 
00068   s-&gt;nspace += uentryListBASESIZE; 
00069   
00070   newelements = (uentry *) dmalloc (<font class="keyword">sizeof</font> (*newelements) 
00071                                     * (s-&gt;nelements + s-&gt;nspace));
00072     
00073   <font class="keywordflow">for</font> (i = 0; i &lt; s-&gt;nelements; i++)
00074     {
00075       newelements[i] = s-&gt;elements[i];
00076     }
00077   
00078   <a class="code" href="general_c.html#a0">sfree</a> (s-&gt;elements);
00079   s-&gt;elements = newelements;
00080 }
00081 
<a name="l00082"></a><a class="code" href="uentryList_c.html#a3">00082</a> <font class="keywordtype">void</font> <a class="code" href="uentryList_c.html#a3">uentryList_clear</a> (uentryList s)<font class="keyword"></font>
00083 <font class="keyword"></font>{
00084   <font class="keywordflow">if</font> (uentryList_isUndefined (s))
00085     {
00086       ;
00087     }
00088   <font class="keywordflow">else</font>
00089     {
00090       s-&gt;nspace += s-&gt;nelements;
00091       s-&gt;nelements = 0;
00092     }
00093 }
00094 
<a name="l00095"></a><a class="code" href="uentryList_c.html#a4">00095</a> uentryList <a class="code" href="uentryList_c.html#a4">uentryList_add</a> (uentryList s, <font class="comment">/*@keep@*/</font> uentry el)<font class="keyword"></font>
00096 <font class="keyword"></font>{
00097   <font class="keywordflow">if</font> (uentryList_isUndefined (s))
00098     {
00099       s = <a class="code" href="uentryList_c.html#a0">uentryList_new</a> ();
00100     }
00101 
00102   <font class="keywordflow">if</font> (s-&gt;nspace &lt;= 0)
00103     uentryList_grow (s);
00104   
00105   s-&gt;nspace--;
00106   s-&gt;elements[s-&gt;nelements] = el;
00107   s-&gt;nelements++;
00108 
00109   <font class="keywordflow">return</font> s;
00110 }
00111 
00112 <font class="comment">/*@only@*/</font> cstring
<a name="l00113"></a><a class="code" href="uentryList_c.html#a5">00113</a>   <a class="code" href="uentryList_c.html#a5">uentryList_unparse</a> (uentryList s)<font class="keyword"></font>
00114 <font class="keyword"></font>{
00115   cstring st = cstring_undefined;
00116   <font class="keywordtype">int</font> i;
00117   
00118   <font class="keywordflow">if</font> (uentryList_isDefined (s))
00119     {
00120       <font class="keywordflow">for</font> (i = 0; i &lt; <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (s); i++)
00121         {
00122           <font class="keywordflow">if</font> (i == 0)
00123             {
00124               st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q;"</font>, uentry_unparse (s-&gt;elements[i]));
00125             }
00126           <font class="keywordflow">else</font>
00127             st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q %q;"</font>, st, uentry_unparse (s-&gt;elements[i]));
00128         }
00129     }
00130   
00131   <font class="keywordflow">return</font> (st);
00132 }
00133 
00134 <font class="comment">/*@unused@*/</font> <font class="comment">/*@only@*/</font> cstring
<a name="l00135"></a><a class="code" href="uentryList_c.html#a6">00135</a>   <a class="code" href="uentryList_c.html#a6">uentryList_unparseFull</a> (uentryList s)<font class="keyword"></font>
00136 <font class="keyword"></font>{
00137   cstring st = cstring_undefined;
00138   <font class="keywordtype">int</font> i;
00139   
00140   <font class="keywordflow">if</font> (uentryList_isDefined (s))
00141     {
00142       <font class="keywordflow">for</font> (i = 0; i &lt; <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (s); i++)
00143         {
00144           <font class="keywordflow">if</font> (i == 0)
00145             {
00146               st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q;"</font>, uentry_unparseFull (s-&gt;elements[i]));
00147             }
00148           <font class="keywordflow">else</font>
00149             {
00150               st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q %q;"</font>, st, uentry_unparseFull (s-&gt;elements[i]));
00151             }
00152         }
00153     }
00154   
00155   <font class="keywordflow">return</font> (st);
00156 }
00157 
<a name="l00158"></a><a class="code" href="uentryList_c.html#a7">00158</a> cstring <a class="code" href="uentryList_c.html#a7">uentryList_unparseParams</a> (uentryList s)<font class="keyword"></font>
00159 <font class="keyword"></font>{
00160   <font class="keywordtype">int</font> i;
00161   cstring st = cstring_undefined;
00162 
00163   
00164   <font class="keywordflow">if</font> (uentryList_isUndefined (s))
00165     {
00166       <font class="keywordflow">return</font> st;
00167     }
00168   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentryList_c.html#a14">uentryList_isVoid</a> (s))
00169     {
00170       <font class="keywordflow">return</font> (cstring_makeLiteral (<font class="stringliteral">"void"</font>));
00171     }
00172   <font class="keywordflow">else</font>
00173     {
00174       <font class="keywordflow">for</font> (i = 0; i &lt; <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (s); i++)
00175         {
00176           <font class="keywordflow">if</font> (i == 0)
00177             {
00178               st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%s"</font>, ctype_unparse (uentry_getType (s-&gt;elements[i])));
00179             }
00180           <font class="keywordflow">else</font>
00181             {
00182               st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q, %s"</font>, st, ctype_unparse (uentry_getType (s-&gt;elements[i])));
00183             }
00184         }
00185       
00186       <font class="keywordflow">return</font> st;
00187     }
00188 }
00189 
<a name="l00190"></a><a class="code" href="uentryList_c.html#a8">00190</a> <font class="keywordtype">bool</font> <a class="code" href="uentryList_c.html#a8">uentryList_matchParams</a> (uentryList p1, uentryList p2, <font class="keywordtype">bool</font> force, <font class="keywordtype">bool</font> arg)<font class="keyword"></font>
00191 <font class="keyword"></font>{
00192   <font class="keywordtype">int</font> sz1 = <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (p1);
00193   <font class="keywordtype">int</font> sz2 = <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (p2);
00194   <font class="keywordtype">int</font> i;
00195   
00196   <font class="keywordflow">if</font> (p1 == p2) <font class="keywordflow">return</font> TRUE;
00197 
00198   <font class="keywordflow">if</font> (<a class="code" href="uentryList_c.html#a30">uentryList_isMissingParams</a> (p1) || <a class="code" href="uentryList_c.html#a30">uentryList_isMissingParams</a> (p2))
00199     {
00200       <font class="keywordflow">return</font> TRUE;
00201     }
00202 
00203   <font class="keywordflow">if</font> (sz1 != sz2)
00204     <font class="keywordflow">return</font> FALSE;
00205 
00206   <font class="keywordflow">for</font> (i = 0; i &lt; sz1; i++)
00207     {
00208       <font class="keywordflow">if</font> (!<a class="code" href="ctype_c.html#a92">ctype_genMatch</a> (uentry_getType (p1-&gt;elements[i]), 
00209                            <a class="code" href="uentry_c.html#a197">uentry_getType</a> (p2-&gt;elements[i]), 
00210                            force, arg, FALSE, FALSE))
00211         {
00212           <font class="keywordflow">return</font> FALSE;
00213         }
00214     }
00215 
00216   <font class="keywordflow">return</font> TRUE;
00217 }
00218 
00219 <font class="comment">/*@only@*/</font> cstring
<a name="l00220"></a><a class="code" href="uentryList_c.html#a9">00220</a> <a class="code" href="uentryList_c.html#a9">uentryList_unparseAbbrev</a> (uentryList p)<font class="keyword"></font>
00221 <font class="keyword"></font>{
00222   <font class="keywordtype">bool</font> first = TRUE;
00223   cstring s = cstring_undefined;
00224   <font class="keywordtype">int</font> i = 0;
00225   
00226   <font class="keywordflow">if</font> (uentryList_isUndefined (p))
00227     <font class="keywordflow">return</font> s;
00228 
00229   <font class="keywordflow">if</font> (<a class="code" href="uentryList_c.html#a29">uentryList_size</a> (p) == 0)
00230     <font class="keywordflow">return</font> cstring_makeLiteral (<font class="stringliteral">"void"</font>);
00231 
00232   <font class="keywordflow">for</font> (i = 0; i &lt; p-&gt;nelements &amp;&amp; i &lt; PRINTBREADTH; i++)
00233     {
00234       <font class="keywordflow">if</font> (first)
00235         {
00236           s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q;"</font>, uentry_unparseAbbrev (p-&gt;elements[i]));
00237           first = FALSE;
00238         }
00239       <font class="keywordflow">else</font>
00240         {
00241           s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q %q;"</font>, s, uentry_unparseAbbrev (p-&gt;elements[i]));
00242         }
00243     }
00244   
00245   <font class="keywordflow">if</font> (i != <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (p))
00246     s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q, ..."</font>, s);
00247   
00248   <font class="keywordflow">return</font> (s);
00249 }
00250 
00251 <font class="keyword">static</font> <font class="keywordtype">int</font>
00252 uentryList_lookupDirectName (uentryList s, cstring name)<font class="keyword"></font>
00253 <font class="keyword"></font>{
00254   <font class="keywordflow">if</font> (uentryList_isDefined (s))
00255     {
00256       <font class="keywordtype">int</font> i;
00257       
00258       <font class="keywordflow">for</font> (i = 0; i &lt; <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (s); i++)
00259         {
00260           <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a18">cstring_equal</a> (name, uentry_rawName (s-&gt;elements[i])))
00261             {
00262               <font class="keywordflow">return</font> i;
00263             }
00264         }
00265     }
00266 
00267    <font class="keywordflow">return</font> -1;
00268 }
00269 
00270 <font class="keywordtype">int</font>
<a name="l00271"></a><a class="code" href="uentryList_c.html#a11">00271</a> <a class="code" href="uentryList_c.html#a11">uentryList_lookupRealName</a> (uentryList s, cstring name)<font class="keyword"></font>
00272 <font class="keyword"></font>{
00273   <font class="keywordflow">if</font> (uentryList_isDefined (s))
00274     {
00275       <font class="keywordtype">int</font> i;
00276       
00277       <font class="keywordflow">for</font> (i = 0; i &lt; <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (s); i++)
00278         {
00279           cstring uname = <a class="code" href="uentry_c.html#a195">uentry_getName</a> (s-&gt;elements[i]);
00280 
00281           <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a18">cstring_equal</a> (name, uname))
00282             {
00283               <a class="code" href="cstring_c.html#a27">cstring_free</a> (uname);
00284               <font class="keywordflow">return</font> i;
00285             }      
00286 
00287           <a class="code" href="cstring_c.html#a27">cstring_free</a> (uname);
00288         }
00289     }
00290 
00291    <font class="keywordflow">return</font> -1;
00292 }
00293 
<a name="l00294"></a><a class="code" href="uentryList_c.html#a12">00294</a> uentryList <a class="code" href="uentryList_c.html#a12">uentryList_copy</a> (uentryList s)<font class="keyword"></font>
00295 <font class="keyword"></font>{
00296   
00297   <font class="keywordflow">if</font> (uentryList_isDefined (s))
00298     {
00299       uentryList t = (uentryList) dmalloc (<font class="keyword">sizeof</font> (*t));
00300       <font class="keywordtype">int</font> i;
00301       
00302       t-&gt;nelements = s-&gt;nelements;
00303       t-&gt;nspace = 0;
00304       t-&gt;current = s-&gt;current;
00305       
00306       <font class="keywordflow">if</font> (s-&gt;nelements &gt; 0)
00307         {
00308           t-&gt;elements = (uentry *) dmalloc (<font class="keyword">sizeof</font> (*t-&gt;elements) * t-&gt;nelements);
00309           
00310           <font class="keywordflow">for</font> (i = 0; i &lt; s-&gt;nelements; i++) 
00311             {
00312                       t-&gt;elements[i] = <a class="code" href="uentry_c.html#a270">uentry_copy</a> (s-&gt;elements[i]); 
00313                     }
00314         }
00315       <font class="keywordflow">else</font>
00316         {
00317           t-&gt;elements = NULL;
00318         }
00319 
00320       <font class="keywordflow">return</font> t;
00321     }
00322   <font class="keywordflow">else</font>
00323     {
00324       <font class="keywordflow">return</font> uentryList_undefined;
00325     }
00326 }
00327 
00328 <font class="keywordtype">void</font>
<a name="l00329"></a><a class="code" href="uentryList_c.html#a13">00329</a> <a class="code" href="uentryList_c.html#a13">uentryList_free</a> (uentryList s)<font class="keyword"></font>
00330 <font class="keyword"></font>{
00331   
00332   <font class="keywordflow">if</font> (!uentryList_isUndefined (s)) 
00333     {
00334       <font class="keywordtype">int</font> i;
00335 
00336       <font class="keywordflow">for</font> (i = 0; i &lt; s-&gt;nelements; i++)
00337         {
00338           <a class="code" href="uentry_c.html#a238">uentry_free</a> (s-&gt;elements[i]);  
00339         }
00340 
00341       <a class="code" href="general_c.html#a0">sfree</a> (s-&gt;elements);
00342       <a class="code" href="general_c.html#a0">sfree</a> (s);
00343     }
00344 }
00345 
00346 <font class="keywordtype">bool</font>
<a name="l00347"></a><a class="code" href="uentryList_c.html#a14">00347</a> <a class="code" href="uentryList_c.html#a14">uentryList_isVoid</a> (uentryList cl)<font class="keyword"></font>
00348 <font class="keyword"></font>{
00349   <font class="keywordflow">if</font> (cl != NULL &amp;&amp; cl-&gt;nelements == 1)
00350     {
00351       <font class="keywordflow">return</font> (<a class="code" href="ctype_c.html#a51">ctype_isVoid</a> (uentry_getType (cl-&gt;elements[0])));
00352     }
00353   <font class="keywordflow">return</font> FALSE;
00354 }
00355 
00356 <font class="comment">/*@exposed@*/</font> uentry
<a name="l00357"></a><a class="code" href="uentryList_c.html#a15">00357</a> <a class="code" href="uentryList_c.html#a15">uentryList_getN</a> (uentryList p, <font class="keywordtype">int</font> n)<font class="keyword"></font>
00358 <font class="keyword"></font>{
00359   llassert (uentryList_isDefined (p));
00360 
00361   <font class="keywordflow">if</font> (n &lt; 0 || (n &gt;= <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (p)))
00362     {
00363       llcontbug (message (<font class="stringliteral">"uentryList_getN: out of range: %d (size %d)"</font>,
00364                           n, uentryList_size (p)));
00365       <font class="keywordflow">return</font> uentry_undefined;
00366     }
00367 
00368   <font class="keywordflow">return</font> (p-&gt;elements[n]);
00369 }
00370 
<a name="l00371"></a><a class="code" href="uentryList_c.html#a16">00371</a> <font class="keywordtype">void</font> <a class="code" href="uentryList_c.html#a16">uentryList_fixMissingNames</a> (uentryList cl)<font class="keyword"></font>
00372 <font class="keyword"></font>{
00373   uentryList_elements (cl, ce)<font class="keyword"></font>
00374 <font class="keyword">    </font>{
00375       <font class="keywordflow">if</font> (!<a class="code" href="uentry_c.html#a188">uentry_hasRealName</a> (ce))
00376         {
00377           ctype ct = <a class="code" href="uentry_c.html#a197">uentry_getType</a> (ce);
00378 
00379           <font class="keywordflow">if</font> (<a class="code" href="ctype_c.html#a31">ctype_isUA</a> (ct))
00380             {
00381               <a class="code" href="uentry_c.html#a215">uentry_setName</a> (ce, usymtab_getTypeEntryName (ctype_typeId (ct)));
00382             }
00383           <font class="keywordflow">else</font>
00384             {
00385               llbug (message (<font class="stringliteral">"uentryList_fixMissingNames: not UA: %s"</font>, 
00386                               ctype_unparse (ct)));
00387             }
00388 
00389           <a class="code" href="uentry_c.html#a216">uentry_setType</a> (ce, ctype_int);
00390         }
00391     } end_uentryList_elements;
00392 }
00393 
<a name="l00394"></a><a class="code" href="uentryList_c.html#a17">00394</a> <font class="keywordtype">void</font> <a class="code" href="uentryList_c.html#a17">uentryList_fixImpParams</a> (uentryList cl)<font class="keyword"></font>
00395 <font class="keyword"></font>{
00396   
00397   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_PARAMIMPTEMP))
00398     {
00399       uentryList_elements (cl, ce)<font class="keyword"></font>
00400 <font class="keyword">        </font>{
00401           sRef s = <a class="code" href="uentry_c.html#a213">uentry_getSref</a> (ce);
00402           alkind ak = sRef_getAliasKind (s);
00403 
00404           <font class="keywordflow">if</font> (alkind_isUnknown (ak) || alkind_isImplicit (ak))
00405             {
00406               exkind ek = <a class="code" href="sRef_c.html#a188">sRef_getExKind</a> (s);
00407 
00408               <font class="keywordflow">if</font> (exkind_isKnown (ek))
00409                 {
00410                   <a class="code" href="sRef_c.html#a186">sRef_setAliasKind</a> (s, AK_IMPDEPENDENT, fileloc_undefined);
00411                 }
00412               <font class="keywordflow">else</font>
00413                 {
00414                   <a class="code" href="sRef_c.html#a186">sRef_setAliasKind</a> (s, AK_IMPTEMP, fileloc_undefined);
00415                 }
00416                     }
00417           <font class="keywordflow">else</font>
00418             {
00419                     }
00420         } end_uentryList_elements;
00421     }
00422 }
00423 
00424 <font class="keywordtype">int</font>
<a name="l00425"></a><a class="code" href="uentryList_c.html#a18">00425</a> <a class="code" href="uentryList_c.html#a18">uentryList_compareParams</a> (uentryList s, uentryList t)<font class="keyword"></font>
00426 <font class="keyword"></font>{
00427   <font class="keywordtype">int</font> i, sz;
00428 
00429   <font class="keywordflow">if</font> (s == t) <font class="keywordflow">return</font> 0;
00430 
00431   <font class="keywordflow">if</font> (uentryList_isUndefined (s)) <font class="keywordflow">return</font> 1;
00432   <font class="keywordflow">if</font> (uentryList_isUndefined (t)) <font class="keywordflow">return</font> -1;
00433   
00434   sz = <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (s);
00435   
00436   INTCOMPARERETURN (uentryList_size (t), sz);
00437   
00438   <font class="keywordflow">for</font> (i = 0; i &lt; sz; i++)
00439     {
00440       COMPARERETURN (uentry_compare (s-&gt;elements[i], t-&gt;elements[i]));
00441     }
00442   
00443   <font class="keywordflow">return</font> 0;
00444 }
00445 
00446 <font class="keywordtype">int</font>
<a name="l00447"></a><a class="code" href="uentryList_c.html#a19">00447</a> <a class="code" href="uentryList_c.html#a19">uentryList_compareStrict</a> (uentryList s, uentryList t)<font class="keyword"></font>
00448 <font class="keyword"></font>{
00449   <font class="keywordtype">int</font> i, sz;
00450 
00451   <font class="keywordflow">if</font> (s == t) 
00452     {
00453       <font class="keywordflow">return</font> 0;
00454     }
00455   
00456   <font class="keywordflow">if</font> (<a class="code" href="uentryList_c.html#a30">uentryList_isMissingParams</a> (s))
00457     {
00458       <font class="keywordflow">if</font> (<a class="code" href="uentryList_c.html#a30">uentryList_isMissingParams</a> (t))
00459         {
00460           <font class="keywordflow">return</font> 0;
00461         }
00462       <font class="keywordflow">else</font>
00463         {
00464           <font class="keywordflow">return</font> 1;
00465         }
00466     }
00467   <font class="keywordflow">else</font> 
00468     {
00469       <font class="keywordflow">if</font> (<a class="code" href="uentryList_c.html#a30">uentryList_isMissingParams</a> (t))
00470         {
00471           <font class="keywordflow">return</font> -1;
00472         }
00473       <font class="keywordflow">else</font>
00474         {
00475           sz = <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (s);
00476           
00477           INTCOMPARERETURN (uentryList_size (t), sz);
00478           
00479           <font class="keywordflow">for</font> (i = 0; i &lt; sz; i++)
00480             {
00481               COMPARERETURN (uentry_compareStrict (s-&gt;elements[i], t-&gt;elements[i]));
00482             }
00483           
00484           <font class="keywordflow">return</font> 0;
00485         }
00486     }
00487 }
00488 
00489 <font class="keywordtype">int</font>
<a name="l00490"></a><a class="code" href="uentryList_c.html#a20">00490</a> <a class="code" href="uentryList_c.html#a20">uentryList_compareFields</a> (uentryList s, uentryList t)<font class="keyword"></font>
00491 <font class="keyword"></font>{
00492   <font class="keywordtype">int</font> i, sz;
00493 
00494   <font class="keywordflow">if</font> (s == t) <font class="keywordflow">return</font> 0;
00495 
00496   <font class="keywordflow">if</font> (uentryList_isUndefined (s))
00497     <font class="keywordflow">return</font> 1;
00498   <font class="keywordflow">if</font> (uentryList_isUndefined (t))
00499     <font class="keywordflow">return</font> -1;
00500   
00501   sz = <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (s);
00502   
00503   <font class="keywordflow">if</font> (<a class="code" href="uentryList_c.html#a29">uentryList_size</a> (t) != sz)
00504     {
00505       <font class="keywordflow">return</font> (int_compare (sz, uentryList_size (t)));
00506     }
00507   
00508   <font class="keywordflow">for</font> (i = 0; i &lt; sz; i++)
00509     {
00510       uentry se = s-&gt;elements[i];
00511       uentry te = t-&gt;elements[i];
00512       <font class="keywordtype">int</font> namecmp = <a class="code" href="cstring_c.html#a25">cstring_compare</a> (uentry_rawName (se), <a class="code" href="uentry_c.html#a194">uentry_rawName</a> (te));
00513 
00514       <font class="keywordflow">if</font> (namecmp == 0)
00515         {
00516           <font class="keywordtype">int</font> uc = <a class="code" href="uentry_c.html#a135">uentry_compare</a> (s-&gt;elements[i], t-&gt;elements[i]);
00517           
00518           <font class="keywordflow">if</font> (uc != 0) 
00519             { 
00520               <font class="keywordflow">return</font> uc; 
00521             }
00522         }
00523       <font class="keywordflow">else</font>
00524         {
00525           <font class="keywordflow">return</font> (namecmp);
00526         }
00527     }
00528 
00529   <font class="keywordflow">return</font> 0;
00530 }
00531 
00532 <font class="comment">/*@exposed@*/</font> uentry 
<a name="l00533"></a><a class="code" href="uentryList_c.html#a21">00533</a> <a class="code" href="uentryList_c.html#a21">uentryList_current</a> (uentryList s)<font class="keyword"></font>
00534 <font class="keyword"></font>{
00535   llassert (uentryList_isDefined (s));
00536   llassert (!(s-&gt;current &lt; 0 || (s-&gt;current &gt;= s-&gt;nelements)));
00537   <font class="keywordflow">return</font> (s-&gt;elements[s-&gt;current]);
00538 }
00539 
00540 cstring
<a name="l00541"></a><a class="code" href="uentryList_c.html#a22">00541</a> <a class="code" href="uentryList_c.html#a22">uentryList_dumpParams</a> (uentryList s)<font class="keyword"></font>
00542 <font class="keyword"></font>{
00543   cstring st = cstring_undefined;
00544 
00545   <font class="keywordflow">if</font> (uentryList_isUndefined (s)) <font class="keywordflow">return</font> st;
00546   
00547   uentryList_elements (s, current)<font class="keyword"></font>
00548 <font class="keyword">    </font>{
00549       st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q%q,"</font>, st, uentry_dumpParam (current));
00550   } end_uentryList_elements;
00551 
00552   <font class="keywordflow">return</font> st;
00553 }
00554 
00555 <font class="comment">/*@only@*/</font> cstring
<a name="l00556"></a><a class="code" href="uentryList_c.html#a23">00556</a> <a class="code" href="uentryList_c.html#a23">uentryList_dumpFields</a> (uentryList s)<font class="keyword"></font>
00557 <font class="keyword"></font>{
00558   cstring st = cstring_undefined;
00559 
00560   <font class="keywordflow">if</font> (uentryList_isUndefined (s)) <font class="keywordflow">return</font> st;
00561 
00562   uentryList_elements (s, current)<font class="keyword"></font>
00563 <font class="keyword">  </font>{
00564     <font class="keywordflow">if</font> (!<a class="code" href="uentry_c.html#a159">uentry_isVariable</a> (current))
00565       {
00566         llassert (uentry_isFunction (current));
00567         st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q!%q,"</font>, st, uentry_dump (current));
00568       }
00569     <font class="keywordflow">else</font>
00570       {
00571         st = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q%q,"</font>, st, uentry_dump (current));
00572       }
00573   } end_uentryList_elements;
00574   
00575   <font class="keywordflow">return</font> st;
00576 }
00577 
00578 <font class="comment">/*@only@*/</font> uentryList 
<a name="l00579"></a><a class="code" href="uentryList_c.html#a24">00579</a> <a class="code" href="uentryList_c.html#a24">uentryList_undumpFields</a> (<font class="keywordtype">char</font> **s, fileloc loc)<font class="keyword"></font>
00580 <font class="keyword"></font>{
00581   uentryList ul = <a class="code" href="uentryList_c.html#a0">uentryList_new</a> ();
00582 
00583   <font class="keywordflow">while</font> (**s != <font class="charliteral">'\0'</font> &amp;&amp; **s != <font class="charliteral">'}'</font>) 
00584     {
00585       <font class="keywordflow">if</font> (**s == <font class="charliteral">'!'</font>)
00586         {
00587           checkChar (s, <font class="charliteral">'!'</font>);
00588           ul = <a class="code" href="uentryList_c.html#a4">uentryList_add</a> (ul, uentry_undump (ekind_function, loc, s));
00589         }
00590       <font class="keywordflow">else</font>
00591         {
00592           ul = <a class="code" href="uentryList_c.html#a4">uentryList_add</a> (ul, uentry_undump (ekind_variable, loc, s));
00593         }
00594       checkChar (s, <font class="charliteral">','</font>);
00595     }
00596 
00597   checkChar (s, <font class="charliteral">'}'</font>);
00598   <font class="keywordflow">return</font> ul;
00599 }
00600 
00601 <font class="comment">/*@only@*/</font> uentryList
<a name="l00602"></a><a class="code" href="uentryList_c.html#a25">00602</a> <a class="code" href="uentryList_c.html#a25">uentryList_undump</a> (<font class="keywordtype">char</font> **s)<font class="keyword"></font>
00603 <font class="keyword"></font>{
00604   <font class="keywordtype">char</font> c;
00605   uentryList pn = <a class="code" href="uentryList_c.html#a0">uentryList_new</a> ();
00606   <font class="keywordtype">int</font> paramno = 0;
00607 
00608   c = **s;
00609 
00610   <font class="keywordflow">while</font> (c != <font class="charliteral">'#'</font> &amp;&amp; c != <font class="charliteral">'@'</font> &amp;&amp; c != <font class="charliteral">')'</font>)
00611     {
00612       uentry ue = <a class="code" href="uentry_c.html#a151">uentry_undump</a> (ekind_variable, g_currentloc, s);
00613       
00614       
00615       <font class="keywordflow">if</font> (!uentry_isUndefined (ue))
00616         {
00617           pn = <a class="code" href="uentryList_c.html#a4">uentryList_add</a> (pn, ue);
00618         }
00619       <font class="keywordflow">else</font>
00620         {
00621           <a class="code" href="uentry_c.html#a238">uentry_free</a> (ue);
00622         }
00623 
00624       checkChar (s, <font class="charliteral">','</font>);
00625       c = **s;
00626       paramno++;
00627     }
00628 
00629   checkChar (s, <font class="charliteral">')'</font>);
00630   <font class="keywordflow">return</font> pn;
00631 }
00632 
00633 <font class="keywordtype">void</font> 
<a name="l00634"></a><a class="code" href="uentryList_c.html#a26">00634</a> <a class="code" href="uentryList_c.html#a26">uentryList_reset</a> (uentryList s)<font class="keyword"></font>
00635 <font class="keyword"></font>{
00636   <font class="keywordflow">if</font> (uentryList_isUndefined (s)) <font class="keywordflow">return</font>;
00637   s-&gt;current = 0;
00638 }
00639 
00640 <font class="keywordtype">bool</font>
<a name="l00641"></a><a class="code" href="uentryList_c.html#a27">00641</a> <a class="code" href="uentryList_c.html#a27">uentryList_isFinished</a> (uentryList s)<font class="keyword"></font>
00642 <font class="keyword"></font>{
00643   <font class="keywordflow">if</font> (uentryList_isUndefined (s)) <font class="keywordflow">return</font> TRUE;
00644   <font class="keywordflow">return</font> (s-&gt;current &gt; s-&gt;nelements - 1);
00645 }
00646 
00647 <font class="keywordtype">void</font> 
<a name="l00648"></a><a class="code" href="uentryList_c.html#a28">00648</a> <a class="code" href="uentryList_c.html#a28">uentryList_advanceSafe</a> (uentryList s)<font class="keyword"></font>
00649 <font class="keyword"></font>{
00650   <font class="keywordflow">if</font> (uentryList_isUndefined (s)) <font class="keywordflow">return</font>;
00651 
00652   s-&gt;current++;
00653 
00654   <font class="keywordflow">if</font> (s-&gt;current &gt; s-&gt;nelements)
00655     {
00656       s-&gt;current = s-&gt;nelements;
00657     }
00658 }
00659 
00660 <font class="keywordtype">int</font>
<a name="l00661"></a><a class="code" href="uentryList_c.html#a29">00661</a> <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (uentryList s)<font class="keyword"></font>
00662 <font class="keyword"></font>{
00663   <font class="keywordflow">if</font> (uentryList_isUndefined (s)) <font class="keywordflow">return</font> 0;
00664 
00665   <font class="keywordflow">if</font> (s-&gt;nelements == 1 &amp;&amp; <a class="code" href="ctype_c.html#a51">ctype_isVoid</a> (uentry_getType (s-&gt;elements[0])))
00666     <font class="keywordflow">return</font> 0;
00667   
00668   <font class="keywordflow">return</font> s-&gt;nelements;
00669 }
00670 
00671 <font class="keywordtype">bool</font>
<a name="l00672"></a><a class="code" href="uentryList_c.html#a30">00672</a> <a class="code" href="uentryList_c.html#a30">uentryList_isMissingParams</a> (uentryList s)<font class="keyword"></font>
00673 <font class="keyword"></font>{
00674   <font class="keywordflow">return</font> (uentryList_isUndefined (s) || s-&gt;nelements == 0);
00675 }
00676 
<a name="l00677"></a><a class="code" href="uentryList_c.html#a31">00677</a> <font class="keywordtype">bool</font> <a class="code" href="uentryList_c.html#a31">uentryList_hasReturned</a> (uentryList ul)<font class="keyword"></font>
00678 <font class="keyword"></font>{
00679   uentryList_elements (ul, current)<font class="keyword"></font>
00680 <font class="keyword">    </font>{
00681       <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a279">uentry_isReturned</a> (current)) <font class="keywordflow">return</font> TRUE;
00682     } end_uentryList_elements;
00683 
00684   <font class="keywordflow">return</font> FALSE;
00685 }
00686 
00687 <font class="comment">/*@exposed@*/</font> uentry 
<a name="l00688"></a><a class="code" href="uentryList_c.html#a32">00688</a> <a class="code" href="uentryList_c.html#a32">uentryList_lookupField</a> (uentryList f, cstring name)<font class="keyword"></font>
00689 <font class="keyword"></font>{
00690   <font class="keywordtype">int</font> i = uentryList_lookupDirectName (f, name);
00691 
00692   <font class="keywordflow">if</font> (i &gt;= 0)
00693     {
00694       <font class="keywordflow">return</font> (<a class="code" href="uentryList_c.html#a15">uentryList_getN</a> (f, i));
00695     }
00696   <font class="keywordflow">else</font>
00697     {
00698       <font class="keywordflow">return</font> uentry_undefined;
00699     }
00700 }
00701 
00702 <font class="comment">/*@only@*/</font> uentryList
<a name="l00703"></a><a class="code" href="uentryList_c.html#a33">00703</a>   <a class="code" href="uentryList_c.html#a33">uentryList_mergeFields</a> (<font class="comment">/*@only@*/</font> uentryList f1, <font class="comment">/*@only@*/</font> uentryList f2)<font class="keyword"></font>
00704 <font class="keyword"></font>{
00705   <font class="keywordflow">if</font> (uentryList_isUndefined (f1))
00706     {
00707       <font class="keywordflow">return</font>  (f2);
00708     }
00709 
00710   <font class="keywordflow">if</font> (uentryList_isDefined (f2))
00711     {
00712       uentryList_elements (f2, current)<font class="keyword"></font>
00713 <font class="keyword">        </font>{
00714           uentry old = <a class="code" href="uentryList_c.html#a32">uentryList_lookupField</a> (f1, uentry_rawName (current));
00715           
00716           <font class="keywordflow">if</font> (uentry_isValid (old))
00717             {
00718               voptgenerror
00719                 (FLG_SYNTAX,
00720                  <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Field name reused: %s"</font>, uentry_rawName (current)),
00721                  <a class="code" href="uentry_c.html#a201">uentry_whereDefined</a> (current));
00722               <a class="code" href="llerror_c.html#a33">llgenmsg</a> (message (<font class="stringliteral">"Previous use of %s"</font>, uentry_rawName (current)),
00723                         <a class="code" href="uentry_c.html#a201">uentry_whereDefined</a> (old));
00724             }
00725           
00726           <font class="comment">/* okay to use exposed current since f2 is killed */</font>
00727           <font class="comment">/*@-exposetrans@*/</font> <font class="comment">/*@-dependenttrans@*/</font>
00728           f1 = <a class="code" href="uentryList_c.html#a4">uentryList_add</a> (f1, current); 
00729           <font class="comment">/*@=exposetrans@*/</font> <font class="comment">/*@=dependenttrans@*/</font>
00730 
00731         } end_uentryList_elements;
00732       
00733       <a class="code" href="general_c.html#a0">sfree</a> (f2-&gt;elements);
00734       <a class="code" href="general_c.html#a0">sfree</a> (f2);
00735     }
00736 
00737   <font class="keywordflow">return</font> (f1);
00738 }
00739 
00740 <font class="keywordtype">void</font>
<a name="l00741"></a><a class="code" href="uentryList_c.html#a34">00741</a> <a class="code" href="uentryList_c.html#a34">uentryList_showFieldDifference</a> (uentryList p1, uentryList p2)<font class="keyword"></font>
00742 <font class="keyword"></font>{
00743   uentry cp1, cp2;
00744   <font class="keywordtype">int</font> index;
00745 
00746   llassert (NOALIAS (p1, p2));
00747   llassert (uentryList_isDefined (p1));
00748   llassert (uentryList_isDefined (p2));
00749   
00750   <font class="keywordflow">for</font> (index = 0; index &lt; p1-&gt;nelements; index++)
00751     {
00752       cp1 = p1-&gt;elements[index];
00753 
00754       <font class="keywordflow">if</font> (index == p2-&gt;nelements)
00755         {
00756           llgenindentmsg
00757             (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Field present in %s, missing in %rdeclaration: %q"</font>, 
00758                       uentry_specDeclName (cp1),
00759                       <a class="code" href="uentry_c.html#a212">uentry_isDeclared</a> (cp1),
00760                       <a class="code" href="uentry_c.html#a155">uentry_unparse</a> (cp1)),
00761              <a class="code" href="uentry_c.html#a199">uentry_whereEither</a> (cp1));
00762           <font class="keywordflow">return</font>;
00763         }
00764           
00765       cp2 = p2-&gt;elements[index];
00766 
00767       <font class="keywordflow">if</font> (!(<a class="code" href="cstring_c.html#a18">cstring_equal</a> (uentry_rawName (cp1), <a class="code" href="uentry_c.html#a194">uentry_rawName</a> (cp2))))
00768         {
00769           llgenindentmsg 
00770             (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Field %s in %s corresponds to %s in %rdeclaration"</font>, 
00771                       uentry_rawName (cp1),
00772                       <a class="code" href="uentry_c.html#a36">uentry_specOrDefName</a> (cp1),
00773                       <a class="code" href="uentry_c.html#a194">uentry_rawName</a> (cp2),
00774                       <a class="code" href="uentry_c.html#a211">uentry_isCodeDefined</a> (cp1)),
00775              <a class="code" href="uentry_c.html#a201">uentry_whereDefined</a> (cp2));
00776           <a class="code" href="uentry_c.html#a247">uentry_showWhereLastPlain</a> (cp1);
00777           <font class="keywordflow">return</font>;
00778         }
00779       <font class="keywordflow">else</font> 
00780         {
00781           <font class="comment">/* evs 2000-07-25 was ctype_match, should match uentryList_matchFields */</font>
00782           <font class="keywordflow">if</font> (!<a class="code" href="ctype_c.html#a94">ctype_almostEqual</a> (uentry_getType (cp1), <a class="code" href="uentry_c.html#a197">uentry_getType</a> (cp2)))
00783             {
00784               llgenindentmsg 
00785                 (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Field %s %rdeclared as %s, %s as %s"</font>,
00786                           uentry_rawName (cp2),
00787                           <a class="code" href="uentry_c.html#a211">uentry_isCodeDefined</a> (cp1),
00788                           <a class="code" href="ctype_c.html#a107">ctype_unparse</a> (uentry_getType (cp1)),
00789                           <a class="code" href="uentry_c.html#a36">uentry_specOrDefName</a> (cp2),
00790                           <a class="code" href="ctype_c.html#a107">ctype_unparse</a> (uentry_getType (cp2))),
00791                  <a class="code" href="uentry_c.html#a201">uentry_whereDefined</a> (cp2));
00792               <a class="code" href="uentry_c.html#a247">uentry_showWhereLastPlain</a> (cp1);
00793               <font class="keywordflow">return</font>;
00794             }
00795         }
00796     }
00797 
00798   <font class="keywordflow">if</font> (index != p2-&gt;nelements)
00799     {
00800       cp2 = p2-&gt;elements[index];
00801 
00802       llgenindentmsg 
00803         (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Extra field in new declaration: %q"</font>,
00804                   uentry_unparse (cp2)),
00805          <a class="code" href="uentry_c.html#a199">uentry_whereEither</a> (cp2));
00806 
00807       <font class="keywordflow">return</font>;
00808     }
00809 
00810   llbug (message (<font class="stringliteral">"uentryList_showFieldDifference: match: %q / %q"</font>,
00811                   uentryList_unparse (p1), <a class="code" href="uentryList_c.html#a5">uentryList_unparse</a> (p2)));
00812 }
00813 
00814 <font class="keywordtype">bool</font>
<a name="l00815"></a><a class="code" href="uentryList_c.html#a35">00815</a> <a class="code" href="uentryList_c.html#a35">uentryList_matchFields</a> (uentryList p1, uentryList p2)<font class="keyword"></font>
00816 <font class="keyword"></font>{
00817   <font class="keywordtype">int</font> index;
00818   uentry cp1, cp2;
00819 
00820   <font class="keywordflow">if</font> (p1 == p2) 
00821     {
00822       <font class="keywordflow">return</font> (TRUE);
00823     }
00824 
00825   <font class="keywordflow">if</font> (uentryList_isEmpty (p1) || uentryList_isEmpty (p2))
00826     {
00827       <font class="keywordflow">return</font> (TRUE);
00828     }
00829 
00830   <font class="keywordflow">if</font> (<a class="code" href="uentryList_c.html#a29">uentryList_size</a> (p1) != <a class="code" href="uentryList_c.html#a29">uentryList_size</a> (p2))
00831     {
00832       <font class="keywordflow">return</font> FALSE;
00833     }
00834 
00835   <font class="keywordflow">for</font> (index = 0; index &lt; p1-&gt;nelements; index++)
00836     {
00837       cp1 = p1-&gt;elements[index];
00838       cp2 = p2-&gt;elements[index];
00839 
00840       <font class="keywordflow">if</font> (!(<a class="code" href="cstring_c.html#a18">cstring_equal</a> (uentry_rawName (cp1), <a class="code" href="uentry_c.html#a194">uentry_rawName</a> (cp2))
00841             &amp;&amp; (<a class="code" href="ctype_c.html#a94">ctype_almostEqual</a> (uentry_getType (cp1), <a class="code" href="uentry_c.html#a197">uentry_getType</a> (cp2)))))
00842         {     <font class="comment">/* was ctype_match! */</font>
00843           <font class="keywordflow">return</font> FALSE;
00844         }
00845     }
00846 
00847   <font class="keywordflow">return</font> TRUE;
00848 }
00849 
</div></pre><hr><address><small>Generated at Fri Nov 3 18:57:45 2000 for LCLint by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.3 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
