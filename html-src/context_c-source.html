<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>context.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.3 on Fri Nov 3 18:57:39 2000 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>context.c</h1><a href="context_c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">** LCLint - annotation-assisted static program checker</font>
00003 <font class="comment">** Copyright (C) 1994-2000 University of Virginia,</font>
00004 <font class="comment">**         Massachusetts Institute of Technology</font>
00005 <font class="comment">**</font>
00006 <font class="comment">** This program is free software; you can redistribute it and/or modify it</font>
00007 <font class="comment">** under the terms of the GNU General Public License as published by the</font>
00008 <font class="comment">** Free Software Foundation; either version 2 of the License, or (at your</font>
00009 <font class="comment">** option) any later version.</font>
00010 <font class="comment">** </font>
00011 <font class="comment">** This program is distributed in the hope that it will be useful, but</font>
00012 <font class="comment">** WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00014 <font class="comment">** General Public License for more details.</font>
00015 <font class="comment">** </font>
00016 <font class="comment">** The GNU General Public License is available from http://www.gnu.org/ or</font>
00017 <font class="comment">** the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston,</font>
00018 <font class="comment">** MA 02111-1307, USA.</font>
00019 <font class="comment">**</font>
00020 <font class="comment">** For information on lclint: lclint-request@cs.virginia.edu</font>
00021 <font class="comment">** To report a bug: lclint-bug@cs.virginia.edu</font>
00022 <font class="comment">** For more information: http://lclint.cs.virginia.edu</font>
00023 <font class="comment">*/</font>
00024 <font class="comment">/*</font>
00025 <font class="comment">** context.c</font>
00026 <font class="comment">*/</font>
00027 <font class="comment">/*</font>
00028 <font class="comment"> * Modified by Herbert 04/19/97:</font>
00029 <font class="comment"> * - added include for new header portab.h containing OS dependent stuff.</font>
00030 <font class="comment"> * - changed occurrances of '/' as path delimiters to macro from portab.h</font>
00031 <font class="comment"> * - changed the handling of the tmp directory -- will no longer always be</font>
00032 <font class="comment"> *   ".", if possible, environment variables "TMP" or, if not set, "TMP", </font>
00033 <font class="comment"> *   or, if not set "." will be used.</font>
00034 <font class="comment"> */</font>
00035 
00036 <font class="preprocessor"># include "lclintMacros.nf"</font>
00037 <font class="preprocessor"># include "llbasic.h"</font>
00038 
00039 <font class="preprocessor"># ifndef NOLCL</font>
00040 <font class="preprocessor"></font><font class="preprocessor"># include "usymtab_interface.h"</font>
00041 <font class="preprocessor"># endif</font>
00042 <font class="preprocessor"></font>
00043 <font class="preprocessor"># include "exprChecks.h"</font>
00044 <font class="preprocessor"># include "filelocStack.h"</font>
00045 <font class="preprocessor"># include "fileIdList.h"</font>
00046 <font class="preprocessor"># include "llmain.h"</font>
00047 <font class="preprocessor"># include "intSet.h"</font>
00048 <font class="preprocessor"># include "osd.h"</font>
00049 <font class="preprocessor"># include "portab.h"</font>
00050 
00051 <font class="keyword">extern</font> <font class="comment">/*@external@*/</font> <font class="keywordtype">int</font> yydebug;
00052 
<a name="l00053"></a><a class="code" href="struct_maccesst.html">00053</a> <font class="keyword">typedef</font> <font class="keyword">struct</font>
00054 <font class="keyword"></font>{ 
<a name="l00055"></a><a class="code" href="struct_maccesst.html#m0">00055</a>   cstring file; 
<a name="l00056"></a><a class="code" href="struct_maccesst.html#m1">00056</a>   typeIdSet daccess ; 
00057 } <a class="code" href="struct_maccesst.html">maccesst</a>;
00058 
<a name="l00059"></a><a class="code" href="context_c.html#a257">00059</a> <font class="keyword">typedef</font> <font class="keyword">enum</font> { 
00060   CX_GLOBAL, CX_INNER, 
00061   CX_FUNCTION, CX_FCNDECL,
00062   CX_MACROFCN, CX_MACROCONST, CX_UNKNOWNMACRO, 
00063   CX_ITERDEF, CX_ITEREND,
00064   CX_LCL, CX_LCLLIB
00065 } kcontext;
00066 
<a name="l00067"></a><a class="code" href="struct__context.html">00067</a> <font class="keyword">static</font> <font class="keyword">struct </font><a class="code" href="struct__context.html">_context</a>
00068 {
<a name="l00069"></a><a class="code" href="struct__context.html#m0">00069</a>   <font class="keywordtype">int</font> linesprocessed;
<a name="l00070"></a><a class="code" href="struct__context.html#m1">00070</a>   <font class="keywordtype">int</font> speclinesprocessed;
00071 
<a name="l00072"></a><a class="code" href="struct__context.html#m2">00072</a>   flagMarkerList markers;
00073 
00074   <font class="comment">/*</font>
00075 <font class="comment">  **  used to record state where a macro must match a function name</font>
00076 <font class="comment">  **   (i.e., no params were listed in the macro definition</font>
00077 <font class="comment">  */</font>
00078 
00079   <font class="keywordtype">bool</font> macroMissingParams BOOLBITS;
00080   <font class="keywordtype">bool</font> preprocessing BOOLBITS;
00081   <font class="keywordtype">bool</font> incommandline BOOLBITS;
00082   <font class="keywordtype">bool</font> insuppressregion  BOOLBITS;
00083   <font class="keywordtype">bool</font> inDerivedFile BOOLBITS;
00084   <font class="keywordtype">bool</font> instandardlib  BOOLBITS;
00085   <font class="keywordtype">bool</font> inimport  BOOLBITS;
00086   <font class="keywordtype">bool</font> inheader  BOOLBITS;
00087   <font class="keywordtype">bool</font> inmacrocache  BOOLBITS;
00088   <font class="keywordtype">bool</font> protectVars  BOOLBITS;
00089   <font class="keywordtype">bool</font> neednl  BOOLBITS;
00090   <font class="keywordtype">bool</font> showfunction  BOOLBITS;
00091   <font class="keywordtype">bool</font> savedFlags  BOOLBITS;
00092   <font class="keywordtype">bool</font> justpopped  BOOLBITS;
<a name="l00093"></a><a class="code" href="struct__context.html#m17">00093</a>   <font class="keywordtype">bool</font> anyExports BOOLBITS;
00094 
<a name="l00095"></a><a class="code" href="struct__context.html#m18">00095</a>   flagcode library;
00096 
<a name="l00097"></a><a class="code" href="struct__context.html#m19">00097</a>   ynm isNullGuarded;
<a name="l00098"></a><a class="code" href="struct__context.html#m20">00098</a>   fileloc saveloc;
<a name="l00099"></a><a class="code" href="struct__context.html#m21">00099</a>   fileloc pushloc;
00100 
<a name="l00101"></a><a class="code" href="struct__context.html#m22">00101</a>   clauseStack clauses; 
<a name="l00102"></a><a class="code" href="struct__context.html#m23">00102</a>   clause inclause;
00103 
<a name="l00104"></a><a class="code" href="struct__context.html#m24">00104</a>   <font class="keywordtype">int</font> numerrors;
00105 
<a name="l00106"></a><a class="code" href="struct__context.html#m25">00106</a>   filelocStack locstack;
<a name="l00107"></a><a class="code" href="struct__context.html#m26">00107</a>   fileTable ftab;
<a name="l00108"></a><a class="code" href="struct__context.html#m27">00108</a>   cstring msgAnnote;
<a name="l00109"></a><a class="code" href="struct__context.html#m28">00109</a>   <font class="comment">/*@observer@*/</font> sRef aliasAnnote;
<a name="l00110"></a><a class="code" href="struct__context.html#m29">00110</a>   <font class="comment">/*@observer@*/</font> sRef aliasAnnoteAls;
<a name="l00111"></a><a class="code" href="struct__context.html#m30">00111</a>   messageLog  msgLog;
00112 
<a name="l00113"></a><a class="code" href="struct__context.html#m31">00113</a>   macrocache  mc;
<a name="l00114"></a><a class="code" href="struct__context.html#m32">00114</a>   <font class="comment">/*@observer@*/</font> sRefSet mods;
00115 
00116   <font class="comment">/* file access types */</font>
<a name="l00117"></a><a class="code" href="struct__context.html#m33">00117</a>   typeIdSet facct;   
00118 
00119   <font class="comment">/* local access types (this function) */</font>
<a name="l00120"></a><a class="code" href="struct__context.html#m34">00120</a>   typeIdSet acct;  
00121 
00122   <font class="comment">/* no access types (@noaccess) */</font>
<a name="l00123"></a><a class="code" href="struct__context.html#m35">00123</a>   typeIdSet nacct; 
00124 
<a name="l00125"></a><a class="code" href="struct__context.html#m36">00125</a>   <font class="comment">/*@observer@*/</font> globSet globs;
<a name="l00126"></a><a class="code" href="struct__context.html#m37">00126</a>   <font class="comment">/*@only@*/</font> globSet globs_used;
00127   
<a name="l00128"></a><a class="code" href="struct__context.html#m38">00128</a>   <font class="keywordtype">int</font> nmods;
<a name="l00129"></a><a class="code" href="struct__context.html#m39">00129</a>   <font class="keywordtype">int</font> maxmods;
<a name="l00130"></a><a class="code" href="struct__context.html#m40">00130</a>   <font class="comment">/*@reldef@*/</font> <a class="code" href="struct_maccesst.html">maccesst</a> *moduleaccess; <font class="comment">/* Not defined is nmods == 0. */</font>
00131   
<a name="l00132"></a><a class="code" href="struct__context.html#m41">00132</a>   kcontext kind;
00133 
<a name="l00134"></a><a class="code" href="struct__context.html#m42">00134</a>   ctype boolType;
00135 
<a name="l00136"></a><a class="code" href="struct__context.html#m43">00136</a>   <font class="keywordtype">bool</font> flags[NUMFLAGS];
<a name="l00137"></a><a class="code" href="struct__context.html#m44">00137</a>   <font class="keywordtype">bool</font> saveflags[NUMFLAGS];
<a name="l00138"></a><a class="code" href="struct__context.html#m45">00138</a>   <font class="keywordtype">bool</font> setGlobally[NUMFLAGS];
<a name="l00139"></a><a class="code" href="struct__context.html#m46">00139</a>   <font class="keywordtype">bool</font> setLocally[NUMFLAGS];
00140 
<a name="l00141"></a><a class="code" href="struct__context.html#m47">00141</a>   <font class="keywordtype">int</font> values[NUMVALUEFLAGS];
<a name="l00142"></a><a class="code" href="struct__context.html#m48">00142</a>   <font class="keywordtype">int</font> counters[NUMVALUEFLAGS];
00143 
<a name="l00144"></a><a class="code" href="struct__context.html#m49">00144</a>   o_cstring strings[NUMSTRINGFLAGS];
<a name="l00145"></a><a class="code" href="struct__context.html#m50">00145</a>   sRefSetList modrecs;
00146 
00147   <font class="keyword">union </font>
00148 <font class="keyword">    </font>{
<a name="l00149"></a><a class="code" href="struct__context.html#m51">00149</a>       <font class="keywordtype">bool</font> glob;
<a name="l00150"></a><a class="code" href="struct__context.html#m52">00150</a>       <font class="keywordtype">int</font>  cdepth;
<a name="l00151"></a><a class="code" href="struct__context.html#m53">00151</a>       <font class="comment">/*@dependent@*/</font> <font class="comment">/*@exposed@*/</font> uentry  fcn;
00152     } cont;
00153 } gc;
00154 
00155 <font class="keyword">static</font> <font class="comment">/*@exposed@*/</font> cstring context_exposeString (flagcode p_flag) ;
00156 <font class="keyword">static</font> <font class="keywordtype">void</font> context_restoreFlagSettings (<font class="keywordtype">void</font>) <font class="comment">/*@modifies gc@*/</font> ;
00157 <font class="keyword">static</font> <font class="keywordtype">void</font> context_saveFlagSettings (<font class="keywordtype">void</font>) <font class="comment">/*@modifies gc@*/</font> ;
00158 <font class="keyword">static</font> <font class="keywordtype">void</font> context_exitClauseAux (exprNode p_pred, exprNode p_tbranch)
00159    <font class="comment">/*@modifies gc@*/</font> ;
00160 <font class="keyword">static</font> <font class="keywordtype">void</font> context_exitClauseSimp (<font class="keywordtype">void</font>)  <font class="comment">/*@modifies gc@*/</font> ;
00161 <font class="keyword">static</font> <font class="keywordtype">void</font> context_exitClausePlain (<font class="keywordtype">void</font>) <font class="comment">/*@modifies gc@*/</font> ;
00162 <font class="keyword">static</font> <font class="keywordtype">void</font> context_setJustPopped (<font class="keywordtype">void</font>) <font class="comment">/*@modifies gc.justpopped@*/</font> ;
00163 <font class="keyword">static</font> <font class="keywordtype">void</font> context_setValue (flagcode p_flag, <font class="keywordtype">int</font> p_val) <font class="comment">/*@modifies gc.flags@*/</font> ;
00164 <font class="keyword">static</font> <font class="keywordtype">void</font> context_setFlag (flagcode p_f, <font class="keywordtype">bool</font> p_b)
00165   <font class="comment">/*@modifies gc.flags@*/</font> ;
00166 
00167 <font class="keyword">static</font> <font class="keywordtype">void</font>
00168   context_setFlagAux (flagcode p_f, <font class="keywordtype">bool</font> p_b, <font class="keywordtype">bool</font> p_inFile, <font class="keywordtype">bool</font> p_isRestore)
00169   <font class="comment">/*@modifies gc.flags@*/</font> ;
00170 
00171 <font class="keyword">static</font> <font class="keywordtype">void</font> context_restoreFlag (flagcode p_f) <font class="comment">/*@modifies gc.flags@*/</font> ;
00172 
00173 <font class="comment">/*@+enumindex@*/</font> 
00174 
<a name="l00175"></a><a class="code" href="context_c.html#a25">00175</a> cstring <a class="code" href="context_c.html#a25">context_unparseFlagMarkers</a> ()<font class="keyword"></font>
00176 <font class="keyword"></font>{
00177   <font class="keywordflow">return</font> (<a class="code" href="flagMarkerList_c.html#a5">flagMarkerList_unparse</a> (gc.markers));
00178 }
00179 
<a name="l00180"></a><a class="code" href="context_c.html#a26">00180</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a26">context_setPreprocessing</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00181 <font class="keyword"></font>{
00182   llassert (!gc.preprocessing);
00183   gc.preprocessing = TRUE;
00184 }
00185 
<a name="l00186"></a><a class="code" href="context_c.html#a27">00186</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a27">context_clearPreprocessing</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00187 <font class="keyword"></font>{
00188   llassert (gc.preprocessing);
00189   gc.preprocessing = FALSE;
00190 }
00191 
<a name="l00192"></a><a class="code" href="context_c.html#a28">00192</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a28">context_isPreprocessing</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00193 <font class="keyword"></font>{
00194   <font class="keywordflow">return</font> gc.preprocessing;
00195 }
00196 
<a name="l00197"></a><a class="code" href="context_c.html#a29">00197</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a29">context_setInCommandLine</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00198 <font class="keyword"></font>{
00199   llassert (!gc.incommandline);
00200   gc.incommandline = TRUE;
00201 }
00202 
<a name="l00203"></a><a class="code" href="context_c.html#a30">00203</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a30">context_clearInCommandLine</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00204 <font class="keyword"></font>{
00205   llassert (gc.incommandline);
00206   gc.incommandline = FALSE;
00207 }
00208 
<a name="l00209"></a><a class="code" href="context_c.html#a31">00209</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a31">context_isInCommandLine</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00210 <font class="keyword"></font>{
00211   <font class="keywordflow">return</font> gc.incommandline;
00212 }
00213 
00214 <font class="keyword">static</font>
00215 <font class="keywordtype">void</font> pushClause (clause c) <font class="comment">/*@modifies gc.clauses, gc.inclause@*/</font>
00216 {
00217   gc.inclause = c;
00218   <a class="code" href="clauseStack_c.html#a2">clauseStack_push</a> (gc.clauses, c);
00219 
00220   <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a6">clause_isConditional</a> (c)
00221       &amp;&amp; <a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_CONTROLNESTDEPTH))
00222     {
00223       <font class="keywordtype">int</font> maxdepth = <a class="code" href="context_c.html#a151">context_getValue</a> (FLG_CONTROLNESTDEPTH);
00224       <font class="keywordtype">int</font> depth = <a class="code" href="clauseStack_c.html#a7">clauseStack_controlDepth</a> (gc.clauses);
00225       
00226       <font class="keywordflow">if</font> (depth == maxdepth + 1)
00227         {
00228           voptgenerror 
00229             (FLG_CONTROLNESTDEPTH,
00230              <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Maximum control nesting depth "</font>
00231                       <font class="stringliteral">"(%d) exceeded"</font>,
00232                       maxdepth),
00233              g_currentloc);
00234         }
00235     }
00236 }
00237 
00238 <font class="keyword">static</font>
00239 clause topClause (clauseStack s) <font class="comment">/*@*/</font>
00240 {
00241   <font class="keywordflow">if</font> (clauseStack_isEmpty (s)) <font class="keywordflow">return</font> NOCLAUSE;
00242   <font class="keywordflow">return</font> ((clause) <a class="code" href="clauseStack_c.html#a4">clauseStack_top</a> (s));
00243 }
00244 
00245 <font class="keywordtype">void</font>
<a name="l00246"></a><a class="code" href="context_c.html#a34">00246</a> <a class="code" href="context_c.html#a34">context_addMacroCache</a> (<font class="comment">/*@only@*/</font> cstring def)<font class="keyword"></font>
00247 <font class="keyword"></font>{
00248     <a class="code" href="macrocache_c.html#a14">macrocache_addEntry</a> (gc.mc, fileloc_copy (g_currentloc), def);
00249 }
00250 
00251 <font class="keywordtype">void</font>
<a name="l00252"></a><a class="code" href="context_c.html#a35">00252</a> <a class="code" href="context_c.html#a35">context_addComment</a> (<font class="comment">/*@only@*/</font> cstring def)<font class="keyword"></font>
00253 <font class="keyword"></font>{
00254     <a class="code" href="macrocache_c.html#a15">macrocache_addComment</a> (gc.mc, fileloc_copy (g_currentloc), def);
00255 }
00256 
00257 <font class="comment">/*</font>
00258 <font class="comment">** returns TRUE is fl is in ignore region, or region where -code</font>
00259 <font class="comment">**</font>
00260 <font class="comment">** the logic is fuzzy...</font>
00261 <font class="comment">*/</font>
00262 
00263 <font class="keyword">static</font> <font class="keywordtype">bool</font>
00264 context_inSuppressFlagZone (fileloc fl, flagcode code)<font class="keyword"></font>
00265 <font class="keyword"></font>{
00266   ynm ret = <a class="code" href="flagMarkerList_c.html#a8">flagMarkerList_suppressError</a> (gc.markers, code, fl);
00267   <font class="keywordtype">bool</font> res = FALSE;
00268   
00269   <font class="keywordflow">if</font> (ynm_isMaybe (ret))
00270     {
00271       <font class="comment">/*</font>
00272 <font class="comment">      ** whas is dis?</font>
00273 <font class="comment">      */</font>
00274 
00275       <font class="keywordflow">if</font> (gc.savedFlags)
00276         {
00277           res = !gc.saveflags[code];
00278         }
00279       <font class="keywordflow">else</font>
00280         {
00281           res = !<a class="code" href="context_c.html#a189">context_getFlag</a> (code);
00282         }
00283     }
00284   <font class="keywordflow">else</font>
00285     {
00286       res = ynm_toBoolStrict (ret);
00287     }
00288   
00289     <font class="keywordflow">return</font> res;
00290 }
00291 
00292 <font class="keyword">static</font> <font class="keywordtype">bool</font>
00293 context_suppressSystemMsg (fileloc fl)<font class="keyword"></font>
00294 <font class="keyword"></font>{
00295   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_SYSTEMDIRERRORS))
00296     {
00297       <font class="keywordflow">return</font> FALSE;
00298     }
00299   <font class="keywordflow">else</font>
00300     {
00301       <font class="keywordflow">return</font> (<a class="code" href="fileloc_c.html#a20">fileloc_isSystemFile</a> (fl));
00302     }
00303 }
00304 
00305 <font class="keywordtype">bool</font> 
<a name="l00306"></a><a class="code" href="context_c.html#a38">00306</a> <a class="code" href="context_c.html#a38">context_suppressFlagMsg</a> (flagcode flag, fileloc fl)<font class="keyword"></font>
00307 <font class="keyword"></font>{
00308   <font class="keywordflow">if</font> (context_suppressSystemMsg (fl))
00309     {
00310       <font class="keywordflow">return</font> TRUE;
00311     }
00312 
00313   <font class="comment">/* want same object compare here */</font>
00314 
00315   <font class="keywordflow">if</font> (<a class="code" href="fileloc_c.html#a11">fileloc_equal</a> (fl, g_currentloc) || gc.inDerivedFile)
00316     {
00317       <font class="keywordflow">return</font> (!<a class="code" href="context_c.html#a189">context_getFlag</a> (flag)
00318               || <a class="code" href="context_c.html#a41">context_inSuppressRegion</a> ()
00319               || <a class="code" href="context_c.html#a40">context_inSuppressZone</a> (fl)
00320               || (gc.inDerivedFile &amp;&amp; context_inSuppressFlagZone (fl, flag)));
00321     }
00322   <font class="keywordflow">else</font>
00323     {
00324             <font class="keywordflow">return</font> (context_inSuppressFlagZone (fl, flag));
00325     }
00326 }
00327 
00328 <font class="keywordtype">bool</font> 
<a name="l00329"></a><a class="code" href="context_c.html#a39">00329</a> <a class="code" href="context_c.html#a39">context_suppressNotFlagMsg</a> (flagcode flag, fileloc fl)<font class="keyword"></font>
00330 <font class="keyword"></font>{
00331   
00332   <font class="keywordflow">if</font> (context_suppressSystemMsg (fl))
00333     {
00334       <font class="keywordflow">return</font> TRUE;
00335     }
00336 
00337   <font class="comment">/*@access fileloc@*/</font> 
00338   <font class="keywordflow">if</font> (fl == g_currentloc)
00339     <font class="comment">/*@noaccess fileloc@*/</font>
00340     {
00341       <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (flag) || <a class="code" href="context_c.html#a41">context_inSuppressRegion</a> ());
00342     }
00343   <font class="keywordflow">else</font>
00344     {
00345       <font class="comment">/* for now... */</font>
00346       <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (flag) || <a class="code" href="context_c.html#a41">context_inSuppressRegion</a> ());
00347     }
00348 }
00349 
00350 <font class="keywordtype">bool</font>
<a name="l00351"></a><a class="code" href="context_c.html#a40">00351</a> <a class="code" href="context_c.html#a40">context_inSuppressZone</a> (fileloc fl)<font class="keyword"> </font>
00352 <font class="keyword"></font>{
00353   <font class="keywordflow">if</font> (context_suppressSystemMsg (fl))
00354     {
00355       <font class="keywordflow">return</font> TRUE;
00356     }
00357 
00358   <font class="keywordflow">return</font> (<a class="code" href="flagMarkerList_c.html#a9">flagMarkerList_inIgnore</a> (gc.markers, fl));
00359 }
00360 
00361 <font class="keywordtype">bool</font>
<a name="l00362"></a><a class="code" href="context_c.html#a41">00362</a> <a class="code" href="context_c.html#a41">context_inSuppressRegion</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00363 <font class="keyword"></font>{
00364   <font class="keywordflow">return</font> (gc.insuppressregion);
00365 }
00366 
00367 <font class="keywordtype">void</font>
<a name="l00368"></a><a class="code" href="context_c.html#a42">00368</a> <a class="code" href="context_c.html#a42">context_enterSuppressRegion</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00369 <font class="keyword"></font>{
00370   <font class="keywordflow">if</font> (gc.insuppressregion)
00371     {
00372       gc.insuppressregion = FALSE;      <font class="comment">/* get this msg! */</font>
00373       <a class="code" href="llerror_c.html#a21">llmsg</a> (message
00374              (<font class="stringliteral">"%q: New ignore errors region entered while in ignore errors region"</font>,
00375               fileloc_unparse (g_currentloc)));
00376     }
00377   
00378   gc.insuppressregion = TRUE;
00379   <a class="code" href="flagMarkerList_c.html#a2">flagMarkerList_add</a> (gc.markers, flagMarker_createIgnoreOn (g_currentloc));
00380 }
00381 
00382 <font class="keyword">static</font> <font class="keywordtype">void</font>
00383 context_addFlagMarker (flagcode code, ynm set)<font class="keyword"></font>
00384 <font class="keyword"></font>{
00385   <a class="code" href="flagMarkerList_c.html#a2">flagMarkerList_add</a> (gc.markers,
00386                       flagMarker_createLocalSet (code, set, g_currentloc));
00387 }
00388 
00389 <font class="keywordtype">void</font>
<a name="l00390"></a><a class="code" href="context_c.html#a44">00390</a> <a class="code" href="context_c.html#a44">context_enterSuppressLine</a> (<font class="keywordtype">int</font> count)<font class="keyword"></font>
00391 <font class="keyword"></font>{
00392   fileloc nextline = <a class="code" href="fileloc_c.html#a5">fileloc_copy</a> (g_currentloc);
00393 
00394   <a class="code" href="flagMarkerList_c.html#a2">flagMarkerList_add</a> (gc.markers,
00395                       flagMarker_createIgnoreCount (count, g_currentloc));
00396 
00397   fileloc_nextLine (nextline);
00398   <a class="code" href="flagMarkerList_c.html#a2">flagMarkerList_add</a> (gc.markers,
00399                       flagMarker_createIgnoreOff (nextline));
00400   <a class="code" href="fileloc_c.html#a8">fileloc_free</a> (nextline);
00401 }
00402 
<a name="l00403"></a><a class="code" href="context_c.html#a45">00403</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a45">context_checkSuppressCounts</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00404 <font class="keyword"></font>{
00405   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_SUPCOUNTS))
00406     {
00407       <a class="code" href="flagMarkerList_c.html#a3">flagMarkerList_checkSuppressCounts</a> (gc.markers);
00408     }
00409 }
00410 
<a name="l00411"></a><a class="code" href="context_c.html#a46">00411</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a46">context_incLineno</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00412 <font class="keyword"></font>{
00413   gc.linesprocessed++;
00414   incLine ();
00415 }
00416 
00417 <font class="keywordtype">void</font>
<a name="l00418"></a><a class="code" href="context_c.html#a47">00418</a> <a class="code" href="context_c.html#a47">context_exitSuppressRegion</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00419 <font class="keyword"></font>{
00420   <font class="keywordflow">if</font> (!gc.insuppressregion)
00421     {
00422       llerrorlit (FLG_SYNTAX, 
00423                   <font class="stringliteral">"End ignore errors in region while not ignoring errors"</font>);
00424     }
00425 
00426     gc.insuppressregion = FALSE;
00427   <a class="code" href="flagMarkerList_c.html#a2">flagMarkerList_add</a> (gc.markers, flagMarker_createIgnoreOff (g_currentloc));
00428 }
00429 
00430 <font class="preprocessor"># ifndef NOLCL</font>
00431 <font class="preprocessor"></font><font class="keywordtype">void</font>
<a name="l00432"></a><a class="code" href="context_c.html#a48">00432</a> <a class="code" href="context_c.html#a48">context_enterLCLfile</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00433 <font class="keyword"></font>{
00434   gc.kind = CX_LCL;
00435   gc.facct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> ();
00436 }
00437 <font class="preprocessor"># endif</font>
00438 <font class="preprocessor"></font>
00439 <font class="keyword">static</font> <font class="keywordtype">void</font>
00440 addModuleAccess (<font class="comment">/*@only@*/</font> cstring fname, typeIdSet mods)<font class="keyword"></font>
00441 <font class="keyword"></font>{
00442   <font class="keywordtype">int</font> i;
00443 
00444   <font class="keywordflow">for</font> (i = 0; i &lt; gc.nmods; i++)
00445     {
00446       <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a18">cstring_equal</a> (gc.moduleaccess[i].file, fname))
00447         {
00448           gc.moduleaccess[i].daccess = <a class="code" href="typeIdSet_c.html#a26">typeIdSet_union</a> (gc.moduleaccess[i].daccess, mods);
00449           <a class="code" href="cstring_c.html#a27">cstring_free</a> (fname);
00450           <font class="keywordflow">return</font>;
00451         }
00452     }
00453   
00454   <font class="keywordflow">if</font> (gc.nmods == gc.maxmods)
00455     {
00456       <a class="code" href="struct_maccesst.html">maccesst</a> *oldmods;
00457       
00458       gc.maxmods = gc.maxmods + DEFAULTMAXMODS;      
00459       oldmods = gc.moduleaccess;
00460       
00461       gc.moduleaccess = (<a class="code" href="struct_maccesst.html">maccesst</a> *) dmalloc (<font class="keyword">sizeof</font> (*gc.moduleaccess) * (gc.maxmods));
00462       
00463       <font class="keywordflow">for</font> (i = 0; i &lt; gc.nmods; i++)
00464         {
00465           gc.moduleaccess[i] = oldmods[i];
00466         }
00467       
00468       <a class="code" href="general_c.html#a0">sfree</a> (oldmods);
00469     }
00470   
00471   gc.moduleaccess[gc.nmods].file = fname;
00472   gc.moduleaccess[gc.nmods].daccess = mods;
00473   
00474   gc.nmods++;
00475 }
00476 
00477 <font class="keyword">static</font> <font class="keywordtype">void</font>
00478 insertModuleAccess (cstring fname, typeId t)<font class="keyword"></font>
00479 <font class="keyword"></font>{
00480   <font class="keywordtype">int</font> i;
00481   
00482   <font class="keywordflow">for</font> (i = 0; i &lt; gc.nmods; i++)
00483     {
00484       <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a18">cstring_equal</a> (gc.moduleaccess[i].file, fname))
00485         {
00486           gc.moduleaccess[i].daccess = <a class="code" href="typeIdSet_c.html#a19">typeIdSet_insert</a> (gc.moduleaccess[i].daccess, t);
00487           <font class="keywordflow">break</font>;
00488         }
00489     }
00490   
00491     addModuleAccess (cstring_copy (fname), <a class="code" href="typeIdSet_c.html#a17">typeIdSet_single</a> (t));
00492 }
00493 
00494 <font class="preprocessor"># ifndef NOLCL</font>
00495 <font class="preprocessor"></font><font class="keywordtype">void</font>
<a name="l00496"></a><a class="code" href="context_c.html#a51">00496</a> <a class="code" href="context_c.html#a51">context_exitLCLfile</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00497 <font class="keyword"></font>{
00498   <font class="keywordflow">if</font> (gc.kind != CX_LCLLIB)
00499     {
00500       <font class="keywordtype">char</font> *lclname =  
00501         <a class="code" href="general_c.html#a9">removeExtension</a> (cstring_toCharsSafe 
00502                          (fileName (currentFile ())), <font class="stringliteral">".lcl"</font>); 
00503       
00504       addModuleAccess (cstring_fromCharsO (removePath (lclname)), gc.facct);
00505       
00506       mstring_free (lclname);
00507     }
00508   
00509   gc.kind = CX_LCL;
00510   gc.kind = CX_GLOBAL;
00511   gc.facct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> ();
00512 }
00513 <font class="preprocessor"># endif</font>
00514 <font class="preprocessor"></font>
00515 <font class="keywordtype">void</font>
<a name="l00516"></a><a class="code" href="context_c.html#a52">00516</a> <a class="code" href="context_c.html#a52">context_dumpModuleAccess</a> (FILE *fout)<font class="keyword"></font>
00517 <font class="keyword"></font>{
00518   <font class="keywordtype">int</font> i = 0;
00519 
00520   <font class="keywordflow">for</font> (i = 0; i &lt; gc.nmods; i++)
00521     {
00522       cstring td = <a class="code" href="typeIdSet_c.html#a24">typeIdSet_dump</a> (gc.moduleaccess[i].daccess);
00523 
00524       fprintf (fout, <font class="stringliteral">"%s#%s@\n"</font>, 
00525                cstring_toCharsSafe (gc.moduleaccess[i].file), 
00526                <a class="code" href="cstring_c.html#a29">cstring_toCharsSafe</a> (td));
00527       
00528       <a class="code" href="cstring_c.html#a27">cstring_free</a> (td);
00529     }
00530 }
00531 
<a name="l00532"></a><a class="code" href="context_c.html#a53">00532</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a53">context_usingPosixLibrary</a> ()<font class="keyword"></font>
00533 <font class="keyword"></font>{
00534   <font class="keywordflow">return</font> (gc.library == FLG_POSIXLIB 
00535           || gc.library == FLG_POSIXSTRICTLIB
00536           || gc.library == FLG_UNIXLIB
00537           || gc.library == FLG_UNIXSTRICTLIB);
00538 }
00539 
<a name="l00540"></a><a class="code" href="context_c.html#a54">00540</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a54">context_usingAnsiLibrary</a> ()<font class="keyword"></font>
00541 <font class="keyword"></font>{
00542   <font class="keywordflow">return</font> (gc.library != FLG_NOLIB);
00543 }
00544 
<a name="l00545"></a><a class="code" href="context_c.html#a55">00545</a> flagcode <a class="code" href="context_c.html#a55">context_getLibrary</a> ()<font class="keyword"></font>
00546 <font class="keyword"></font>{
00547   <font class="keywordflow">return</font> gc.library;
00548 }
00549 
<a name="l00550"></a><a class="code" href="context_c.html#a56">00550</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a56">context_setLibrary</a> (flagcode code)<font class="keyword"></font>
00551 <font class="keyword"></font>{
00552   gc.library = code;
00553 }
00554 
<a name="l00555"></a><a class="code" href="context_c.html#a57">00555</a> <font class="comment">/*@observer@*/</font> <font class="keywordtype">char</font> *<a class="code" href="context_c.html#a57">context_selectedLibrary</a> ()<font class="keyword"></font>
00556 <font class="keyword"></font>{
00557   <font class="keywordflow">switch</font> (gc.library)
00558     {
00559     <font class="keywordflow">case</font> FLG_STRICTLIB:
00560       <font class="keywordflow">return</font> LLSTRICTLIBS_NAME;
00561     <font class="keywordflow">case</font> FLG_POSIXLIB:
00562       <font class="keywordflow">return</font> LLPOSIXLIBS_NAME;
00563     <font class="keywordflow">case</font> FLG_POSIXSTRICTLIB:
00564       <font class="keywordflow">return</font> LLPOSIXSTRICTLIBS_NAME;
00565     <font class="keywordflow">case</font> FLG_UNIXLIB:
00566       <font class="keywordflow">return</font> LLUNIXLIBS_NAME;    
00567     <font class="keywordflow">case</font> FLG_UNIXSTRICTLIB:
00568       <font class="keywordflow">return</font> LLUNIXSTRICTLIBS_NAME;
00569     <font class="keywordflow">case</font> FLG_ANSILIB:
00570       <font class="keywordflow">return</font> LLSTDLIBS_NAME;
00571     BADDEFAULT;
00572     }
00573 }
00574   
00575 
00576 <font class="keywordtype">void</font>
<a name="l00577"></a><a class="code" href="context_c.html#a58">00577</a> <a class="code" href="context_c.html#a58">context_loadModuleAccess</a> (FILE *in)<font class="keyword"></font>
00578 <font class="keyword"></font>{
00579   <font class="keywordtype">char</font> *s = <a class="code" href="general_c.html#a29">mstring_create</a> (MAX_DUMP_LINE_LENGTH);
00580   <font class="keywordtype">char</font> *lasts = s;
00581   <font class="keywordtype">char</font> *name = <a class="code" href="general_c.html#a29">mstring_create</a> (MAX_NAME_LENGTH);
00582   <font class="keywordtype">char</font> *oname = name;
00583 <font class="preprocessor"># ifndef NOFREE</font>
00584 <font class="preprocessor"></font>  <font class="keywordtype">char</font> *os = s;
00585 <font class="preprocessor"># endif</font>
00586 <font class="preprocessor"></font>
00587   <font class="keywordflow">while</font> (fgets (s, MAX_DUMP_LINE_LENGTH, in) != NULL 
00588          &amp;&amp; *s == <font class="charliteral">';'</font>)
00589     {
00590       ;
00591     }
00592 
00593   <font class="keywordflow">while</font> (s != NULL &amp;&amp; *s != <font class="charliteral">';'</font> &amp;&amp; *s != <font class="charliteral">'\0'</font>)
00594     {
00595       name = oname;
00596       
00597       <font class="keywordflow">while</font> (*s != <font class="charliteral">'#'</font> &amp;&amp; *s != <font class="charliteral">'\0'</font>)
00598         {
00599           *name++ = *s++;
00600         }
00601 
00602       *name = <font class="charliteral">'\0'</font>;
00603 
00604       <font class="keywordflow">if</font> (*s != <font class="charliteral">'#'</font>)
00605         {
00606           llcontbug (message (<font class="stringliteral">"context_loadModuleAccess: bad library line: %s\n"</font>, 
00607                               cstring_fromChars (s)));
00608           <font class="keywordflow">break</font>;
00609         }
00610 
00611       s++;
00612 
00613       addModuleAccess (cstring_copy (cstring_fromChars (oname)), 
00614                        <a class="code" href="typeIdSet_c.html#a25">typeIdSet_undump</a> (&amp;s)); 
00615 
00616       (<font class="keywordtype">void</font>) fgets (s, MAX_DUMP_LINE_LENGTH, in);
00617       llassert (s != lasts);
00618       lasts = s;
00619     }
00620 
00621   <a class="code" href="general_c.html#a0">sfree</a> (oname);
00622 <font class="preprocessor"># ifndef NOFREE</font>
00623 <font class="preprocessor"></font>  <a class="code" href="general_c.html#a0">sfree</a> (os);
00624 <font class="preprocessor"># endif</font>
00625 <font class="preprocessor"></font>}
00626 
<a name="l00627"></a><a class="code" href="context_c.html#a59">00627</a> typeIdSet <a class="code" href="context_c.html#a59">context_fileAccessTypes</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00628 <font class="keyword"></font>{
00629   <font class="keywordflow">return</font> gc.facct;
00630 }
00631 
00632 <font class="keywordtype">void</font>
<a name="l00633"></a><a class="code" href="context_c.html#a60">00633</a> <a class="code" href="context_c.html#a60">context_resetModeFlags</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00634 <font class="keyword"></font>{
00635   
00636   allFlagCodes (code)<font class="keyword"></font>
00637 <font class="keyword">    </font>{
00638       <font class="keywordflow">if</font> (<a class="code" href="flags_c.html#a18">flagcode_isModeFlag</a> (code))
00639         {
00640           context_setFlag (code, FALSE);
00641         }
00642     } end_allFlagCodes;
00643 
00644   }
00645 
00646 <font class="comment">/*</font>
00647 <font class="comment">** resetAllFlags</font>
00648 <font class="comment">**</font>
00649 <font class="comment">** Set all flags to FALSE, except for a few which are</font>
00650 <font class="comment">** true by default.</font>
00651 <font class="comment">**</font>
00652 <font class="comment">** Set all values and strings to appropriate defaults.</font>
00653 <font class="comment">** Set all counters to 0.</font>
00654 <font class="comment">*/</font>
00655 
00656 <font class="keyword">static</font> <font class="keywordtype">void</font>
00657 conext_resetAllCounters (<font class="keywordtype">void</font>)<font class="keyword"></font>
00658 <font class="keyword"></font>{
00659   <font class="keywordtype">int</font> i;
00660 
00661   <font class="keywordflow">for</font> (i = 0; i &lt; NUMVALUEFLAGS; i++)
00662     {
00663       gc.counters[i] = 0;
00664     }
00665 }
00666 
00667 <font class="keywordtype">void</font>
<a name="l00668"></a><a class="code" href="context_c.html#a62">00668</a> <a class="code" href="context_c.html#a62">context_resetAllFlags</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
00669 <font class="keyword"></font>{
00670   allFlagCodes (code)<font class="keyword"></font>
00671 <font class="keyword">    </font>{
00672       gc.flags[code] = FALSE;
00673 
00674       <font class="keywordflow">if</font> (<a class="code" href="flags_c.html#a42">flagcode_hasValue</a> (code))
00675         {
00676           <font class="keywordtype">int</font> val = 0;
00677           
00678           <font class="comment">/*@-loopswitchbreak@*/</font>
00679           <font class="keywordflow">switch</font> (code)
00680             {
00681             <font class="keywordflow">case</font> FLG_LIMIT: 
00682               val = DEFAULT_LIMIT; <font class="keywordflow">break</font>;
00683             <font class="keywordflow">case</font> FLG_LINELEN: 
00684               val = DEFAULT_LINELEN; <font class="keywordflow">break</font>;
00685             <font class="keywordflow">case</font> FLG_EXTERNALNAMELEN:
00686               val = DEFAULT_EXTERNALNAMELEN; <font class="keywordflow">break</font>;
00687             <font class="keywordflow">case</font> FLG_INTERNALNAMELEN:
00688               val = DEFAULT_INTERNALNAMELEN; <font class="keywordflow">break</font>;
00689             <font class="keywordflow">case</font> FLG_COMMENTCHAR: 
00690               val = (<font class="keywordtype">int</font>) DEFAULT_COMMENTCHAR; <font class="keywordflow">break</font>;
00691             <font class="keywordflow">case</font> FLG_CONTROLNESTDEPTH:
00692               val = (<font class="keywordtype">int</font>) DEFAULT_CONTROLNESTDEPTH; <font class="keywordflow">break</font>;
00693             <font class="keywordflow">case</font> FLG_STRINGLITERALLEN:
00694               val = (<font class="keywordtype">int</font>) DEFAULT_STRINGLITERALLEN; <font class="keywordflow">break</font>;
00695             <font class="keywordflow">case</font> FLG_INCLUDENEST:
00696               val = (<font class="keywordtype">int</font>) DEFAULT_INCLUDENEST; <font class="keywordflow">break</font>;
00697             <font class="keywordflow">case</font> FLG_NUMSTRUCTFIELDS:
00698               val = (<font class="keywordtype">int</font>) DEFAULT_NUMSTRUCTFIELDS; <font class="keywordflow">break</font>;
00699             <font class="keywordflow">case</font> FLG_NUMENUMMEMBERS:
00700               val = (<font class="keywordtype">int</font>) DEFAULT_NUMENUMMEMBERS; <font class="keywordflow">break</font>;
00701             <font class="keywordflow">case</font> FLG_EXPECT:
00702             <font class="keywordflow">case</font> FLG_LCLEXPECT:
00703               <font class="keywordflow">break</font>;
00704             <font class="keywordflow">default</font>:
00705               llbug (message (<font class="stringliteral">"Bad value flag: %s"</font>, flagcode_unparse (code)));
00706             }
00707           <font class="comment">/*@=loopswitchbreak@*/</font>          
00708 
00709           context_setValue (code, val);
00710         }
00711       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="flags_c.html#a43">flagcode_hasString</a> (code))
00712         {
00713           cstring val = cstring_undefined;
00714           
00715           <font class="keywordflow">switch</font> (code)
00716             { <font class="comment">/*@-loopswitchbreak@*/</font>
00717             <font class="keywordflow">case</font> FLG_LARCHPATH:
00718               {
00719                 <font class="keywordtype">char</font> *larchpath = <a class="code" href="osd_c.html#a11">osd_getEnvironmentVariable</a> (LARCH_PATH);
00720                 
00721                 <font class="keywordflow">if</font> (larchpath != NULL)
00722                   {
00723                     val = cstring_fromCharsNew (larchpath);
00724                   }
00725                 <font class="keywordflow">else</font>
00726                   {
00727                     val = cstring_makeLiteral (DEFAULT_LARCHPATH);
00728                   }
00729                 
00730                 <font class="keywordflow">break</font>;
00731               }
00732             <font class="keywordflow">case</font> FLG_LCLIMPORTDIR:
00733               {
00734                 val = cstring_fromCharsNew (osd_getEnvironment (LCLIMPORTDIR, DEFAULT_LCLIMPORTDIR));
00735                 <font class="keywordflow">break</font>;
00736               }
00737             <font class="keywordflow">case</font> FLG_TMPDIR: 
00738 <font class="preprocessor"># if defined(OS2) || defined(MSDOS) || defined(WIN32)</font>
00739 <font class="preprocessor"></font>              {
00740                 <font class="keywordtype">char</font> *env = <a class="code" href="osd_c.html#a11">osd_getEnvironmentVariable</a> (<font class="stringliteral">"TMP"</font>);
00741 
00742                 <font class="keywordflow">if</font> (env == NULL)
00743                   {
00744                     env = <a class="code" href="osd_c.html#a11">osd_getEnvironmentVariable</a> (<font class="stringliteral">"TEMP"</font>);
00745                   }
00746 
00747                 val = cstring_makeLiteral (env != NULL ? env : DEFAULT_TMPDIR);
00748               }
00749 <font class="preprocessor"># else</font>
00750 <font class="preprocessor"></font>              val = cstring_makeLiteral (DEFAULT_TMPDIR);
00751 <font class="preprocessor"># endif </font><font class="comment">/* !defined(OS2) &amp;&amp; !defined(MSDOS) */</font>
00752 
00753               <font class="keywordflow">break</font>;
00754             <font class="keywordflow">case</font> FLG_BOOLTYPE:
00755               val = cstring_makeLiteral (DEFAULT_BOOLTYPE); <font class="keywordflow">break</font>;
00756             <font class="keywordflow">case</font> FLG_BOOLFALSE:
00757               val = cstring_makeLiteral (<font class="stringliteral">"FALSE"</font>); <font class="keywordflow">break</font>;
00758             <font class="keywordflow">case</font> FLG_BOOLTRUE:
00759               val = cstring_makeLiteral (<font class="stringliteral">"TRUE"</font>); <font class="keywordflow">break</font>;
00760             <font class="keywordflow">case</font> FLG_MACROVARPREFIX: 
00761               val = cstring_makeLiteral (<font class="stringliteral">"m_"</font>); <font class="keywordflow">break</font>;
00762             <font class="keywordflow">case</font> FLG_SYSTEMDIRS:
00763               val = cstring_makeLiteral (DEFAULT_SYSTEMDIR); <font class="keywordflow">break</font>;
00764             <font class="keywordflow">default</font>:
00765               <font class="keywordflow">break</font>;
00766             } <font class="comment">/*@=loopswitchbreak@*/</font>
00767           
00768           <a class="code" href="context_c.html#a156">context_setString</a> (code, val);
00769         }
00770       <font class="keywordflow">else</font>
00771         { 
00772           ; <font class="comment">/* nothing to set */</font>
00773         }
00774     } end_allFlagCodes;
00775   
00776   <font class="comment">/*</font>
00777 <font class="comment">  ** These flags are true by default.</font>
00778 <font class="comment">  */</font>
00779 
00780   gc.flags[FLG_MODIFIES] = TRUE;
00781   gc.flags[FLG_NESTCOMMENT] = TRUE;
00782   gc.flags[FLG_GLOBALS] = TRUE;
00783   gc.flags[FLG_FULLINITBLOCK] = TRUE;
00784   gc.flags[FLG_LIKELYBOOL] = TRUE;
00785   gc.flags[FLG_ZEROPTR] = TRUE;
00786   gc.flags[FLG_NUMLITERAL] = TRUE;
00787   gc.flags[FLG_DUPLICATEQUALS] = TRUE;
00788   gc.flags[FLG_SKIPANSIHEADERS] = TRUE;
00789   gc.flags[FLG_SKIPPOSIXHEADERS] = TRUE;
00790   gc.flags[FLG_SYSTEMDIREXPAND] = TRUE;
00791   gc.flags[FLG_UNRECOGCOMMENTS] = TRUE;
00792   gc.flags[FLG_CASTFCNPTR] = TRUE;
00793   gc.flags[FLG_DOLCS] = TRUE;
00794   gc.flags[FLG_USEVARARGS] = TRUE;
00795   gc.flags[FLG_MAINTYPE] = TRUE;
00796   gc.flags[FLG_SPECMACROS] = TRUE;
00797   gc.flags[FLG_REDEF] = TRUE;
00798   gc.flags[FLG_MACRONEXTLINE] = TRUE;
00799 
00800   gc.flags[FLG_SIZEOFFORMALARRAY] = TRUE;
00801   gc.flags[FLG_FIXEDFORMALARRAY] = TRUE;
00802 
00803   gc.flags[FLG_PREDASSIGN] = TRUE;
00804   gc.flags[FLG_MODOBSERVER] = TRUE;
00805   gc.flags[FLG_MACROVARPREFIXEXCLUDE] = TRUE;
00806   gc.flags[FLG_EXTERNALNAMECASEINSENSITIVE] = TRUE;
00807 
00808   gc.flags[FLG_PARAMIMPTEMP] = TRUE;
00809   gc.flags[FLG_RETIMPONLY] = TRUE;
00810   gc.flags[FLG_GLOBIMPONLY] = TRUE;
00811   gc.flags[FLG_STRUCTIMPONLY] = TRUE;
00812   gc.flags[FLG_PREPROC] = TRUE;
00813   gc.flags[FLG_NAMECHECKS] = TRUE;
00814   gc.flags[FLG_FORMATCODE] = TRUE;
00815   gc.flags[FLG_FORMATTYPE] = TRUE;
00816   gc.flags[FLG_BADFLAG] = TRUE;
00817   gc.flags[FLG_WARNFLAGS] = TRUE;
00818   gc.flags[FLG_WARNUNIXLIB] = TRUE;
00819   gc.flags[FLG_WARNPOSIX] = TRUE;
00820   gc.flags[FLG_SHOWCOL] = TRUE;
00821   gc.flags[FLG_SHOWFUNC] = TRUE;
00822   gc.flags[FLG_SUPCOUNTS] = TRUE;
00823   gc.flags[FLG_HINTS] = TRUE;
00824   gc.flags[FLG_SYNTAX] = TRUE;
00825   gc.flags[FLG_TYPE] = TRUE;
00826   gc.flags[FLG_INCOMPLETETYPE] = TRUE;
00827   gc.flags[FLG_ABSTRACT] = TRUE;
00828   gc.flags[FLG_ITER] = TRUE;
00829   gc.flags[FLG_CONTROL] = TRUE;
00830   gc.flags[FLG_UNRECOG] = TRUE;
00831   gc.flags[FLG_SYSTEMUNRECOG] = TRUE;
00832   gc.flags[FLG_LINTCOMMENTS] = TRUE;
00833   gc.flags[FLG_ACCESSCZECH] = TRUE;
00834   gc.flags[FLG_ACCESSMODULE] = TRUE;
00835   gc.flags[FLG_ACCESSFILE] = TRUE;
00836   gc.flags[FLG_MACROVARPREFIX] = TRUE;
00837 
00838   <font class="comment">/*</font>
00839 <font class="comment">  ** Changed for version 2.4.</font>
00840 <font class="comment">  */</font>
00841 
00842   gc.flags[FLG_GNUEXTENSIONS] = TRUE;
00843 
00844   <font class="comment">/*</font>
00845 <font class="comment">  ** On by default for Win32, but not Unix (to support MS/VC++ error message format).</font>
00846 <font class="comment">  */</font>
00847 
00848 <font class="preprocessor"># ifdef WIN32</font>
00849 <font class="preprocessor"></font>  gc.flags[FLG_PARENFILEFORMAT] = TRUE;
00850 <font class="preprocessor"># endif</font>
00851 <font class="preprocessor"></font>}
00852 
00853 <font class="comment">/*</font>
00854 <font class="comment">** C is way-lame, and you can initialize an array to a constant except where</font>
00855 <font class="comment">** it is declared.  Hence, a macro is used to set the modeflags.</font>
00856 <font class="comment">*/</font>
00857 
00858 <font class="comment">/*@notfunction@*/</font>
<a name="l00859"></a><a class="code" href="context_c.html#a0">00859</a> <font class="preprocessor"># define SETFLAGS() \</font>
00860 <font class="preprocessor">  { int i = 0; while (modeflags[i] != INVALID_FLAG) { \</font>
00861 <font class="preprocessor">      if (!flagcode_isModeFlag (modeflags[i])) \</font>
00862 <font class="preprocessor">        { llbug (message ("not a mode flag: %s", \</font>
00863 <font class="preprocessor">                          flagcode_unparse (modeflags[i]))); } \</font>
00864 <font class="preprocessor">      else { context_setFlag (modeflags[i], TRUE); }  i++; }}</font>
00865 <font class="preprocessor"></font>
00866 <font class="keywordtype">void</font>
<a name="l00867"></a><a class="code" href="context_c.html#a63">00867</a> <a class="code" href="context_c.html#a63">context_setMode</a> (cstring s)<font class="keyword"></font>
00868 <font class="keyword"></font>{
00869   intSet setflags = <a class="code" href="intSet_c.html#a0">intSet_new</a> ();
00870   
00871   allFlagCodes (code)<font class="keyword"></font>
00872 <font class="keyword">    </font>{
00873       <font class="keywordflow">if</font> (<a class="code" href="flags_c.html#a18">flagcode_isModeFlag</a> (code))
00874         {
00875           <font class="keywordflow">if</font> (gc.setGlobally[code])
00876             {
00877               (<font class="keywordtype">void</font>) <a class="code" href="intSet_c.html#a2">intSet_insert</a> (setflags, (<font class="keywordtype">int</font>) code);
00878             }
00879         }
00880     } end_allFlagCodes;
00881   
00882   <font class="keywordflow">if</font> (!intSet_isEmpty (setflags))
00883     {
00884       cstring rflags = cstring_undefined;
00885       <font class="keywordtype">int</font> num = 0;
00886 
00887       intSet_elements (setflags, el)<font class="keyword"></font>
00888 <font class="keyword">        </font>{
00889           <font class="keywordflow">if</font> (cstring_isUndefined (rflags))
00890             {
00891               rflags = <a class="code" href="cstring_c.html#a9">cstring_copy</a> (flagcode_unparse ((flagcode) (el)));
00892             }
00893           <font class="keywordflow">else</font>
00894             {
00895               rflags = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q, %s"</font>, rflags, 
00896                                 flagcode_unparse ((flagcode) el));
00897             }
00898 
00899           num++;
00900           <font class="keywordflow">if</font> (num &gt; 4 &amp;&amp; intSet_size (setflags) &gt; 6)
00901             {
00902               rflags = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q, (%d others) ..."</font>, rflags, 
00903                                 intSet_size (setflags) - num);
00904               <font class="keywordflow">break</font>;
00905             }
00906         } end_intSet_elements ;
00907       
00908       voptgenerror (FLG_WARNFLAGS,
00909                     message (<font class="stringliteral">"Setting mode %s after setting mode flags will "</font>
00910                              <font class="stringliteral">"override set values of flags: %s"</font>,
00911                              s, rflags),
00912                     g_currentloc);
00913 
00914       <a class="code" href="cstring_c.html#a27">cstring_free</a> (rflags);
00915     }
00916 
00917   <a class="code" href="intSet_c.html#a6">intSet_free</a> (setflags);
00918 
00919   <a class="code" href="context_c.html#a60">context_resetModeFlags</a> ();
00920 
00921   <font class="keywordflow">if</font> (cstring_equalLit (s, <font class="stringliteral">"standard"</font>))
00922     {
00923       flagcode modeflags[] = 
00924         {
00925           FLG_ENUMINT, FLG_MACROMATCHNAME,
00926           FLG_MACROUNDEF, FLG_RELAXQUALS, 
00927           FLG_USEALLGLOBS, FLG_CHECKSTRICTGLOBALS,
00928           FLG_CHECKSTRICTGLOBALIAS,
00929           FLG_CHECKEDGLOBALIAS,
00930           FLG_CHECKMODGLOBALIAS,
00931           FLG_PREDBOOLOTHERS, FLG_PREDBOOLINT,
00932           FLG_PARAMUNUSED, FLG_VARUNUSED, FLG_FUNCUNUSED, 
00933           FLG_TYPEUNUSED,
00934           FLG_CONSTUNUSED, FLG_ENUMMEMUNUSED, FLG_FIELDUNUSED,
00935           FLG_PTRNUMCOMPARE, FLG_BOOLCOMPARE, FLG_MUTREP, 
00936           FLG_NOEFFECT, FLG_IMPTYPE,
00937           FLG_RETVALOTHER, FLG_RETVALBOOL, FLG_RETVALINT,
00938           FLG_SPECUNDEF, FLG_INCONDEFS, FLG_INCONDEFSLIB, 
00939           FLG_MATCHFIELDS,
00940           FLG_MACROPARAMS, FLG_MACROASSIGN, FLG_SEFPARAMS, 
00941           FLG_MACROSTMT, FLG_MACROPARENS, 
00942           FLG_MACROFCNDECL,
00943           FLG_MACROCONSTDECL,
00944           FLG_MACROREDEF, FLG_INFLOOPS, FLG_UNREACHABLE, 
00945           FLG_NORETURN, FLG_CASEBREAK, FLG_MISSCASE, FLG_USEDEF, 
00946           FLG_FIRSTCASE,
00947           FLG_NESTEDEXTERN, 
00948           FLG_NUMLITERAL,
00949           FLG_ZEROBOOL,
00950           <font class="comment">/* memchecks flags */</font>
00951           FLG_NULLDEREF, 
00952           FLG_NULLSTATE, FLG_NULLASSIGN,
00953           FLG_NULLPASS, FLG_NULLRET,        
00954 
00955           FLG_COMPDEF, FLG_COMPMEMPASS, FLG_UNIONDEF,
00956           FLG_RETSTACK,
00957 
00958           <font class="comment">/* memtrans flags */</font>
00959           FLG_EXPOSETRANS,
00960           FLG_OBSERVERTRANS,
00961           FLG_DEPENDENTTRANS,
00962           FLG_NEWREFTRANS,
00963           FLG_ONLYTRANS,
00964           FLG_OWNEDTRANS,
00965           FLG_FRESHTRANS,
00966           FLG_SHAREDTRANS,
00967           FLG_TEMPTRANS,
00968           FLG_KEPTTRANS,
00969           FLG_REFCOUNTTRANS,
00970           FLG_STATICTRANS,
00971           FLG_UNKNOWNTRANS,
00972           FLG_KEEPTRANS,
00973           FLG_IMMEDIATETRANS,
00974 
00975           FLG_EXPORTLOCAL,
00976 
00977           FLG_USERELEASED, FLG_ALIASUNIQUE, FLG_MAYALIASUNIQUE,
00978           FLG_MUSTFREE, FLG_MUSTDEFINE, FLG_GLOBSTATE, 
00979           FLG_COMPDESTROY, FLG_MUSTNOTALIAS,
00980           FLG_MEMIMPLICIT,
00981           FLG_BRANCHSTATE, 
00982 
00983           FLG_EVALORDER, FLG_SHADOW, FLG_READONLYSTRINGS,
00984           FLG_EXITARG,
00985           FLG_IMPCHECKEDSPECGLOBALS,
00986           FLG_MODGLOBS, FLG_WARNLINTCOMMENTS,
00987           FLG_IFEMPTY, FLG_REALCOMPARE,
00988           FLG_BOOLOPS, FLG_PTRNEGATE,
00989           FLG_SHIFTSIGNED,
00990           INVALID_FLAG } ;
00991 
00992       <a class="code" href="context_c.html#a0">SETFLAGS</a> ();
00993     }
00994   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_equalLit (s, <font class="stringliteral">"weak"</font>))
00995     {
00996       flagcode modeflags[] = 
00997         { 
00998           FLG_BOOLINT, FLG_CHARINT, FLG_FLOATDOUBLE,
00999           FLG_ENUMINT, FLG_RELAXQUALS, FLG_FORWARDDECL, 
01000           FLG_CHARINDEX, FLG_ABSTVOIDP, FLG_USEALLGLOBS, 
01001           FLG_CHARUNSIGNEDCHAR,
01002           FLG_PREDBOOLOTHERS, 
01003           FLG_VARUNUSED, FLG_FUNCUNUSED, 
01004           FLG_TYPEUNUSED,
01005           FLG_CHECKSTRICTGLOBALS, FLG_MACROMATCHNAME,
01006           FLG_RETVALOTHER,
01007           FLG_IFEMPTY, 
01008           FLG_RETSTACK, FLG_PTRNEGATE,
01009           FLG_LONGUNSIGNEDINTEGRAL,
01010           FLG_LONGUNSIGNEDUNSIGNEDINTEGRAL,
01011           FLG_NUMLITERAL,
01012           FLG_CHARINTLITERAL,
01013           FLG_ZEROBOOL,
01014           INVALID_FLAG 
01015           } ;
01016 
01017       <a class="code" href="context_c.html#a0">SETFLAGS</a> ();
01018     }
01019   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_equalLit (s, <font class="stringliteral">"checks"</font>))
01020     {
01021       flagcode modeflags[] = 
01022         { 
01023           FLG_EXPORTLOCAL, FLG_IMPTYPE,
01024           FLG_CHECKSTRICTGLOBALIAS,
01025           FLG_CHECKEDGLOBALIAS,
01026           FLG_CHECKMODGLOBALIAS,
01027           FLG_UNCHECKEDGLOBALIAS,
01028           FLG_EXITARG, FLG_PTRNUMCOMPARE, 
01029           FLG_BOOLCOMPARE, FLG_MACROUNDEF, 
01030           FLG_MUSTMOD, FLG_ALLGLOBALS,
01031           FLG_PREDBOOLOTHERS, FLG_PREDBOOLPTR, FLG_PREDBOOLINT,
01032           FLG_USEALLGLOBS, FLG_MUTREP, FLG_RETALIAS, 
01033           FLG_RETEXPOSE, FLG_ASSIGNEXPOSE, FLG_CASTEXPOSE,
01034           FLG_FUNCUNUSED, FLG_GLOBALSIMPMODIFIESNOTHING,
01035           FLG_TYPEUNUSED, FLG_FIELDUNUSED, FLG_PARAMUNUSED, FLG_VARUNUSED,
01036           FLG_CONSTUNUSED, FLG_ENUMMEMUNUSED,
01037           FLG_NOEFFECT, FLG_EXPORTHEADER, FLG_EXPORTHEADERVAR,
01038           FLG_RETVALOTHER, FLG_RETVALBOOL, FLG_RETVALINT,
01039           FLG_SPECUNDEF, FLG_IMPCHECKMODINTERNALS,
01040           FLG_DECLUNDEF, FLG_INCONDEFS, FLG_INCONDEFSLIB, 
01041           FLG_MATCHFIELDS, 
01042           FLG_MACROPARAMS,
01043           FLG_MACROASSIGN,
01044           FLG_DECLPARAMMATCH,
01045           FLG_FCNDEREF,
01046           FLG_FIRSTCASE,
01047           FLG_SEFPARAMS, FLG_SEFUNSPEC, FLG_MACROSTMT, FLG_MACROPARENS, 
01048           FLG_MACROCONSTDECL,
01049           FLG_MACROFCNDECL,
01050           FLG_MACROREDEF, 
01051           FLG_INFLOOPS, FLG_INFLOOPSUNCON,
01052           FLG_UNREACHABLE, 
01053           FLG_NORETURN, FLG_CASEBREAK, FLG_MISSCASE,
01054           FLG_EVALORDER, FLG_USEDEF, 
01055 
01056           FLG_NESTEDEXTERN, 
01057 
01058           <font class="comment">/* memchecks flags */</font>
01059 
01060           FLG_NULLSTATE, FLG_NULLDEREF, FLG_NULLASSIGN,
01061           FLG_NULLPASS, FLG_NULLRET,
01062 
01063           FLG_COMPDEF, FLG_COMPMEMPASS, FLG_UNIONDEF, FLG_RETSTACK,       
01064 
01065           <font class="comment">/* memtrans flags */</font>
01066           FLG_EXPOSETRANS,
01067           FLG_OBSERVERTRANS,
01068           FLG_DEPENDENTTRANS,
01069           FLG_NEWREFTRANS,
01070           FLG_ONLYTRANS,
01071           FLG_OWNEDTRANS,
01072           FLG_FRESHTRANS,
01073           FLG_SHAREDTRANS,
01074           FLG_TEMPTRANS,
01075           FLG_KEPTTRANS,
01076           FLG_REFCOUNTTRANS,
01077           FLG_STATICTRANS,
01078           FLG_UNKNOWNTRANS,
01079           FLG_STATICINITTRANS,
01080           FLG_UNKNOWNINITTRANS,
01081           FLG_KEEPTRANS,
01082           FLG_IMMEDIATETRANS,
01083           FLG_ONLYUNQGLOBALTRANS,
01084           FLG_USERELEASED, FLG_ALIASUNIQUE, FLG_MAYALIASUNIQUE,
01085           FLG_MUSTFREE, FLG_MUSTDEFINE, FLG_GLOBSTATE, 
01086           FLG_COMPDESTROY, FLG_MUSTNOTALIAS,
01087           FLG_MEMIMPLICIT,
01088           FLG_BRANCHSTATE, 
01089           FLG_NULLPOINTERARITH,
01090           FLG_SHADOW, FLG_DEPARRAYS,
01091           FLG_REDECL, FLG_READONLYSTRINGS, FLG_READONLYTRANS,
01092           FLG_LOOPLOOPBREAK, FLG_SWITCHLOOPBREAK, FLG_MODGLOBS,
01093           FLG_CHECKSTRICTGLOBALS, FLG_IMPCHECKEDSPECGLOBALS,
01094           FLG_MACROMATCHNAME, FLG_WARNLINTCOMMENTS,
01095           FLG_INCLUDENEST, FLG_ANSIRESERVED, FLG_CPPNAMES, 
01096           FLG_NOPARAMS, FLG_IFEMPTY, FLG_WHILEEMPTY, FLG_REALCOMPARE,
01097           FLG_BOOLOPS, FLG_SHIFTSIGNED,
01098           INVALID_FLAG } ;
01099 
01100       <a class="code" href="context_c.html#a0">SETFLAGS</a> ();
01101     }
01102   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_equalLit (s, <font class="stringliteral">"strict"</font>))
01103     {
01104       flagcode modeflags[] = 
01105         { 
01106           FLG_CHECKSTRICTGLOBALIAS,
01107           FLG_CHECKEDGLOBALIAS,
01108           FLG_CHECKMODGLOBALIAS,
01109           FLG_UNCHECKEDGLOBALIAS,
01110           FLG_MODFILESYSTEM,
01111           FLG_MACROMATCHNAME,
01112           FLG_MACROUNDEF, FLG_MUTREP, FLG_MUSTMOD,
01113           FLG_ALLGLOBALS, FLG_IMPTYPE,
01114           FLG_MODNOMODS, FLG_MODGLOBSUNSPEC, FLG_MODSTRICTGLOBSUNSPEC,
01115           FLG_GLOBUNSPEC, FLG_SIZEOFTYPE,
01116           FLG_EXPORTHEADER, FLG_EXPORTHEADERVAR,
01117           FLG_NOPARAMS, FLG_OLDSTYLE, FLG_EXITARG, 
01118           FLG_RETSTACK,
01119           FLG_FCNDEREF,
01120           FLG_ONLYUNQGLOBALTRANS,
01121           FLG_GLOBALSIMPMODIFIESNOTHING,
01122           FLG_PREDBOOLOTHERS, FLG_PREDBOOLPTR, FLG_PREDBOOLINT,
01123           FLG_INTERNALGLOBS, FLG_INTERNALGLOBSNOGLOBS,
01124           FLG_USEALLGLOBS, FLG_RETALIAS, 
01125           FLG_MODGLOBS, FLG_MODGLOBSUNSPEC, FLG_MODGLOBSUNCHECKED,
01126           FLG_RETEXPOSE, FLG_ASSIGNEXPOSE, FLG_CASTEXPOSE,
01127           FLG_NOEFFECTUNCON, FLG_EVALORDERUNCON,
01128           FLG_FUNCUNUSED,
01129           FLG_EXPORTITER, FLG_EXPORTCONST,
01130           FLG_TYPEUNUSED, FLG_FIELDUNUSED, FLG_PARAMUNUSED, FLG_TOPUNUSED,
01131           FLG_CONSTUNUSED, FLG_ENUMMEMUNUSED,
01132           FLG_VARUNUSED, 
01133           FLG_NULLPOINTERARITH, FLG_POINTERARITH, 
01134           FLG_PTRNUMCOMPARE, 
01135           FLG_BOOLCOMPARE, FLG_NOEFFECT, 
01136           FLG_RETVALINT, FLG_RETVALBOOL, FLG_RETVALOTHER, 
01137           FLG_ANSIRESERVED, FLG_ANSIRESERVEDLOCAL, FLG_CPPNAMES,
01138           FLG_RETVALBOOL, FLG_RETVALINT, FLG_SPECUNDEF, 
01139           FLG_DECLUNDEF, FLG_STRICTOPS, FLG_INCONDEFS, 
01140           FLG_INCONDEFSLIB, FLG_MATCHFIELDS, FLG_EXPORTMACRO, FLG_EXPORTVAR, 
01141           FLG_EXPORTFCN, FLG_EXPORTTYPE, FLG_EXPORTLOCAL, FLG_MACROPARAMS, 
01142           FLG_MACROASSIGN,
01143           FLG_SEFPARAMS, FLG_SEFUNSPEC, FLG_MACROSTMT, FLG_MACROPARENS, 
01144           FLG_MACROFCNDECL,
01145           FLG_MACROCONSTDECL,
01146           FLG_MACROREDEF, FLG_MACROEMPTY,
01147           FLG_INFLOOPS, FLG_INFLOOPSUNCON,
01148           FLG_UNREACHABLE, 
01149           FLG_NORETURN, FLG_CASEBREAK, FLG_MISSCASE, FLG_USEDEF,
01150           FLG_EVALORDER,
01151           FLG_MODUNCON, FLG_MODUNCONNOMODS, FLG_MODINTERNALSTRICT,
01152           FLG_MODOBSERVERUNCON,
01153 
01154           FLG_NESTEDEXTERN, 
01155           FLG_FIRSTCASE,
01156 
01157           <font class="comment">/* memchecks flags */</font>
01158           FLG_NULLSTATE, FLG_NULLDEREF, FLG_NULLASSIGN,
01159           FLG_NULLPASS, FLG_NULLRET,
01160 
01161           FLG_COMPDEF, FLG_COMPMEMPASS, FLG_UNIONDEF,
01162 
01163           <font class="comment">/* memtrans flags */</font>
01164           FLG_EXPOSETRANS,
01165           FLG_OBSERVERTRANS,
01166           FLG_DEPENDENTTRANS,
01167           FLG_NEWREFTRANS,
01168           FLG_ONLYTRANS,
01169           FLG_OWNEDTRANS,
01170           FLG_FRESHTRANS,
01171           FLG_SHAREDTRANS,
01172           FLG_TEMPTRANS,
01173           FLG_KEPTTRANS,
01174           FLG_REFCOUNTTRANS,
01175           FLG_STATICTRANS,
01176           FLG_UNKNOWNTRANS,
01177           FLG_KEEPTRANS,
01178           FLG_IMMEDIATETRANS,
01179           FLG_STATICINITTRANS,
01180           FLG_UNKNOWNINITTRANS,
01181 
01182           FLG_USERELEASED, FLG_ALIASUNIQUE, FLG_MAYALIASUNIQUE,
01183           FLG_MUSTFREE, FLG_MUSTDEFINE, FLG_GLOBSTATE, 
01184           FLG_COMPDESTROY, FLG_MUSTNOTALIAS,
01185           FLG_MEMIMPLICIT,
01186           FLG_BRANCHSTATE, 
01187 
01188           FLG_DECLPARAMNAME, FLG_DECLPARAMMATCH,
01189 
01190           FLG_SHADOW, FLG_DEPARRAYS, 
01191           FLG_STRICTDESTROY, FLG_STRICTUSERELEASED, FLG_STRICTBRANCHSTATE,
01192           FLG_REDECL, FLG_READONLYSTRINGS, FLG_READONLYTRANS,
01193           FLG_LOOPLOOPBREAK, FLG_LOOPSWITCHBREAK, FLG_SWITCHLOOPBREAK,
01194           FLG_SWITCHSWITCHBREAK, FLG_LOOPLOOPCONTINUE,
01195           FLG_CHECKSTRICTGLOBALS, FLG_IMPCHECKEDSPECGLOBALS,
01196           FLG_ALLGLOBALS, FLG_IMPCHECKEDSTRICTGLOBALS,
01197           FLG_IMPCHECKEDSTRICTSTATICS,
01198           FLG_IMPCHECKEDSTRICTSPECGLOBALS,
01199           FLG_IMPCHECKMODINTERNALS,
01200           FLG_WARNMISSINGGLOBALS, FLG_WARNMISSINGGLOBALSNOGLOBS,
01201           FLG_WARNLINTCOMMENTS, FLG_ANSIRESERVEDLOCAL,
01202           FLG_INCLUDENEST, FLG_STRINGLITERALLEN,
01203           FLG_NUMSTRUCTFIELDS, FLG_NUMENUMMEMBERS,
01204           FLG_CONTROLNESTDEPTH,
01205           FLG_FORBLOCK, FLG_WHILEBLOCK,
01206           FLG_FOREMPTY, FLG_WHILEEMPTY,
01207           FLG_IFEMPTY, FLG_IFBLOCK,
01208           FLG_ELSEIFCOMPLETE,
01209           FLG_REALCOMPARE, FLG_BOOLOPS,
01210           FLG_SYSTEMDIRERRORS, FLG_UNUSEDSPECIAL,
01211 
01212           FLG_SHIFTSIGNED, FLG_BITWISEOPS,
01213           INVALID_FLAG } ;
01214 
01215       <a class="code" href="context_c.html#a0">SETFLAGS</a> ();
01216     }
01217   <font class="keywordflow">else</font>
01218     {
01219       llcontbug (message (<font class="stringliteral">"context_setMode: bad mode: %s"</font>, s));
01220      }
01221 }
01222 
01223 <font class="keywordtype">bool</font>
<a name="l01224"></a><a class="code" href="context_c.html#a64">01224</a> <a class="code" href="context_c.html#a64">context_isSpecialFile</a> (cstring fname)<font class="keyword"></font>
01225 <font class="keyword"></font>{
01226   <font class="keywordtype">char</font> *ext = <a class="code" href="general_c.html#a41">filenameExtension</a> (cstring_toCharsSafe (fname));
01227   
01228   <font class="keywordflow">return</font> (<a class="code" href="general_c.html#a40">mstring_equal</a> (ext, <font class="stringliteral">".y"</font>) 
01229           || <a class="code" href="general_c.html#a40">mstring_equal</a> (ext, <font class="stringliteral">".l"</font>)
01230           || cstring_equalLit (fname, <font class="stringliteral">"lex.yy.c"</font>));
01231 }
01232 
01233 <font class="keywordtype">bool</font>
<a name="l01234"></a><a class="code" href="context_c.html#a65">01234</a> <a class="code" href="context_c.html#a65">context_isSystemDir</a> (cstring dir)<font class="keyword"></font>
01235 <font class="keyword"></font>{
01236   cstring sysDirs = context_exposeString (FLG_SYSTEMDIRS);
01237   <font class="keywordtype">char</font> *thisdir = <a class="code" href="cstring_c.html#a29">cstring_toCharsSafe</a> (sysDirs);
01238   <font class="keywordtype">char</font> *nextdir = strchr (thisdir, SEPCHAR);
01239 
01240   <font class="keywordflow">if</font> (nextdir != NULL)
01241     {
01242       *nextdir = <font class="charliteral">'\0'</font>;
01243       nextdir += 1;
01244     }
01245 
01246   <font class="keywordflow">while</font> (thisdir != NULL)
01247     {
01248       DPRINTF ((<font class="stringliteral">"Test: %s / %s"</font>, dir, thisdir));
01249 
01250       <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a23">cstring_equalCanonicalPrefix</a> (dir, thisdir))
01251         {
01252           <font class="keywordflow">if</font> (nextdir != NULL)
01253             {
01254               *(nextdir - 1) = SEPCHAR;
01255             }
01256           
01257           <font class="keywordflow">return</font> TRUE;
01258         }
01259 
01260       <font class="keywordflow">if</font> (nextdir != NULL)
01261         {
01262           *(nextdir - 1) = SEPCHAR;
01263         }
01264 
01265       <font class="keywordflow">if</font> (nextdir != NULL)
01266         {
01267           thisdir = nextdir;
01268           nextdir = strchr (thisdir, SEPCHAR);
01269           
01270           <font class="keywordflow">if</font> (nextdir != NULL)
01271             {
01272               *nextdir = <font class="charliteral">'\0'</font>;
01273               nextdir += 1;
01274             } 
01275         }
01276       <font class="keywordflow">else</font>
01277         {
01278           <font class="keywordflow">break</font>;
01279         }
01280     } 
01281 
01282   DPRINTF ((<font class="stringliteral">"Returns FALSE"</font>));
01283   <font class="keywordflow">return</font> FALSE;
01284 }
01285 
01286 <font class="keywordtype">void</font>
<a name="l01287"></a><a class="code" href="context_c.html#a66">01287</a> <a class="code" href="context_c.html#a66">context_addFileAccessType</a> (typeId t)<font class="keyword"></font>
01288 <font class="keyword"></font>{
01289   cstring base;
01290 
01291   <font class="keywordflow">if</font> (gc.kind == CX_FUNCTION || gc.kind == CX_MACROFCN 
01292       || gc.kind == CX_UNKNOWNMACRO)
01293     {
01294       gc.acct = <a class="code" href="typeIdSet_c.html#a19">typeIdSet_insert</a> (gc.acct, t);
01295     }
01296   
01297   gc.facct = <a class="code" href="typeIdSet_c.html#a19">typeIdSet_insert</a> (gc.facct, t);
01298   
01299   base = <a class="code" href="fileloc_c.html#a10">fileloc_getBase</a> (g_currentloc);
01300   insertModuleAccess (base, t);
01301   DPRINTF ((<font class="stringliteral">"Add file access: %s / %s"</font>, typeIdSet_unparse (gc.facct),
01302             <a class="code" href="typeIdSet_c.html#a21">typeIdSet_unparse</a> (gc.acct)));
01303 }
01304 
01305 <font class="keywordtype">void</font>
<a name="l01306"></a><a class="code" href="context_c.html#a67">01306</a> <a class="code" href="context_c.html#a67">context_removeFileAccessType</a> (typeId t)<font class="keyword"></font>
01307 <font class="keyword"></font>{
01308   <font class="keywordflow">if</font> (gc.kind == CX_FUNCTION || gc.kind == CX_MACROFCN 
01309       || gc.kind == CX_UNKNOWNMACRO)
01310     {
01311       gc.acct = <a class="code" href="typeIdSet_c.html#a20">typeIdSet_removeFresh</a> (gc.acct, t);
01312     }
01313   
01314   gc.facct = <a class="code" href="typeIdSet_c.html#a20">typeIdSet_removeFresh</a> (gc.facct, t);
01315   gc.nacct = <a class="code" href="typeIdSet_c.html#a19">typeIdSet_insert</a> (gc.nacct, t);
01316 }
01317 
<a name="l01318"></a><a class="code" href="context_c.html#a68">01318</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a68">context_enterFunctionDecl</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01319 <font class="keyword"></font>{
01320   llassert (gc.kind == CX_GLOBAL);
01321   gc.kind = CX_FCNDECL;
01322 }
01323 
<a name="l01324"></a><a class="code" href="context_c.html#a69">01324</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a69">context_exitFunctionDecl</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01325 <font class="keyword"></font>{
01326   gc.kind = CX_GLOBAL;
01327 }
01328 
<a name="l01329"></a><a class="code" href="context_c.html#a70">01329</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a70">context_inFunctionDecl</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01330 <font class="keyword"></font>{
01331   <font class="keywordflow">return</font> (gc.kind == CX_FCNDECL);
01332 }
01333 
01334 <font class="keywordtype">void</font>
<a name="l01335"></a><a class="code" href="context_c.html#a71">01335</a> <a class="code" href="context_c.html#a71">context_enterMacro</a> (<font class="comment">/*@observer@*/</font> uentry e)<font class="keyword"></font>
01336 <font class="keyword"></font>{
01337   <a class="code" href="context_c.html#a98">context_enterFunction</a> (e);
01338   gc.kind = CX_MACROFCN;
01339 }
01340 
01341 <font class="keywordtype">void</font>
<a name="l01342"></a><a class="code" href="context_c.html#a72">01342</a> <a class="code" href="context_c.html#a72">context_enterUnknownMacro</a> (<font class="comment">/*@dependent@*/</font> uentry e)<font class="keyword"></font>
01343 <font class="keyword"></font>{
01344   llassert (uentry_isFunction (e));
01345   <a class="code" href="context_c.html#a98">context_enterFunction</a> (e);
01346   gc.kind = CX_UNKNOWNMACRO;
01347 }
01348 
<a name="l01349"></a><a class="code" href="context_c.html#a73">01349</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a73">context_enterAndClause</a> (exprNode e)<font class="keyword"></font>
01350 <font class="keyword"></font>{
01351   
01352   <a class="code" href="usymtab_c.html#a88">usymtab_trueBranch</a> (guardSet_copy (exprNode_getGuards (e)));
01353   pushClause (ANDCLAUSE);
01354 }
01355 
<a name="l01356"></a><a class="code" href="context_c.html#a74">01356</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a74">context_enterOrClause</a> (exprNode e)<font class="keyword"></font>
01357 <font class="keyword"></font>{
01358   <a class="code" href="usymtab_c.html#a88">usymtab_trueBranch</a> (guardSet_invert (exprNode_getGuards (e)));
01359   pushClause (ORCLAUSE);
01360 }
01361 
<a name="l01362"></a><a class="code" href="context_c.html#a75">01362</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a75">context_inDeepLoop</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01363 <font class="keyword"></font>{
01364   <font class="keywordtype">bool</font> inLoop = FALSE;
01365 
01366   clauseStack_elements (gc.clauses, el)<font class="keyword"></font>
01367 <font class="keyword">    </font>{
01368       <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a5">clause_isLoop</a> (el))
01369         {
01370           <font class="keywordflow">if</font> (inLoop)
01371             {
01372               <font class="keywordflow">return</font> TRUE;
01373             }
01374 
01375           inLoop = TRUE;
01376         }
01377     } end_clauseStack_elements;
01378 
01379   <font class="keywordflow">return</font> FALSE;
01380 }
01381 
<a name="l01382"></a><a class="code" href="context_c.html#a76">01382</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a76">context_inDeepSwitch</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01383 <font class="keyword"></font>{
01384   <font class="keywordtype">bool</font> inLoop = FALSE;
01385 
01386   clauseStack_elements (gc.clauses, el)<font class="keyword"></font>
01387 <font class="keyword">    </font>{
01388       <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a7">clause_isSwitch</a> (el))
01389         {
01390           <font class="keywordflow">if</font> (inLoop)
01391             {
01392               <font class="keywordflow">return</font> TRUE;
01393             }
01394 
01395           inLoop = TRUE;
01396         }
01397     } end_clauseStack_elements;
01398 
01399   <font class="keywordflow">return</font> FALSE;
01400 }
01401 
<a name="l01402"></a><a class="code" href="context_c.html#a77">01402</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a77">context_inDeepLoopSwitch</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01403 <font class="keyword"></font>{
01404   <font class="keywordtype">bool</font> inLoop = FALSE;
01405 
01406   clauseStack_elements (gc.clauses, el)<font class="keyword"></font>
01407 <font class="keyword">    </font>{
01408       <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a4">clause_isBreakable</a> (el))
01409         {
01410           <font class="keywordflow">if</font> (inLoop)
01411             {
01412               <font class="keywordflow">return</font> TRUE;
01413             }
01414 
01415           inLoop = TRUE;
01416         }
01417     } end_clauseStack_elements;
01418 
01419   <font class="keywordflow">return</font> FALSE;
01420 }
01421 
<a name="l01422"></a><a class="code" href="context_c.html#a78">01422</a> clause <a class="code" href="context_c.html#a78">context_breakClause</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01423 <font class="keyword"></font>{
01424   clauseStack_elements (gc.clauses, el)<font class="keyword"></font>
01425 <font class="keyword">    </font>{
01426       <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a7">clause_isSwitch</a> (el))
01427         {
01428           <font class="keywordflow">return</font> el;
01429         }
01430       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a5">clause_isLoop</a> (el))
01431         {
01432           <font class="keywordflow">return</font> el;
01433         }
01434       <font class="keywordflow">else</font>
01435         {
01436           ;
01437         }
01438     } end_clauseStack_elements;
01439 
01440   <font class="keywordflow">return</font> NOCLAUSE;
01441 }
01442 
<a name="l01443"></a><a class="code" href="context_c.html#a79">01443</a> clause <a class="code" href="context_c.html#a79">context_nextBreakClause</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01444 <font class="keyword"></font>{
01445   <font class="keywordtype">bool</font> hasOne = FALSE;
01446 
01447   clauseStack_elements (gc.clauses, el)<font class="keyword"></font>
01448 <font class="keyword">    </font>{
01449       <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a4">clause_isBreakable</a> (el))
01450         {
01451           <font class="keywordflow">if</font> (hasOne)
01452             {
01453               <font class="keywordflow">return</font> el;
01454             }
01455           <font class="keywordflow">else</font>
01456             {
01457               hasOne = TRUE;
01458             }
01459         }
01460     } end_clauseStack_elements;
01461 
01462   <font class="keywordflow">return</font> NOCLAUSE;
01463 }
01464   
<a name="l01465"></a><a class="code" href="context_c.html#a80">01465</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a80">context_inConditional</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01466 <font class="keyword"></font>{
01467   clauseStack_elements (gc.clauses, el)<font class="keyword"></font>
01468 <font class="keyword">    </font>{
01469       <font class="comment">/*</font>
01470 <font class="comment">      ** Should also include TRUECLAUSE and FALSECLAUSE, but need</font>
01471 <font class="comment">      ** to distinguish if from ? for this</font>
01472 <font class="comment">      */</font>
01473 
01474       <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a4">clause_isBreakable</a> (el) &amp;&amp; (el != DOWHILECLAUSE))
01475         {
01476           <font class="keywordflow">return</font> TRUE;
01477         }
01478     } end_clauseStack_elements;
01479 
01480   <font class="keywordflow">return</font> FALSE;
01481 }
01482 
<a name="l01483"></a><a class="code" href="context_c.html#a81">01483</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a81">context_exitAndClause</a> (exprNode pred, exprNode tbranch)<font class="keyword"></font>
01484 <font class="keyword"></font>{
01485   context_setJustPopped ();
01486   
01487   llassert (gc.inclause == ANDCLAUSE);
01488   
01489   <a class="code" href="usymtab_c.html#a94">usymtab_popAndBranch</a> (pred, tbranch);
01490   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
01491   gc.inclause = topClause (gc.clauses);
01492 }
01493 
<a name="l01494"></a><a class="code" href="context_c.html#a82">01494</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a82">context_exitOrClause</a> (exprNode pred, exprNode tbranch)<font class="keyword"></font>
01495 <font class="keyword"></font>{
01496   context_setJustPopped ();
01497   
01498   llassert (gc.inclause == ORCLAUSE);
01499   
01500   <a class="code" href="usymtab_c.html#a92">usymtab_popOrBranch</a> (pred, tbranch);
01501   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
01502   gc.inclause = topClause (gc.clauses);
01503 }
01504 
01505 <font class="keyword">static</font> <font class="keywordtype">void</font> context_enterCondClauseAux (clause cl)
01506      <font class="comment">/*@modifies gc@*/</font>
01507 {
01508   pushClause (cl);
01509 }
01510 
01511 <font class="keyword">static</font> <font class="keywordtype">void</font> context_enterTrueAux (exprNode e, clause cl)
01512    <font class="comment">/*@modifies gc@*/</font>
01513 {
01514   <a class="code" href="usymtab_c.html#a88">usymtab_trueBranch</a> (guardSet_copy (exprNode_getGuards (e)));
01515   pushClause (cl);
01516 }
01517 
<a name="l01518"></a><a class="code" href="context_c.html#a85">01518</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a85">context_enterIterClause</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01519 <font class="keyword"></font>{
01520   context_enterTrueAux (exprNode_undefined, ITERCLAUSE);
01521 }
01522 
<a name="l01523"></a><a class="code" href="context_c.html#a86">01523</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a86">context_enterDoWhileClause</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01524 <font class="keyword"></font>{
01525   pushClause (DOWHILECLAUSE);
01526 }
01527 
<a name="l01528"></a><a class="code" href="context_c.html#a87">01528</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a87">context_enterWhileClause</a> (exprNode e)<font class="keyword"></font>
01529 <font class="keyword"></font>{
01530   context_enterTrueAux (e, WHILECLAUSE);
01531 }
01532 
<a name="l01533"></a><a class="code" href="context_c.html#a88">01533</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a88">context_enterForClause</a> (exprNode e)<font class="keyword"></font>
01534 <font class="keyword"></font>{
01535   context_enterTrueAux (e, FORCLAUSE);
01536 }
01537 
<a name="l01538"></a><a class="code" href="context_c.html#a89">01538</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a89">context_enterTrueClause</a> (exprNode e)<font class="keyword"></font>
01539 <font class="keyword"></font>{
01540   context_enterTrueAux (e, TRUECLAUSE);
01541 }
01542 
<a name="l01543"></a><a class="code" href="context_c.html#a90">01543</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a90">context_enterSwitch</a> (exprNode e)<font class="keyword"></font>
01544 <font class="keyword"></font>{
01545   
01546   <a class="code" href="usymtab_c.html#a87">usymtab_switchBranch</a> (e);
01547   context_enterCondClauseAux (SWITCHCLAUSE);
01548 }
01549 
<a name="l01550"></a><a class="code" href="context_c.html#a91">01550</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a91">context_exitSwitch</a> (exprNode e, <font class="keywordtype">bool</font> allpaths)<font class="keyword"></font>
01551 <font class="keyword"></font>{
01552     <a class="code" href="usymtab_c.html#a95">usymtab_exitSwitch</a> (e, allpaths);
01553   
01554   <font class="keywordflow">while</font> (<a class="code" href="clause_c.html#a8">clause_isCase</a> (clauseStack_top (gc.clauses)))
01555     {
01556       <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
01557     }
01558   
01559   context_exitClauseSimp ();
01560 }
01561 
<a name="l01562"></a><a class="code" href="context_c.html#a92">01562</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a92">context_enterCaseClause</a> (exprNode e)<font class="keyword"></font>
01563 <font class="keyword"></font>{
01564   <font class="keywordtype">bool</font> branch = FALSE;
01565  
01566   DPRINTF ((<font class="stringliteral">"Enter case clause!"</font>));
01567 
01568   branch = <a class="code" href="usymtab_c.html#a93">usymtab_newCase</a> (exprNode_undefined, e);
01569   
01570   <font class="keywordflow">if</font> (branch)
01571     {
01572       context_enterCondClauseAux (CASECLAUSE);
01573     }
01574 }
01575 
01576 <font class="keyword">static</font> <font class="keywordtype">void</font> context_enterFalseClauseAux (exprNode e, clause cl)
01577      <font class="comment">/*@modifies gc@*/</font>
01578 {
01579   <a class="code" href="usymtab_c.html#a99">usymtab_altBranch</a> (guardSet_invert (exprNode_getGuards (e)));
01580   gc.inclause = cl;
01581   <a class="code" href="clauseStack_c.html#a5">clauseStack_switchTop</a> (gc.clauses, cl);
01582 }
01583 
<a name="l01584"></a><a class="code" href="context_c.html#a94">01584</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a94">context_enterFalseClause</a> (exprNode e)<font class="keyword"></font>
01585 <font class="keyword"></font>{
01586   
01587   context_enterFalseClauseAux (e, FALSECLAUSE);
01588 }
01589 
01590 <font class="keywordtype">void</font>
<a name="l01591"></a><a class="code" href="context_c.html#a95">01591</a> <a class="code" href="context_c.html#a95">context_enterConstantMacro</a> (<font class="comment">/*@exposed@*/</font> <font class="comment">/*@dependent@*/</font> uentry e)<font class="keyword"></font>
01592 <font class="keyword"></font>{
01593   gc.kind = CX_MACROCONST;
01594   gc.cont.fcn = e;
01595   gc.showfunction = <a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_SHOWFUNC);
01596 
01597   gc.acct = <a class="code" href="typeIdSet_c.html#a23">typeIdSet_subtract</a> (typeIdSet_union (gc.facct, uentry_accessType (e)), 
01598                                 gc.nacct);
01599 
01600   
01601   <a class="code" href="usymtab_c.html#a84">usymtab_enterScope</a> ();
01602   <a class="code" href="sRef_c.html#a85">sRef_enterFunctionScope</a> ();
01603 
01604   gc.globs = globSet_undefined;
01605   <a class="code" href="globSet_c.html#a1">globSet_clear</a> (gc.globs_used);
01606   gc.mods = sRefSet_undefined;
01607 }
01608 
<a name="l01609"></a><a class="code" href="context_c.html#a96">01609</a> uentry <a class="code" href="context_c.html#a96">context_getHeader</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01610 <font class="keyword"></font>{
01611   <font class="keywordflow">if</font> (!(<a class="code" href="context_c.html#a175">context_inFunctionLike</a> () || (gc.kind == CX_MACROCONST)))
01612     {
01613       <a class="code" href="llerror_c.html#a43">llfatalbug</a> (message (<font class="stringliteral">"context_getHeader: bad call: %q"</font>,
01614                            context_unparse ()));
01615     }
01616 
01617   <font class="keywordflow">return</font> (gc.cont.fcn);
01618 }
01619 
01620 <font class="keywordtype">void</font>
<a name="l01621"></a><a class="code" href="context_c.html#a97">01621</a> <a class="code" href="context_c.html#a97">context_setFunctionDefined</a> (fileloc loc)<font class="keyword"></font>
01622 <font class="keyword"></font>{
01623   <font class="keywordflow">switch</font> (gc.kind)
01624     {
01625     <font class="keywordflow">case</font> CX_UNKNOWNMACRO:
01626     <font class="keywordflow">case</font> CX_FUNCTION:
01627     <font class="keywordflow">case</font> CX_MACROFCN:
01628       <a class="code" href="uentry_c.html#a204">uentry_setFunctionDefined</a> (gc.cont.fcn, loc);
01629       <font class="keywordflow">break</font>;
01630     <font class="keywordflow">default</font>:
01631       <font class="comment">/* (not a bug because of parse errors) */</font>
01632       <font class="keywordflow">break</font>;
01633     }
01634 }
01635 
01636 <font class="keywordtype">void</font>
<a name="l01637"></a><a class="code" href="context_c.html#a98">01637</a> <a class="code" href="context_c.html#a98">context_enterFunction</a> (<font class="comment">/*@exposed@*/</font> uentry e)<font class="keyword"></font>
01638 <font class="keyword"></font>{
01639   gc.kind = CX_FUNCTION;
01640   gc.cont.fcn = e;
01641 
01642   <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a157">uentry_hasAccessType</a> (e))
01643     {
01644       gc.acct = <a class="code" href="typeIdSet_c.html#a23">typeIdSet_subtract</a> (typeIdSet_union (gc.facct, uentry_accessType (e)), 
01645                                     gc.nacct);
01646     }
01647   <font class="keywordflow">else</font>
01648     {
01649       gc.acct = gc.facct;
01650     }
01651 
01652   DPRINTF ((<font class="stringliteral">"Enter function: %s / %s"</font>, uentry_unparse (e), 
01653             <a class="code" href="typeIdSet_c.html#a21">typeIdSet_unparse</a> (gc.acct)));
01654 
01655   gc.showfunction = <a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_SHOWFUNC);
01656   
01657   gc.globs = <a class="code" href="uentry_c.html#a189">uentry_getGlobs</a> (e);
01658   <a class="code" href="globSet_c.html#a1">globSet_clear</a> (gc.globs_used);
01659   gc.mods = <a class="code" href="uentry_c.html#a190">uentry_getMods</a> (e);
01660 
01661   <a class="code" href="usymtab_c.html#a85">usymtab_enterFunctionScope</a> (e);
01662   <a class="code" href="sRef_c.html#a85">sRef_enterFunctionScope</a> ();
01663 }
01664 
01665 <font class="keyword">static</font> <font class="keywordtype">bool</font> context_checkStrictGlobals (<font class="keywordtype">void</font>)<font class="keyword"></font>
01666 <font class="keyword"></font>{
01667   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_CHECKSTRICTGLOBALS));
01668 }
01669 
01670 <font class="keyword">static</font> <font class="keywordtype">bool</font> context_hasGlobs (<font class="keywordtype">void</font>)<font class="keyword"></font>
01671 <font class="keyword"></font>{
01672   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a175">context_inFunctionLike</a> ())
01673     {
01674       <font class="keywordflow">return</font> (<a class="code" href="uentry_c.html#a142">uentry_hasGlobs</a> (gc.cont.fcn));
01675     }
01676   <font class="keywordflow">else</font>
01677     {
01678       <font class="keywordflow">return</font> (FALSE);
01679     }
01680 }
01681 
01682 <font class="keyword">static</font> <font class="keywordtype">bool</font> context_checkCheckedGlobals (<font class="keywordtype">void</font>)<font class="keyword"></font>
01683 <font class="keyword"></font>{
01684   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_GLOBALS)
01685           &amp;&amp; (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_GLOBUNSPEC)
01686               || context_hasGlobs ()));
01687 }
01688 
01689 <font class="keyword">static</font> <font class="keywordtype">bool</font> context_checkUnknownGlobals (<font class="keywordtype">void</font>)<font class="keyword"></font>
01690 <font class="keyword"></font>{
01691   <font class="comment">/* should be uentry_hasGlobs ? */</font>
01692 
01693   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_ALLGLOBALS)
01694           &amp;&amp; (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_GLOBUNSPEC)
01695               || context_hasGlobs ()));
01696 }      
01697 
01698 <font class="keyword">static</font> <font class="keywordtype">bool</font> context_checkUncheckedGlobals (<font class="keywordtype">void</font>)<font class="keyword"></font>
01699 <font class="keyword"></font>{
01700   <font class="keywordflow">return</font> (FALSE);
01701 }      
01702 
01703 <font class="keywordtype">bool</font> 
<a name="l01704"></a><a class="code" href="context_c.html#a104">01704</a> <a class="code" href="context_c.html#a104">context_checkExport</a> (uentry e)<font class="keyword"></font>
01705 <font class="keyword"></font>{
01706   <font class="keywordflow">if</font> (!gc.anyExports) <font class="keywordflow">return</font> FALSE;
01707 
01708   <font class="keywordflow">if</font> (uentry_isFunction (e)
01709       || (<a class="code" href="uentry_c.html#a159">uentry_isVariable</a> (e) &amp;&amp; <a class="code" href="ctype_c.html#a49">ctype_isFunction</a> (uentry_getType (e))))
01710     {
01711       <font class="keywordflow">return</font> <a class="code" href="context_c.html#a188">context_maybeSet</a> (FLG_EXPORTFCN);
01712     }
01713   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a171">uentry_isExpandedMacro</a> (e))
01714     {
01715       <font class="keywordflow">return</font> <a class="code" href="context_c.html#a188">context_maybeSet</a> (FLG_EXPORTMACRO);
01716     }
01717   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a159">uentry_isVariable</a> (e))
01718     {
01719       <font class="keywordflow">return</font> <a class="code" href="context_c.html#a188">context_maybeSet</a> (FLG_EXPORTVAR);
01720     }
01721   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (uentry_isEitherConstant (e))
01722     {
01723       <font class="keywordflow">return</font> <a class="code" href="context_c.html#a188">context_maybeSet</a> (FLG_EXPORTCONST);
01724     }
01725   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a184">uentry_isIter</a> (e) || <a class="code" href="uentry_c.html#a185">uentry_isEndIter</a> (e))
01726     {
01727       <font class="keywordflow">return</font> <a class="code" href="context_c.html#a188">context_maybeSet</a> (FLG_EXPORTITER);
01728     }
01729   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a163">uentry_isDatatype</a> (e))
01730     {
01731       <font class="keywordflow">return</font> <a class="code" href="context_c.html#a188">context_maybeSet</a> (FLG_EXPORTTYPE);
01732     }
01733   <font class="keywordflow">else</font>
01734     {
01735       BADEXIT;
01736     }
01737 }
01738               
01739 <font class="keywordtype">bool</font>
<a name="l01740"></a><a class="code" href="context_c.html#a105">01740</a> <a class="code" href="context_c.html#a105">context_checkGlobUse</a> (uentry glob)<font class="keyword"></font>
01741 <font class="keyword"></font>{
01742   
01743   <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a93">uentry_isCheckedStrict</a> (glob))
01744     {
01745       <font class="keywordflow">return</font> context_checkStrictGlobals ();
01746     }
01747   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a91">uentry_isChecked</a> (glob))
01748     {
01749       <font class="keywordflow">return</font> context_checkCheckedGlobals ();
01750     }
01751   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a88">uentry_isCheckedUnknown</a> (glob) || <a class="code" href="uentry_c.html#a89">uentry_isCheckMod</a> (glob))
01752     {
01753       <font class="keywordflow">return</font> context_checkUnknownGlobals ();
01754     }
01755   <font class="keywordflow">else</font> 
01756     {
01757       llassert (uentry_isUnchecked (glob));
01758 
01759       <font class="keywordflow">return</font> context_checkUncheckedGlobals ();
01760     }
01761 }
01762 
01763 <font class="keywordtype">bool</font>
<a name="l01764"></a><a class="code" href="context_c.html#a106">01764</a> <a class="code" href="context_c.html#a106">context_checkAliasGlob</a> (uentry glob)<font class="keyword"></font>
01765 <font class="keyword"></font>{
01766   <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a93">uentry_isCheckedStrict</a> (glob))
01767     {
01768       <font class="keywordflow">return</font> gc.flags[FLG_CHECKSTRICTGLOBALIAS];
01769     }
01770   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a91">uentry_isChecked</a> (glob))
01771     {
01772       <font class="keywordflow">return</font> gc.flags[FLG_CHECKEDGLOBALIAS];
01773     }
01774   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a89">uentry_isCheckMod</a> (glob))
01775     {
01776       <font class="keywordflow">return</font> gc.flags[FLG_CHECKMODGLOBALIAS];
01777     }
01778   <font class="keywordflow">else</font> 
01779     {
01780       llassert (uentry_isUnchecked (glob) || <a class="code" href="uentry_c.html#a88">uentry_isCheckedUnknown</a> (glob));
01781 
01782       <font class="keywordflow">return</font> gc.flags[FLG_UNCHECKEDGLOBALIAS];
01783     }
01784 }
01785 
<a name="l01786"></a><a class="code" href="context_c.html#a107">01786</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a107">context_checkInternalUse</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01787 <font class="keyword"></font>{
01788   <font class="keywordflow">if</font> (context_hasGlobs ())
01789     {
01790       <font class="keywordflow">return</font> (gc.flags[FLG_INTERNALGLOBS]);
01791     }
01792   <font class="keywordflow">else</font>
01793     {
01794       <font class="keywordflow">return</font> (gc.flags[FLG_INTERNALGLOBSNOGLOBS]);
01795     }
01796 }
01797 
01798 <font class="keywordtype">bool</font>
<a name="l01799"></a><a class="code" href="context_c.html#a108">01799</a> <a class="code" href="context_c.html#a108">context_checkGlobMod</a> (sRef el)<font class="keyword"></font>
01800 <font class="keyword"></font>{
01801   uentry ue = <a class="code" href="sRef_c.html#a95">sRef_getUentry</a> (el);
01802 
01803   <font class="comment">/* no: llassert (sRef_isGlobal (el)); also check local statics */</font>
01804 
01805   <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a92">uentry_isCheckedModify</a> (ue)
01806       || (!<a class="code" href="uentry_c.html#a90">uentry_isUnchecked</a> (ue) &amp;&amp; (gc.flags[FLG_ALLGLOBALS])))
01807     {
01808       <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a118">context_hasMods</a> ())
01809         {
01810           <font class="keywordflow">return</font> (gc.flags[FLG_MODGLOBS]);
01811         }
01812       <font class="keywordflow">else</font>
01813         {
01814           <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a93">uentry_isCheckedStrict</a> (ue))
01815             {
01816               <font class="keywordflow">return</font> (gc.flags[FLG_MODGLOBSUNSPEC]);
01817             }
01818           <font class="keywordflow">else</font>
01819             {
01820               <font class="keywordflow">return</font> (gc.flags[FLG_MODSTRICTGLOBSUNSPEC]);
01821             }
01822         }
01823     }
01824   <font class="keywordflow">else</font>
01825     {
01826       <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a118">context_hasMods</a> ())
01827         {
01828           <font class="keywordflow">return</font> (gc.flags[FLG_MODGLOBSUNCHECKED]);
01829         }
01830       <font class="keywordflow">else</font>
01831         {
01832           <font class="keywordflow">return</font> FALSE;
01833         }
01834     }
01835 }
01836 
01837 <font class="keywordtype">void</font>
<a name="l01838"></a><a class="code" href="context_c.html#a109">01838</a> <a class="code" href="context_c.html#a109">context_usedGlobal</a> (sRef el)<font class="keyword"></font>
01839 <font class="keyword"></font>{
01840   <font class="keywordflow">if</font> (!<a class="code" href="globSet_c.html#a5">globSet_member</a> (gc.globs_used, el))
01841     {
01842       <font class="comment">/* </font>
01843 <font class="comment">      ** The first time a global is used in a function, we need</font>
01844 <font class="comment">      ** to clear the derived sRefs, since they were set for the</font>
01845 <font class="comment">      ** previous function.</font>
01846 <font class="comment">      */</font>
01847 
01848       <a class="code" href="sRef_c.html#a273">sRef_clearDerived</a> (el);
01849       gc.globs_used = <a class="code" href="globSet_c.html#a2">globSet_insert</a> (gc.globs_used, el);
01850     }
01851 }
01852 
01853 <font class="comment">/*@observer@*/</font> sRefSet
<a name="l01854"></a><a class="code" href="context_c.html#a110">01854</a> <a class="code" href="context_c.html#a110">context_modList</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01855 <font class="keyword"></font>{
01856   <font class="keywordflow">return</font> gc.mods;
01857 }
01858 
01859 <font class="keywordtype">bool</font>
<a name="l01860"></a><a class="code" href="context_c.html#a111">01860</a> <a class="code" href="context_c.html#a111">context_globAccess</a> (sRef s)<font class="keyword"></font>
01861 <font class="keyword"></font>{
01862   llassert (sRef_isGlobal (s) || sRef_isKindSpecial (s));
01863   <font class="keywordflow">return</font> (<a class="code" href="globSet_c.html#a5">globSet_member</a> (gc.globs, s));
01864 }
01865 
01866 <font class="keywordtype">bool</font>
<a name="l01867"></a><a class="code" href="context_c.html#a112">01867</a> <a class="code" href="context_c.html#a112">context_hasAccess</a> (typeId t)<font class="keyword"></font>
01868 <font class="keyword"></font>{
01869   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a175">context_inFunctionLike</a> ())
01870     {
01871       <font class="keywordflow">return</font> (<a class="code" href="typeIdSet_c.html#a15">typeIdSet_member</a> (gc.acct, t));
01872     }
01873   <font class="keywordflow">else</font>
01874     {
01875       <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a113">context_hasFileAccess</a> (t));
01876     }
01877 }
01878 
01879 <font class="keywordtype">bool</font>
<a name="l01880"></a><a class="code" href="context_c.html#a113">01880</a> <a class="code" href="context_c.html#a113">context_hasFileAccess</a> (typeId t)<font class="keyword"></font>
01881 <font class="keyword"></font>{
01882   <font class="keywordflow">return</font> (<a class="code" href="typeIdSet_c.html#a15">typeIdSet_member</a> (gc.facct, t));
01883 }
01884 
01885 <font class="comment">/*@only@*/</font> cstring
<a name="l01886"></a><a class="code" href="context_c.html#a114">01886</a> <a class="code" href="context_c.html#a114">context_unparseAccess</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01887 <font class="keyword"></font>{
01888   <font class="keywordflow">return</font> (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q / %q"</font>, typeIdSet_unparse (gc.acct),
01889                    <a class="code" href="typeIdSet_c.html#a21">typeIdSet_unparse</a> (gc.facct)));
01890 }
01891 
01892 <font class="comment">/*@only@*/</font> cstring
<a name="l01893"></a><a class="code" href="context_c.html#a115">01893</a> <a class="code" href="context_c.html#a115">context_unparseClauses</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01894 <font class="keyword"></font>{
01895   <font class="keywordflow">return</font> (<a class="code" href="clauseStack_c.html#a8">clauseStack_unparse</a> (gc.clauses));
01896 }
01897 
01898 <font class="keywordtype">bool</font>
<a name="l01899"></a><a class="code" href="context_c.html#a116">01899</a> <a class="code" href="context_c.html#a116">context_couldHaveAccess</a> (typeId t)<font class="keyword"></font>
01900 <font class="keyword"></font>{
01901   <font class="keywordflow">if</font> (gc.kind == CX_FUNCTION || gc.kind == CX_MACROFCN || gc.kind == CX_UNKNOWNMACRO)
01902     {
01903       <font class="keywordflow">return</font> (<a class="code" href="typeIdSet_c.html#a15">typeIdSet_member</a> (gc.acct, t));
01904     }
01905   <font class="keywordflow">else</font>
01906     {
01907       <font class="keywordflow">return</font> (<a class="code" href="typeIdSet_c.html#a15">typeIdSet_member</a> (gc.facct, t)); 
01908     }
01909 }
01910 
01911 ctype
<a name="l01912"></a><a class="code" href="context_c.html#a117">01912</a> <a class="code" href="context_c.html#a117">context_getRetType</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01913 <font class="keyword"></font>{
01914   ctype f = ctype_undefined;
01915 
01916   <font class="keywordflow">if</font> (gc.kind == CX_FUNCTION || gc.kind == CX_MACROFCN)
01917     {
01918       f = <a class="code" href="uentry_c.html#a197">uentry_getType</a> (gc.cont.fcn);
01919     }
01920   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (gc.kind == CX_UNKNOWNMACRO)
01921     {
01922       <font class="keywordflow">return</font> ctype_unknown;
01923     }
01924   <font class="keywordflow">else</font>
01925     {
01926       llcontbuglit (<font class="stringliteral">"context_getRetType: not in a function context"</font>);
01927       <font class="keywordflow">return</font> ctype_unknown;
01928     }
01929 
01930   <font class="keywordflow">if</font> (!<a class="code" href="ctype_c.html#a49">ctype_isFunction</a> (f))
01931     {
01932       <font class="keywordflow">if</font> (ctype_isKnown (f))
01933         {
01934           llbuglit (<font class="stringliteral">"context_getRetType: not a function"</font>);
01935         }
01936 
01937       <font class="keywordflow">return</font> ctype_unknown;
01938     }
01939   <font class="keywordflow">return</font> (<a class="code" href="ctype_c.html#a39">ctype_returnValue</a> (f));
01940 }    
01941 
01942 <font class="keywordtype">bool</font>
<a name="l01943"></a><a class="code" href="context_c.html#a118">01943</a> <a class="code" href="context_c.html#a118">context_hasMods</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01944 <font class="keyword"></font>{
01945   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a175">context_inFunctionLike</a> ())
01946     {
01947       <font class="keywordflow">return</font> (<a class="code" href="uentry_c.html#a145">uentry_hasMods</a> (gc.cont.fcn));
01948     }
01949   <font class="keywordflow">else</font>
01950     {
01951       <font class="keywordflow">return</font> FALSE;
01952     }
01953 }
01954 
01955 <font class="keywordtype">void</font>
<a name="l01956"></a><a class="code" href="context_c.html#a119">01956</a> <a class="code" href="context_c.html#a119">context_exitAllClauses</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
01957 <font class="keyword"></font>{
01958   
01959   <font class="keywordflow">while</font> (!clauseStack_isEmpty (gc.clauses))
01960     {
01961       clause el = <a class="code" href="clauseStack_c.html#a4">clauseStack_top</a> (gc.clauses);
01962 
01963       gc.inclause = el;
01964 
01965       <font class="keywordflow">if</font> (<a class="code" href="clause_c.html#a9">clause_isNone</a> (el))
01966         {
01967           <a class="code" href="usymtab_c.html#a106">usymtab_quietExitScope</a> (g_currentloc);
01968           <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
01969         }
01970       <font class="keywordflow">else</font>
01971         {
01972           context_exitClausePlain ();
01973         }
01974     }
01975 
01976   <a class="code" href="clauseStack_c.html#a9">clauseStack_clear</a> (gc.clauses);
01977 
01978   
01979   gc.inclause = NOCLAUSE;
01980 }
01981 
01982 <font class="keyword">static</font>
01983 <font class="keywordtype">void</font> context_exitClauseSimp (<font class="keywordtype">void</font>)<font class="keyword"></font>
01984 <font class="keyword"></font>{
01985   
01986   context_setJustPopped ();
01987   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
01988   gc.inclause = topClause (gc.clauses);
01989 }
01990 
01991 <font class="keyword">static</font>
01992 <font class="keywordtype">void</font> context_exitCaseClause (<font class="keywordtype">void</font>)<font class="keyword"></font>
01993 <font class="keyword"></font>{
01994   context_setJustPopped ();
01995   <a class="code" href="usymtab_c.html#a90">usymtab_popCaseBranch</a> ();
01996   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
01997   gc.inclause = topClause (gc.clauses);
01998 }
01999 
02000 <font class="keyword">static</font>
02001 <font class="keywordtype">void</font> context_exitClauseAux (exprNode pred, exprNode tbranch)<font class="keyword"></font>
02002 <font class="keyword"></font>{
02003   context_setJustPopped ();
02004   <a class="code" href="usymtab_c.html#a89">usymtab_popTrueBranch</a> (pred, tbranch, gc.inclause);
02005   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
02006   gc.inclause = topClause (gc.clauses);
02007 }
02008 
<a name="l02009"></a><a class="code" href="context_c.html#a121">02009</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a121">context_exitTrueClause</a> (exprNode pred, exprNode tbranch)<font class="keyword"></font>
02010 <font class="keyword"></font>{
02011   <font class="keywordflow">if</font> (gc.inclause != TRUECLAUSE)
02012     {
02013       <a class="code" href="llerror_c.html#a69">llparseerror</a> (cstring_makeLiteral
02014                     (<font class="stringliteral">"Likely parse error.  Conditional clauses are inconsistent."</font>));
02015       <font class="keywordflow">return</font>;
02016     }
02017 
02018     
02019   context_setJustPopped ();
02020 
02021   <a class="code" href="usymtab_c.html#a89">usymtab_popTrueBranch</a> (pred, tbranch, TRUECLAUSE);
02022   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
02023   gc.inclause = topClause (gc.clauses);
02024   
02025   }
02026 
<a name="l02027"></a><a class="code" href="context_c.html#a122">02027</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a122">context_exitIterClause</a> (exprNode body)<font class="keyword"></font>
02028 <font class="keyword"></font>{
02029   llassert (gc.inclause == ITERCLAUSE);
02030 
02031   context_setJustPopped ();
02032 
02033   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_LOOPEXEC))
02034     {
02035       <a class="code" href="usymtab_c.html#a91">usymtab_popTrueExecBranch</a> (exprNode_undefined, body, ITERCLAUSE);
02036     }
02037   <font class="keywordflow">else</font>
02038     {
02039       <a class="code" href="usymtab_c.html#a89">usymtab_popTrueBranch</a> (exprNode_undefined, body, ITERCLAUSE);
02040     }
02041 
02042   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
02043   gc.inclause = topClause (gc.clauses);
02044 }
02045 
02046 <font class="keyword">static</font> <font class="keywordtype">void</font> context_popCase (<font class="keywordtype">void</font>)<font class="keyword"> </font>{
02047   <font class="comment">/*</font>
02048 <font class="comment">  ** If we are exiting an outer clause, sometimes still in a switch case.</font>
02049 <font class="comment">  **</font>
02050 <font class="comment">  ** e.g.: </font>
02051 <font class="comment">  **</font>
02052 <font class="comment">  ** switch(a)</font>
02053 <font class="comment">  ** {</font>
02054 <font class="comment">  **   case 1:</font>
02055 <font class="comment">  **     while (c&gt;3)</font>
02056 <font class="comment">  **       {</font>
02057 <font class="comment">  **         case 3: ++c;</font>
02058 <font class="comment">  **       }</font>
02059 <font class="comment">  ** }     </font>
02060 <font class="comment">  */</font>
02061 
02062   DPRINTF ((<font class="stringliteral">"Popping case clause: %s"</font>,
02063             clauseStack_unparse (gc.clauses)));
02064 
02065   <font class="keywordflow">if</font> (gc.inclause == CASECLAUSE) {
02066     context_exitCaseClause ();
02067   }
02068 }
02069 
<a name="l02070"></a><a class="code" href="context_c.html#a124">02070</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a124">context_exitWhileClause</a> (exprNode pred, exprNode body)<font class="keyword"></font>
02071 <font class="keyword"></font>{
02072   guardSet invGuards = <a class="code" href="guardSet_c.html#a11">guardSet_invert</a> (exprNode_getGuards (pred));
02073 
02074   context_popCase (); 
02075 
02076   <font class="keywordflow">if</font> (gc.inclause != WHILECLAUSE) {
02077     DPRINTF ((<font class="stringliteral">"Clause: %s / %s"</font>, clause_unparse (gc.inclause),
02078               <a class="code" href="clauseStack_c.html#a8">clauseStack_unparse</a> (gc.clauses)));
02079   }
02080 
02081   llassert (gc.inclause == WHILECLAUSE);
02082 
02083   context_setJustPopped ();
02084 
02085   
02086   <font class="comment">/*</font>
02087 <font class="comment">  ** predicate must be false after while loop (unless there are breaks)</font>
02088 <font class="comment">  */</font>
02089 
02090   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_LOOPEXEC))
02091     {
02092       <a class="code" href="usymtab_c.html#a91">usymtab_popTrueExecBranch</a> (pred, body, WHILECLAUSE);
02093     }
02094   <font class="keywordflow">else</font>
02095     {
02096       <a class="code" href="usymtab_c.html#a89">usymtab_popTrueBranch</a> (pred, body, WHILECLAUSE);
02097     }
02098 
02099   
02100   <a class="code" href="usymtab_c.html#a142">usymtab_addGuards</a> (invGuards);
02101   <a class="code" href="guardSet_c.html#a16">guardSet_free</a> (invGuards);
02102 
02103   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
02104   gc.inclause = topClause (gc.clauses);  
02105 }
02106 
<a name="l02107"></a><a class="code" href="context_c.html#a125">02107</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a125">context_exitDoWhileClause</a> (exprNode pred)<font class="keyword"></font>
02108 <font class="keyword"></font>{
02109   guardSet invGuards = <a class="code" href="guardSet_c.html#a11">guardSet_invert</a> (exprNode_getGuards (pred));
02110 
02111   <font class="keywordflow">if</font> (gc.inclause == CASECLAUSE) {
02112     <font class="comment">/* handle Duff's device */</font>
02113     <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
02114     gc.inclause = topClause (gc.clauses);
02115   }
02116 
02117   llassert (gc.inclause == DOWHILECLAUSE);
02118 
02119   context_setJustPopped ();
02120 
02121     
02122   <a class="code" href="usymtab_c.html#a142">usymtab_addGuards</a> (invGuards);
02123   <a class="code" href="guardSet_c.html#a16">guardSet_free</a> (invGuards);
02124 
02125   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
02126   gc.inclause = topClause (gc.clauses);  
02127 }
02128 
<a name="l02129"></a><a class="code" href="context_c.html#a126">02129</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a126">context_exitForClause</a> (exprNode forPred, exprNode body)<font class="keyword"></font>
02130 <font class="keyword"></font>{
02131   guardSet invGuards = <a class="code" href="guardSet_c.html#a11">guardSet_invert</a> (exprNode_getForGuards (forPred));
02132 
02133   llassert (gc.inclause == FORCLAUSE);
02134   context_setJustPopped ();
02135 
02136   <font class="comment">/*</font>
02137 <font class="comment">  ** predicate must be false after while loop (unless there are breaks)</font>
02138 <font class="comment">  */</font>
02139 
02140   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_LOOPEXEC))
02141     {
02142             <a class="code" href="usymtab_c.html#a91">usymtab_popTrueExecBranch</a> (forPred, body, FORCLAUSE);
02143     }
02144   <font class="keywordflow">else</font>
02145     {
02146       <a class="code" href="usymtab_c.html#a89">usymtab_popTrueBranch</a> (forPred, body, FORCLAUSE);
02147     }
02148 
02149   <a class="code" href="usymtab_c.html#a142">usymtab_addGuards</a> (invGuards);
02150   <a class="code" href="guardSet_c.html#a16">guardSet_free</a> (invGuards);
02151   <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
02152   gc.inclause = topClause (gc.clauses);
02153 }
02154 
02155 <font class="keyword">static</font> <font class="keywordtype">void</font> context_exitClausePlain (<font class="keywordtype">void</font>)<font class="keyword"></font>
02156 <font class="keyword"></font>{
02157   llassert (gc.inclause != NOCLAUSE);
02158   
02159   <font class="keywordflow">if</font> (gc.inclause == FALSECLAUSE)
02160     {
02161       <a class="code" href="context_c.html#a127">context_exitClause</a> (exprNode_undefined, exprNode_undefined, exprNode_undefined);
02162     }
02163   <font class="keywordflow">else</font>
02164     {
02165       context_exitClauseAux (exprNode_undefined, exprNode_undefined);
02166     }
02167   
02168 }
02169 
<a name="l02170"></a><a class="code" href="context_c.html#a127">02170</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a127">context_exitClause</a> (exprNode pred, exprNode tbranch, exprNode fbranch)<font class="keyword"></font>
02171 <font class="keyword"></font>{
02172     
02173   context_setJustPopped ();
02174 
02175   <font class="keywordflow">if</font> (gc.inclause == FALSECLAUSE)
02176     {
02177       <a class="code" href="usymtab_c.html#a97">usymtab_popBranches</a> (pred, tbranch, fbranch, FALSE, FALSECLAUSE);
02178 
02179       llassert (clauseStack_top (gc.clauses) == FALSECLAUSE);
02180 
02181       <a class="code" href="clauseStack_c.html#a3">clauseStack_pop</a> (gc.clauses);
02182       gc.inclause = topClause (gc.clauses);
02183     }
02184   <font class="keywordflow">else</font>
02185     {
02186             <a class="code" href="context_c.html#a121">context_exitTrueClause</a> (pred, tbranch);
02187     }
02188 }
02189 
02190 <font class="keywordtype">void</font>
<a name="l02191"></a><a class="code" href="context_c.html#a128">02191</a> <a class="code" href="context_c.html#a128">context_returnFunction</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02192 <font class="keyword"></font>{
02193     <a class="code" href="usymtab_c.html#a105">usymtab_checkFinalScope</a> (TRUE);
02194   }
02195 
02196 <font class="keywordtype">void</font>
<a name="l02197"></a><a class="code" href="context_c.html#a129">02197</a> <a class="code" href="context_c.html#a129">context_exitFunction</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02198 <font class="keyword"></font>{    
02199   <font class="keywordflow">if</font> (!<a class="code" href="context_c.html#a174">context_inFunction</a> () &amp;&amp; !<a class="code" href="context_c.html#a224">context_inMacroConstant</a> () 
02200       &amp;&amp; !<a class="code" href="context_c.html#a225">context_inMacroUnknown</a> () 
02201       &amp;&amp; !<a class="code" href="context_c.html#a236">context_inIterDef</a> () &amp;&amp; !<a class="code" href="context_c.html#a237">context_inIterEnd</a> ())
02202     {
02203       <font class="comment">/*</font>
02204 <font class="comment">      ** not a bug because of parse errors</font>
02205 <font class="comment">      */</font>
02206     }
02207   <font class="keywordflow">else</font>
02208     {
02209       <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a235">context_inMacro</a> () &amp;&amp; <a class="code" href="usymtab_c.html#a139">usymtab_inFunctionScope</a> ())
02210         {
02211           <a class="code" href="usymtab_c.html#a108">usymtab_exitScope</a> (exprNode_undefined);
02212         }
02213       
02214       <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a142">uentry_hasGlobs</a> (gc.cont.fcn))
02215         {
02216           <a class="code" href="exprChecks_c.html#a12">exprChecks_checkUsedGlobs</a> (gc.globs, gc.globs_used);
02217         }
02218       
02219             
02220       <font class="keywordflow">if</font> (<a class="code" href="uentry_c.html#a145">uentry_hasMods</a> (gc.cont.fcn))
02221         {
02222           <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_MUSTMOD))
02223             {
02224               <a class="code" href="exprChecks_c.html#a13">exprNode_checkAllMods</a> (gc.mods, gc.cont.fcn);
02225             }
02226         }
02227 
02228       <font class="comment">/*</font>
02229 <font class="comment">      ** clear file static modifies</font>
02230 <font class="comment">      */</font>
02231       
02232       <font class="comment">/* do this first to get unused error messages */</font>
02233 
02234       <a class="code" href="usymtab_c.html#a108">usymtab_exitScope</a> (exprNode_undefined);
02235       <a class="code" href="sRef_c.html#a86">sRef_exitFunctionScope</a> ();
02236       
02237       gc.showfunction = FALSE;
02238       gc.kind = CX_GLOBAL;
02239       gc.cont.glob = TRUE;
02240       gc.acct = gc.facct; 
02241       gc.globs = <a class="code" href="globSet_c.html#a0">globSet_new</a> ();
02242       <a class="code" href="globSet_c.html#a1">globSet_clear</a> (gc.globs_used);
02243       gc.mods = <a class="code" href="sRefSet_c.html#a0">sRefSet_new</a> ();
02244     }
02245 
02246   llassert (clauseStack_isEmpty (gc.clauses));
02247   llassert (gc.inclause == NOCLAUSE);
02248 }
02249 
02250 <font class="keywordtype">void</font>
<a name="l02251"></a><a class="code" href="context_c.html#a130">02251</a> <a class="code" href="context_c.html#a130">context_quietExitFunction</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02252 <font class="keyword"></font>{
02253   <font class="keywordflow">while</font> (gc.kind == CX_INNER)
02254     { 
02255       <a class="code" href="context_c.html#a165">context_exitInnerPlain</a> ();
02256     }
02257 
02258   <font class="keywordflow">if</font> (!<a class="code" href="context_c.html#a174">context_inFunction</a> () &amp;&amp; !<a class="code" href="context_c.html#a224">context_inMacroConstant</a> () &amp;&amp; !<a class="code" href="context_c.html#a225">context_inMacroUnknown</a> () 
02259       &amp;&amp; !<a class="code" href="context_c.html#a236">context_inIterDef</a> () &amp;&amp; !<a class="code" href="context_c.html#a237">context_inIterEnd</a> ())
02260     {
02261     }
02262   <font class="keywordflow">else</font>
02263     {
02264       <a class="code" href="usymtab_c.html#a106">usymtab_quietExitScope</a> (g_currentloc);
02265 
02266       gc.showfunction = FALSE;
02267       gc.kind = CX_GLOBAL;
02268       gc.cont.glob = TRUE;
02269       gc.acct = gc.facct; 
02270       gc.globs = <a class="code" href="globSet_c.html#a0">globSet_new</a> ();
02271       <a class="code" href="globSet_c.html#a1">globSet_clear</a> (gc.globs_used);
02272       gc.mods = <a class="code" href="sRefSet_c.html#a0">sRefSet_new</a> ();
02273 
02274       <a class="code" href="sRef_c.html#a86">sRef_exitFunctionScope</a> ();
02275     }
02276 }
02277 
02278 <font class="comment">/*@observer@*/</font> uentryList
<a name="l02279"></a><a class="code" href="context_c.html#a131">02279</a> <a class="code" href="context_c.html#a131">context_getParams</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02280 <font class="keyword"></font>{
02281   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a175">context_inFunctionLike</a> ())
02282     {
02283             <font class="keywordflow">return</font> (<a class="code" href="uentry_c.html#a193">uentry_getParams</a> (gc.cont.fcn));
02284     }
02285   <font class="keywordflow">else</font>
02286     {
02287       llcontbug (message (<font class="stringliteral">"context_getParams: not in function: %q"</font>, context_unparse ()));
02288       <font class="keywordflow">return</font> uentryList_undefined;
02289     }
02290 }
02291 
02292 <font class="comment">/*@observer@*/</font> globSet
<a name="l02293"></a><a class="code" href="context_c.html#a132">02293</a> <a class="code" href="context_c.html#a132">context_getUsedGlobs</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02294 <font class="keyword"></font>{
02295   llassert (gc.kind == CX_FUNCTION || gc.kind == CX_MACROFCN 
02296             || gc.kind == CX_UNKNOWNMACRO || gc.kind == CX_ITERDEF);
02297 
02298   <font class="keywordflow">return</font> (gc.globs_used);
02299 }
02300 
02301 cstring
<a name="l02302"></a><a class="code" href="context_c.html#a133">02302</a> <a class="code" href="context_c.html#a133">context_moduleName</a> ()<font class="keyword"></font>
02303 <font class="keyword"></font>{
02304   <font class="keywordflow">return</font> (<a class="code" href="fileloc_c.html#a10">fileloc_getBase</a> (g_currentloc));
02305 }
02306 
02307 <font class="comment">/*@observer@*/</font> globSet
<a name="l02308"></a><a class="code" href="context_c.html#a134">02308</a> <a class="code" href="context_c.html#a134">context_getGlobs</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02309 <font class="keyword"></font>{
02310   llassert (gc.kind == CX_FUNCTION || gc.kind == CX_MACROFCN 
02311             || gc.kind == CX_UNKNOWNMACRO || gc.kind == CX_ITERDEF);
02312 
02313   <font class="keywordflow">return</font> (gc.globs);
02314 }
02315 
02316 <font class="keywordtype">void</font>
<a name="l02317"></a><a class="code" href="context_c.html#a135">02317</a> <a class="code" href="context_c.html#a135">context_addBoolAccess</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02318 <font class="keyword"></font>{
02319   cstring bname = <a class="code" href="context_c.html#a157">context_getString</a> (FLG_BOOLTYPE);
02320   typeIdSet boolt = <a class="code" href="typeIdSet_c.html#a17">typeIdSet_single</a> (usymtab_getTypeId (bname));
02321   
02322   addModuleAccess (cstring_copy (bname), boolt);
02323 
02324   <font class="comment">/* for sys/types (perhaps, this is bogus!) */</font> 
02325   addModuleAccess (cstring_makeLiteral (<font class="stringliteral">"types"</font>), boolt); 
02326 }
02327 
02328 <font class="preprocessor"># if 0</font>
02329 <font class="preprocessor"></font><font class="keywordtype">bool</font>
02330 <a class="code" href="context_c.html#a137">context_canAccessBool</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02331 <font class="keyword"></font>{
02332   <font class="keywordflow">return</font> TRUE;
02333 }
02334 <font class="preprocessor"># endif</font>
02335 <font class="preprocessor"></font>
02336 <font class="comment">/*</font>
02337 <font class="comment">  static typeId boolType = typeId_invalid;</font>
02338 <font class="comment"></font>
02339 <font class="comment">  if (typeId_isInvalid (boolType))</font>
02340 <font class="comment">    { </font>
02341 <font class="comment">      boolType = usymtab_getTypeId (context_getBoolName ());</font>
02342 <font class="comment">    }</font>
02343 <font class="comment"></font>
02344 <font class="comment">  if (typeId_isInvalid (boolType)) {</font>
02345 <font class="comment">    return FALSE;</font>
02346 <font class="comment">  } else {</font>
02347 <font class="comment">    return (typeIdSet_member (gc.acct, boolType));</font>
02348 <font class="comment">  }</font>
02349 <font class="comment">}</font>
02350 <font class="comment">*/</font>
02351 
02352 <font class="comment">/* evs 2000-07-25: old version - replaced */</font>
02353 
02354 ctype
<a name="l02355"></a><a class="code" href="context_c.html#a136">02355</a> <a class="code" href="context_c.html#a136">context_boolImplementationType</a> ()<font class="keyword"> </font>{
02356   <font class="comment">/* For now, this is bogus! */</font>
02357   <font class="keywordflow">return</font> ctype_int;
02358 }
02359 
02360 <font class="keywordtype">bool</font>
<a name="l02361"></a><a class="code" href="context_c.html#a137">02361</a> <a class="code" href="context_c.html#a137">context_canAccessBool</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02362 <font class="keyword"></font>{
02363   <font class="keyword">static</font> typeId boolType = typeId_invalid;
02364 
02365   <font class="keywordflow">if</font> (typeId_isInvalid (boolType))
02366     { 
02367       boolType = <a class="code" href="usymtab_c.html#a64">usymtab_getTypeId</a> (context_getBoolName ());
02368     }
02369 
02370   <font class="keywordflow">if</font> (!typeId_isInvalid (boolType))
02371     { 
02372       <font class="keywordflow">return</font> <a class="code" href="context_c.html#a112">context_hasAccess</a> (boolType);
02373     }
02374   <font class="keywordflow">else</font> 
02375     {
02376       ;
02377     }
02378 
02379   <font class="keywordflow">return</font> FALSE; 
02380 }
02381 
02382 <font class="keywordtype">void</font>
<a name="l02383"></a><a class="code" href="context_c.html#a138">02383</a> <a class="code" href="context_c.html#a138">context_setMessageAnnote</a> (<font class="comment">/*@only@*/</font> cstring s)<font class="keyword"></font>
02384 <font class="keyword"></font>{
02385   llassert (cstring_isUndefined (gc.msgAnnote));
02386     gc.msgAnnote = s;
02387 }
02388 
02389 <font class="keywordtype">bool</font>
<a name="l02390"></a><a class="code" href="context_c.html#a139">02390</a> <a class="code" href="context_c.html#a139">context_hasMessageAnnote</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02391 <font class="keyword"></font>{
02392   <font class="keywordflow">return</font> (cstring_isDefined (gc.msgAnnote));
02393 }
02394 
02395 <font class="keywordtype">void</font>
<a name="l02396"></a><a class="code" href="context_c.html#a140">02396</a> <a class="code" href="context_c.html#a140">context_clearMessageAnnote</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02397 <font class="keyword"></font>{
02398   <font class="keywordflow">if</font> (cstring_isDefined (gc.msgAnnote))
02399     {
02400       <a class="code" href="cstring_c.html#a27">cstring_free</a> (gc.msgAnnote);
02401       gc.msgAnnote = cstring_undefined;
02402     }
02403 }
02404 
02405 <font class="comment">/*@only@*/</font> cstring
<a name="l02406"></a><a class="code" href="context_c.html#a141">02406</a> <a class="code" href="context_c.html#a141">context_getMessageAnnote</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02407 <font class="keyword"></font>{
02408   cstring st = gc.msgAnnote;
02409 
02410     gc.msgAnnote = cstring_undefined;
02411   <font class="keywordflow">return</font> st;
02412 }
02413 
02414 <font class="keywordtype">void</font>
<a name="l02415"></a><a class="code" href="context_c.html#a142">02415</a> <a class="code" href="context_c.html#a142">context_setAliasAnnote</a> (<font class="comment">/*@observer@*/</font> sRef s, <font class="comment">/*@observer@*/</font> sRef t)<font class="keyword"></font>
02416 <font class="keyword"></font>{
02417     llassert (sRef_isInvalid (gc.aliasAnnote));
02418   llassert (!sRef_sameName (s, t));
02419   gc.aliasAnnote = s;
02420   gc.aliasAnnoteAls = t;
02421 }
02422 
02423 <font class="keywordtype">bool</font>
<a name="l02424"></a><a class="code" href="context_c.html#a143">02424</a> <a class="code" href="context_c.html#a143">context_hasAliasAnnote</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02425 <font class="keyword"></font>{
02426   <font class="keywordflow">return</font> (sRef_isValid (gc.aliasAnnote));
02427 }
02428 
02429 <font class="keywordtype">void</font>
<a name="l02430"></a><a class="code" href="context_c.html#a144">02430</a> <a class="code" href="context_c.html#a144">context_clearAliasAnnote</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02431 <font class="keyword"></font>{
02432   gc.aliasAnnote = sRef_undefined;
02433 }
02434 
02435 cstring
<a name="l02436"></a><a class="code" href="context_c.html#a145">02436</a> <a class="code" href="context_c.html#a145">context_getAliasAnnote</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02437 <font class="keyword"></font>{
02438   sRef ret = gc.aliasAnnote;
02439   sRef als = gc.aliasAnnoteAls;
02440 
02441   llassert (sRef_isValid (ret) &amp;&amp; sRef_isValid (als));
02442 
02443   gc.aliasAnnote = sRef_undefined;
02444   <font class="keywordflow">return</font> (<a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q aliases %q"</font>, sRef_unparse (als), <a class="code" href="sRef_c.html#a123">sRef_unparse</a> (ret)));
02445 }
02446 
02447 <font class="keywordtype">void</font>
<a name="l02448"></a><a class="code" href="context_c.html#a146">02448</a> <a class="code" href="context_c.html#a146">context_recordFileModifies</a> (sRefSet mods)<font class="keyword"></font>
02449 <font class="keyword"></font>{
02450     gc.modrecs = <a class="code" href="sRefSetList_c.html#a2">sRefSetList_add</a> (gc.modrecs, mods);
02451 }
02452 
02453 <font class="keywordtype">void</font>
<a name="l02454"></a><a class="code" href="context_c.html#a147">02454</a> <a class="code" href="context_c.html#a147">context_recordFileGlobals</a> (globSet mods)<font class="keyword"></font>
02455 <font class="keyword"></font>{
02456     <font class="comment">/*@access globSet@*/</font> <a class="code" href="context_c.html#a146">context_recordFileModifies</a> (mods); <font class="comment">/*@noaccess globSet@*/</font>
02457 }
02458 
02459 <font class="keywordtype">void</font>
<a name="l02460"></a><a class="code" href="context_c.html#a148">02460</a> <a class="code" href="context_c.html#a148">context_setCommentMarkerChar</a> (<font class="keywordtype">char</font> c)<font class="keyword"></font>
02461 <font class="keyword"></font>{
02462   llassert (c != <font class="charliteral">'\0'</font>);
02463 
02464   context_setValue (FLG_COMMENTCHAR, (<font class="keywordtype">int</font>) c);
02465 }
02466 
02467 <font class="keywordtype">char</font>
<a name="l02468"></a><a class="code" href="context_c.html#a149">02468</a> <a class="code" href="context_c.html#a149">context_getCommentMarkerChar</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02469 <font class="keyword"></font>{
02470   <font class="keywordflow">return</font> ((<font class="keywordtype">char</font>) <a class="code" href="context_c.html#a151">context_getValue</a> (FLG_COMMENTCHAR));
02471 }
02472 
02473 <font class="keyword">static</font> <font class="keywordtype">void</font>
02474 context_setValue (flagcode flag, <font class="keywordtype">int</font> val)<font class="keyword"></font>
02475 <font class="keyword"></font>{
02476   <font class="keywordtype">int</font> index = <a class="code" href="flags_c.html#a44">flagcode_valueIndex</a> (flag);
02477 
02478   llassert (index &gt;= 0 &amp;&amp; index &lt;= NUMVALUEFLAGS);
02479 
02480   <font class="keywordflow">if</font> (val &lt;= 0)
02481     {
02482       <font class="keywordflow">switch</font> (flag)
02483         {
02484         <font class="keywordflow">case</font> FLG_INCLUDENEST:
02485         <font class="keywordflow">case</font> FLG_CONTROLNESTDEPTH:
02486         <font class="keywordflow">case</font> FLG_STRINGLITERALLEN:
02487         <font class="keywordflow">case</font> FLG_NUMSTRUCTFIELDS:
02488         <font class="keywordflow">case</font> FLG_NUMENUMMEMBERS:
02489         <font class="keywordflow">case</font> FLG_LINELEN:
02490           {
02491             cstring warn = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Value for %s must be a positive "</font>
02492                                     <font class="stringliteral">"number (given %d)"</font>,
02493                                     flagcode_unparse (flag), val);
02494             
02495             <a class="code" href="llerror_c.html#a24">flagWarning</a> (warn);
02496             <a class="code" href="cstring_c.html#a27">cstring_free</a> (warn);
02497             val = MINLINELEN;
02498           }
02499           <font class="keywordflow">return</font>;
02500         <font class="keywordflow">default</font>:
02501           <font class="keywordflow">break</font>;
02502         }
02503     }
02504 
02505   <font class="keywordflow">if</font> (flag == FLG_LINELEN &amp;&amp; val &lt; MINLINELEN)
02506     {
02507       cstring warn = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Value for %s must be at least %d (given %d)"</font>,
02508                               flagcode_unparse (flag), 
02509                               MINLINELEN, val);
02510       <a class="code" href="llerror_c.html#a24">flagWarning</a> (warn);
02511       <a class="code" href="cstring_c.html#a27">cstring_free</a> (warn);
02512       val = MINLINELEN;
02513     }
02514 
02515     gc.values[index] = val;
02516 }
02517 
02518 <font class="keywordtype">void</font>
<a name="l02519"></a><a class="code" href="context_c.html#a150">02519</a> <a class="code" href="context_c.html#a150">context_setValueAndFlag</a> (flagcode flag, <font class="keywordtype">int</font> val)<font class="keyword"></font>
02520 <font class="keyword"></font>{
02521   gc.flags[flag] = TRUE;
02522   context_setValue (flag, val);
02523 }
02524 
02525 <font class="keywordtype">int</font>
<a name="l02526"></a><a class="code" href="context_c.html#a151">02526</a> <a class="code" href="context_c.html#a151">context_getValue</a> (flagcode flag)<font class="keyword"></font>
02527 <font class="keyword"></font>{
02528   <font class="keywordtype">int</font> index = <a class="code" href="flags_c.html#a44">flagcode_valueIndex</a> (flag);
02529 
02530   llassert (index &gt;= 0 &amp;&amp; index &lt;= NUMVALUEFLAGS);
02531   <font class="keywordflow">return</font> (gc.values[index]);
02532 }
02533 
02534 <font class="keywordtype">int</font>
<a name="l02535"></a><a class="code" href="context_c.html#a152">02535</a> <a class="code" href="context_c.html#a152">context_getCounter</a> (flagcode flag)<font class="keyword"></font>
02536 <font class="keyword"></font>{
02537   <font class="keywordtype">int</font> index = <a class="code" href="flags_c.html#a44">flagcode_valueIndex</a> (flag);
02538 
02539   llassert (index &gt;= 0 &amp;&amp; index &lt;= NUMVALUEFLAGS);
02540   <font class="keywordflow">return</font> (gc.counters[index]);
02541 }
02542 
02543 <font class="keywordtype">void</font>
<a name="l02544"></a><a class="code" href="context_c.html#a153">02544</a> <a class="code" href="context_c.html#a153">context_incCounter</a> (flagcode flag)<font class="keyword"></font>
02545 <font class="keyword"></font>{
02546   <font class="keywordtype">int</font> index = <a class="code" href="flags_c.html#a44">flagcode_valueIndex</a> (flag);
02547 
02548   llassert (index &gt;= 0 &amp;&amp; index &lt;= NUMVALUEFLAGS);
02549   <font class="comment">/* check limit */</font>
02550   gc.counters[index]++;
02551 }
02552 
02553 <font class="keywordtype">void</font>
<a name="l02554"></a><a class="code" href="context_c.html#a154">02554</a> <a class="code" href="context_c.html#a154">context_decCounter</a> (flagcode flag)<font class="keyword"></font>
02555 <font class="keyword"></font>{
02556   <font class="keywordtype">int</font> index = <a class="code" href="flags_c.html#a44">flagcode_valueIndex</a> (flag);
02557 
02558   llassert (index &gt;= 0 &amp;&amp; index &lt;= NUMVALUEFLAGS);
02559   gc.counters[index]--;
02560 }
02561 
<a name="l02562"></a><a class="code" href="context_c.html#a155">02562</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a155">context_showFunction</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02563 <font class="keyword"></font>{
02564   <font class="keywordflow">return</font> (gc.showfunction);
02565 }
02566 
02567 <font class="keywordtype">void</font>
<a name="l02568"></a><a class="code" href="context_c.html#a156">02568</a> <a class="code" href="context_c.html#a156">context_setString</a> (flagcode flag, cstring val)<font class="keyword"></font>
02569 <font class="keyword"></font>{
02570   <font class="keywordtype">int</font> index = <a class="code" href="flags_c.html#a45">flagcode_stringIndex</a> (flag);
02571 
02572   llassert (index &gt;= 0 &amp;&amp; index &lt;= NUMSTRINGFLAGS);
02573 
02574   <font class="keywordflow">if</font> (flag == FLG_SYSTEMDIRS)
02575     {
02576       llassert (cstring_isDefined (val));
02577 
02578       <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a1">cstring_firstChar</a> (val) == <font class="charliteral">'\"'</font>)
02579         {
02580           cstring oval = val;
02581           cstring tval = <a class="code" href="cstring_c.html#a9">cstring_copy</a> (cstring_suffix (val, 1));
02582         
02583           <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a8">cstring_lastChar</a> (tval) != <font class="charliteral">'\"'</font>)
02584             {
02585               <font class="keywordtype">int</font> n = <a class="code" href="cstring_c.html#a30">cstring_length</a> (tval) - 1;
02586 
02587               <font class="keywordflow">while</font> (isspace ((<font class="keywordtype">int</font>) <a class="code" href="cstring_c.html#a2">cstring_getChar</a> (tval, n)))
02588                 {
02589                   n--;
02590                 }
02591 
02592               <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a2">cstring_getChar</a> (tval, n) != <font class="charliteral">'\"'</font>)
02593                 {
02594                   cstring msg = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Setting -systemdirs to string with unmatching quotes: %s"</font>, val);
02595                   <a class="code" href="llerror_c.html#a24">flagWarning</a> (msg);
02596                   <a class="code" href="cstring_c.html#a27">cstring_free</a> (msg);
02597                 }
02598               <font class="keywordflow">else</font>
02599                 {
02600                   cstring otval = tval;
02601                   tval = <a class="code" href="cstring_c.html#a4">cstring_prefix</a> (tval, n);
02602                   <a class="code" href="cstring_c.html#a27">cstring_free</a> (otval);
02603                 }
02604             }
02605           
02606           val = <a class="code" href="cstring_c.html#a9">cstring_copy</a> (cstring_clip (tval, cstring_length (tval) - 1));
02607           DPRINTF ((<font class="stringliteral">"val = %s"</font>, val));
02608           <a class="code" href="cstring_c.html#a27">cstring_free</a> (tval);
02609           <a class="code" href="cstring_c.html#a27">cstring_free</a> (oval);
02610         }
02611     }
02612 
02613   <font class="keywordflow">if</font> (flag == FLG_TMPDIR)
02614     {
02615       llassert (cstring_isDefined (val));
02616       
02617       <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a30">cstring_length</a> (val) == 0)
02618         {
02619           <a class="code" href="cstring_c.html#a27">cstring_free</a> (val);
02620           val = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">".%s"</font>, cstring_makeLiteralTemp (CONNECTSTR));
02621         }
02622       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a8">cstring_lastChar</a> (val) != CONNECTCHAR)
02623         {
02624           val = <a class="code" href="cstring_c.html#a37">cstring_appendChar</a> (val, CONNECTCHAR);
02625         }
02626       <font class="keywordflow">else</font>
02627         {
02628           ;
02629         }
02630     }
02631 
02632   <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a30">cstring_length</a> (val) &gt;= 1
02633       &amp;&amp; <a class="code" href="cstring_c.html#a1">cstring_firstChar</a> (val) == <font class="charliteral">'"'</font>)
02634     {
02635       cstring s = message
02636                    (<font class="stringliteral">"setting %s to string beginning with \".  You probably "</font>
02637                     <font class="stringliteral">"don't meant to have the \"'s."</font>,
02638                     flagcode_unparse (flag));
02639 
02640       <a class="code" href="llerror_c.html#a24">flagWarning</a> (s);
02641       <a class="code" href="cstring_c.html#a27">cstring_free</a> (s);
02642     }
02643 
02644   <font class="keywordflow">if</font> (flag == FLG_BOOLTYPE)
02645     {
02646 
02647     }
02648 
02649   gc.strings[index] = val;
02650 }
02651 
02652 <font class="keyword">static</font> <font class="comment">/*@exposed@*/</font> cstring
02653 context_exposeString (flagcode flag)<font class="keyword"></font>
02654 <font class="keyword"></font>{
02655   <font class="keywordtype">int</font> index = <a class="code" href="flags_c.html#a45">flagcode_stringIndex</a> (flag);
02656 
02657   llassert (index &gt;= 0 &amp;&amp; index &lt;= NUMSTRINGFLAGS);
02658   <font class="keywordflow">return</font> (gc.strings[index]);
02659 }
02660 
02661 cstring
<a name="l02662"></a><a class="code" href="context_c.html#a157">02662</a> <a class="code" href="context_c.html#a157">context_getString</a> (flagcode flag)<font class="keyword"></font>
02663 <font class="keyword"></font>{
02664   <font class="keywordflow">return</font> (context_exposeString (flag));
02665 }
02666 
02667 <font class="keywordtype">void</font>
<a name="l02668"></a><a class="code" href="context_c.html#a158">02668</a> <a class="code" href="context_c.html#a158">context_resetErrors</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02669 <font class="keyword"></font>{
02670   gc.numerrors = 0;
02671 }
02672 
<a name="l02673"></a><a class="code" href="context_c.html#a159">02673</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a159">context_initMod</a> (<font class="keywordtype">void</font>)
02674    <font class="comment">/*@globals undef gc; @*/</font>
02675 {
02676   gc.kind = CX_GLOBAL;
02677   gc.instandardlib = FALSE;
02678   gc.numerrors = 0;
02679   gc.neednl = FALSE;
02680   gc.linesprocessed = 0;
02681   gc.speclinesprocessed = 0;
02682   gc.insuppressregion = FALSE;
02683   gc.macroMissingParams = FALSE;
02684   gc.preprocessing = FALSE;
02685   gc.incommandline = FALSE;
02686   gc.mc = <a class="code" href="macrocache_c.html#a11">macrocache_create</a> ();
02687   gc.nmods = 0;
02688   gc.maxmods = DEFAULTMAXMODS;
02689   gc.moduleaccess = (<a class="code" href="struct_maccesst.html">maccesst</a> *) 
02690     dmalloc (<font class="keyword">sizeof</font> (*gc.moduleaccess) * (gc.maxmods));
02691 
02692   gc.library = FLG_ANSILIB;
02693 
02694   gc.locstack = <a class="code" href="filelocStack_c.html#a1">filelocStack_new</a> ();
02695   gc.modrecs = sRefSetList_undefined;
02696   gc.anyExports = FALSE;
02697 
02698   gc.ftab = <a class="code" href="fileTable_c.html#a10">fileTable_create</a> ();
02699   gc.msgLog = <a class="code" href="messageLog_c.html#a0">messageLog_new</a> ();
02700   gc.inimport = FALSE;
02701   gc.inDerivedFile = FALSE;
02702   gc.inheader = FALSE;
02703   gc.markers = <a class="code" href="flagMarkerList_c.html#a0">flagMarkerList_new</a> ();
02704   gc.cont.glob = TRUE;
02705   gc.showfunction = FALSE;
02706   gc.msgAnnote = cstring_undefined;
02707   gc.aliasAnnote = sRef_undefined;
02708   gc.aliasAnnoteAls = sRef_undefined;
02709   gc.boolType = ctype_bool;
02710   gc.mods = <a class="code" href="sRefSet_c.html#a0">sRefSet_new</a> ();
02711 
02712   gc.saveloc = fileloc_undefined;
02713 
02714   gc.inmacrocache = FALSE;
02715   gc.inclause = NOCLAUSE;
02716   gc.clauses = <a class="code" href="clauseStack_c.html#a0">clauseStack_new</a> ();
02717   gc.globs = <a class="code" href="globSet_c.html#a0">globSet_new</a> ();
02718   gc.nacct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> ();
02719   gc.acct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> ();
02720   gc.facct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> ();
02721   gc.savedFlags = FALSE;
02722   gc.pushloc = fileloc_undefined;
02723   gc.protectVars = FALSE;
02724   gc.justpopped = FALSE;
02725   gc.isNullGuarded = NO;
02726   gc.globs_used = globSet_undefined;
02727   
02728   allFlagCodes (code)<font class="keyword"></font>
02729 <font class="keyword">    </font>{
02730       gc.setGlobally[code] = FALSE;
02731       gc.setLocally[code] = FALSE;
02732     } end_allFlagCodes ;
02733 
02734   <a class="code" href="usymtab_c.html#a40">usymtab_initMod</a> ();
02735 
02736   <a class="code" href="context_c.html#a62">context_resetAllFlags</a> ();
02737   conext_resetAllCounters ();
02738   <a class="code" href="context_c.html#a63">context_setMode</a> (DEFAULT_MODE);
02739 }
02740 
02741 ctype
<a name="l02742"></a><a class="code" href="context_c.html#a160">02742</a> <a class="code" href="context_c.html#a160">context_typeofZero</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02743 <font class="keyword"></font>{
02744   ctype ct = ctype_int;
02745 
02746   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_ZEROPTR))
02747     {
02748       ct = <a class="code" href="ctype_c.html#a85">ctype_makeConj</a> (ct, ctype_voidPointer);
02749     }
02750   
02751   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_ZEROBOOL)) {
02752     ct = <a class="code" href="ctype_c.html#a85">ctype_makeConj</a> (ct, ctype_bool); 
02753   }
02754 
02755   <font class="keywordflow">return</font> ct;
02756 }
02757 
02758 ctype
<a name="l02759"></a><a class="code" href="context_c.html#a161">02759</a> <a class="code" href="context_c.html#a161">context_typeofOne</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02760 <font class="keyword"></font>{
02761   ctype ct = ctype_int;
02762 
02763   <font class="comment">/* 1 is on longer a bool (was before 2.4)</font>
02764 <font class="comment">     if (!context_getFlag (FLG_ABSTRACTBOOL))</font>
02765 <font class="comment">     {</font>
02766 <font class="comment">     ct = ctype_makeConj (ct, ctype_bool);</font>
02767 <font class="comment">     }</font>
02768 <font class="comment">     */</font>
02769 
02770   <font class="keywordflow">return</font> (ct);
02771 }
02772 
02773 <font class="comment">/*@only@*/</font> cstring
<a name="l02774"></a><a class="code" href="context_c.html#a162">02774</a> <a class="code" href="context_c.html#a162">context_unparse</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02775 <font class="keyword"></font>{
02776   cstring s;
02777 
02778   <font class="keywordflow">switch</font> (gc.kind)
02779     {
02780     <font class="keywordflow">case</font> CX_LCL:
02781       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"LCL File: %q"</font>, fileloc_unparse (g_currentloc));
02782       <font class="keywordflow">break</font>;
02783     <font class="keywordflow">case</font> CX_LCLLIB:
02784       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"LCL Lib File: %q"</font>, fileloc_unparse (g_currentloc));
02785       <font class="keywordflow">break</font>;
02786     <font class="keywordflow">case</font> CX_GLOBAL:
02787       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Global Context:%q"</font>, fileloc_unparse (g_currentloc));
02788       <font class="keywordflow">break</font>;
02789     <font class="keywordflow">case</font> CX_INNER:
02790       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Inner Context:%q"</font>, fileloc_unparse (g_currentloc));
02791       <font class="keywordflow">break</font>;
02792     <font class="keywordflow">case</font> CX_FUNCTION:
02793       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Function %q :%q \n\taccess %q\n\tmodifies %q"</font>,
02794                    uentry_unparse (gc.cont.fcn),
02795                    <a class="code" href="fileloc_c.html#a39">fileloc_unparse</a> (g_currentloc),
02796                    <a class="code" href="typeIdSet_c.html#a21">typeIdSet_unparse</a> (gc.acct),
02797                    <a class="code" href="sRefSet_c.html#a35">sRefSet_unparse</a> (gc.mods));
02798       <font class="keywordflow">break</font>;
02799     <font class="keywordflow">case</font> CX_MACROFCN:
02800       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Function Macro %q"</font>, uentry_unparse (gc.cont.fcn));
02801       <font class="keywordflow">break</font>;
02802     <font class="keywordflow">case</font> CX_UNKNOWNMACRO:
02803       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Forward Specified Macro %q"</font>, uentry_unparse (gc.cont.fcn));
02804       <font class="keywordflow">break</font>;
02805     <font class="keywordflow">case</font> CX_MACROCONST:
02806       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Constant Macro %q"</font>, uentry_unparse (gc.cont.fcn));
02807       <font class="keywordflow">break</font>;
02808     <font class="keywordflow">case</font> CX_ITERDEF:
02809       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Iter definition %q"</font>, uentry_unparse (gc.cont.fcn));
02810       <font class="keywordflow">break</font>;
02811     <font class="keywordflow">case</font> CX_ITEREND:
02812       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Iter end %q"</font>, uentry_unparse (gc.cont.fcn));
02813       <font class="keywordflow">break</font>;
02814     <font class="keywordflow">default</font>:
02815       s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Un-unparseable context: %d"</font>, (<font class="keywordtype">int</font>) gc.kind);
02816       <font class="keywordflow">break</font>;
02817     }
02818   
02819   s = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"%q\naccess: %q"</font>, s, context_unparseAccess ());
02820   <font class="keywordflow">return</font> (s);
02821 }
02822 
02823 <font class="keyword">extern</font> ctype
<a name="l02824"></a><a class="code" href="context_c.html#a163">02824</a> <a class="code" href="context_c.html#a163">context_currentFunctionType</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02825 <font class="keyword"></font>{
02826   <font class="keywordflow">if</font> (gc.kind == CX_FUNCTION || gc.kind == CX_MACROFCN)
02827     {
02828             <font class="keywordflow">return</font> (<a class="code" href="uentry_c.html#a197">uentry_getType</a> (gc.cont.fcn));
02829     }
02830   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (gc.kind == CX_INNER)
02831     {
02832       llcontbuglit (<font class="stringliteral">"context_currentFunctionType: inner context"</font>);
02833       <font class="keywordflow">do</font> { <a class="code" href="context_c.html#a165">context_exitInnerPlain</a> (); } <font class="keywordflow">while</font> (gc.kind == CX_INNER);
02834       <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a163">context_currentFunctionType</a> ());
02835     }
02836   <font class="keywordflow">else</font>
02837     {
02838       llcontbuglit (<font class="stringliteral">"context_currentFunctionType: not in function"</font>);
02839       <font class="keywordflow">return</font> (ctype_undefined);
02840     }
02841 }
02842 
02843 <font class="keywordtype">void</font>
<a name="l02844"></a><a class="code" href="context_c.html#a164">02844</a> <a class="code" href="context_c.html#a164">context_enterInnerContext</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02845 <font class="keyword"></font>{
02846   <font class="keywordflow">if</font> (gc.kind == CX_GLOBAL)
02847     {
02848       gc.kind = CX_INNER;
02849       gc.cont.cdepth = 1;
02850     }
02851   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (gc.kind == CX_INNER)
02852     {
02853       gc.cont.cdepth++;
02854     }
02855   <font class="keywordflow">else</font>
02856     {
02857       ;
02858     }
02859 
02860   
02861   <a class="code" href="usymtab_c.html#a84">usymtab_enterScope</a> ();
02862   pushClause (NOCLAUSE);
02863 }
02864 
02865 <font class="keywordtype">void</font>
<a name="l02866"></a><a class="code" href="context_c.html#a165">02866</a> <a class="code" href="context_c.html#a165">context_exitInnerPlain</a> (<font class="keywordtype">void</font>) <font class="comment">/*@modifies gc;@*/</font>
02867 {
02868   <a class="code" href="context_c.html#a166">context_exitInner</a> (exprNode_undefined);
02869 }
02870 
02871 <font class="keywordtype">void</font>
<a name="l02872"></a><a class="code" href="context_c.html#a166">02872</a> <a class="code" href="context_c.html#a166">context_exitInner</a> (exprNode exp)<font class="keyword"></font>
02873 <font class="keyword"></font>{
02874   
02875   llassertprint (gc.inclause == NOCLAUSE || gc.inclause == CASECLAUSE,
02876                  ("inclause = %s", clause_nameTaken (gc.inclause)));
02877 
02878   <a class="code" href="clauseStack_c.html#a6">clauseStack_removeFirst</a> (gc.clauses, NOCLAUSE);
02879   gc.inclause = topClause (gc.clauses);
02880 
02881   <font class="keywordflow">if</font> (gc.kind == CX_INNER)
02882     {
02883       <font class="keywordflow">if</font> (--gc.cont.cdepth == 0)
02884         {
02885           gc.kind = CX_GLOBAL;
02886           gc.cont.glob = TRUE;
02887         }
02888     }
02889   <font class="keywordflow">else</font> 
02890     {
02891       <font class="keywordflow">if</font> (gc.kind == CX_GLOBAL)
02892         {
02893           llcontbuglit (<font class="stringliteral">"Attempt to exit global context"</font>);
02894           <font class="keywordflow">return</font>;
02895         }
02896     }
02897 
02898     <a class="code" href="usymtab_c.html#a108">usymtab_exitScope</a> (exp);
02899 }
02900 
02901 
02902 <font class="keywordtype">void</font>
<a name="l02903"></a><a class="code" href="context_c.html#a167">02903</a> <a class="code" href="context_c.html#a167">context_enterStructInnerContext</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02904 <font class="keyword"></font>{
02905   <font class="keywordflow">if</font> (gc.kind == CX_GLOBAL)
02906     {
02907       gc.kind = CX_INNER;
02908       gc.cont.cdepth = 1;
02909     }
02910   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (gc.kind == CX_INNER)
02911     {
02912       gc.cont.cdepth++;
02913     }
02914   <font class="keywordflow">else</font>
02915     {
02916       ;
02917     }
02918 
02919   <a class="code" href="usymtab_c.html#a84">usymtab_enterScope</a> ();
02920 }
02921 
02922 <font class="keywordtype">void</font>
<a name="l02923"></a><a class="code" href="context_c.html#a168">02923</a> <a class="code" href="context_c.html#a168">context_exitStructInnerContext</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02924 <font class="keyword"></font>{
02925   <font class="keywordflow">if</font> (gc.kind == CX_INNER)
02926     {
02927       <font class="keywordflow">if</font> (--gc.cont.cdepth == 0)
02928         {
02929           gc.kind = CX_GLOBAL;
02930           gc.cont.glob = TRUE;
02931         }
02932     }
02933   <font class="keywordflow">else</font> 
02934     {
02935       <font class="keywordflow">if</font> (gc.kind == CX_GLOBAL)
02936         {
02937           llcontbuglit (<font class="stringliteral">"Attempt to exit global context"</font>);
02938           <font class="keywordflow">return</font>;
02939         }
02940     }
02941 
02942   <a class="code" href="usymtab_c.html#a108">usymtab_exitScope</a> (exprNode_undefined);
02943 }
02944 
02945 <font class="keywordtype">void</font>
<a name="l02946"></a><a class="code" href="context_c.html#a169">02946</a> <a class="code" href="context_c.html#a169">context_exitInnerSafe</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
02947 <font class="keyword"></font>{
02948   
02949   <font class="keywordflow">if</font> (gc.kind == CX_INNER)
02950     {
02951       <font class="keywordflow">if</font> (--gc.cont.cdepth == 0)
02952         {
02953           gc.cont.cdepth++;
02954         }
02955     }
02956   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (gc.kind == CX_GLOBAL)
02957     {
02958       llcontbuglit (<font class="stringliteral">"Attempt to exit global context"</font>);
02959       <font class="keywordflow">return</font>;
02960     }
02961   <font class="keywordflow">else</font>
02962     {
02963       <font class="keywordflow">if</font> (<a class="code" href="usymtab_c.html#a63">usymtab_inDeepScope</a> ())
02964         {
02965           <a class="code" href="usymtab_c.html#a108">usymtab_exitScope</a> (exprNode_undefined);
02966         }
02967     }
02968 }
02969 
02970 <font class="keyword">static</font>
02971 <font class="keywordtype">void</font> setModuleAccess (<font class="keywordtype">void</font>)<font class="keyword"></font>
02972 <font class="keyword"></font>{
02973   gc.facct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> ();
02974 
02975   <font class="keywordflow">if</font> (fileId_isValid (currentFile ()))
02976     {
02977       cstring baseName = <a class="code" href="fileloc_c.html#a10">fileloc_getBase</a> (g_currentloc);
02978       
02979       <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_ACCESSFILE))
02980         {
02981           <font class="keywordflow">if</font> (<a class="code" href="usymtab_c.html#a129">usymtab_existsType</a> (baseName))
02982             {
02983               gc.facct = <a class="code" href="typeIdSet_c.html#a19">typeIdSet_insert</a> (gc.facct, 
02984                                            usymtab_getTypeId (baseName));
02985             }
02986           <font class="keywordflow">else</font> 
02987             {
02988               ;
02989             }
02990         }
02991       
02992       <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_ACCESSMODULE))
02993         {
02994           <font class="keywordtype">int</font> i;
02995           <font class="keywordtype">bool</font> hasaccess = FALSE;
02996           
02997           <font class="keywordflow">for</font> (i = 0; i &lt; gc.nmods; i++)
02998             {
02999               <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a18">cstring_equal</a> (baseName, gc.moduleaccess[i].file))
03000                 {
03001                   gc.facct = <a class="code" href="typeIdSet_c.html#a26">typeIdSet_union</a> (gc.facct, gc.moduleaccess[i].daccess);
03002 
03003                   hasaccess = TRUE;
03004                   <font class="keywordflow">break</font>;
03005                 }
03006             }
03007         }
03008       
03009       gc.acct = gc.facct;
03010       gc.inheader = fileId_isHeader (currentFile ());
03011     }
03012   <font class="keywordflow">else</font>
03013     {
03014       llcontbuglit (<font class="stringliteral">"Current file not defined\n"</font>);
03015       gc.facct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> ();
03016       gc.acct = gc.facct;
03017       gc.inheader = FALSE;
03018     }
03019   
03020   <font class="comment">/* 17 Jan 1995: forgot to clear nacct */</font>
03021   
03022   gc.nacct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> ();
03023 }
03024 
03025 <font class="keyword">static</font> <font class="keywordtype">void</font>
03026 context_enterFileAux (<font class="keywordtype">void</font>)<font class="keyword"></font>
03027 <font class="keyword"></font>{
03028   setModuleAccess ();
03029 }
03030 
03031 <font class="keywordtype">void</font>
<a name="l03032"></a><a class="code" href="context_c.html#a172">03032</a> <a class="code" href="context_c.html#a172">context_enterFile</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03033 <font class="keyword"></font>{
03034   context_enterFileAux ();
03035   <a class="code" href="usymtab_c.html#a82">usymtab_enterFile</a> ();
03036 }
03037 
03038 <font class="keywordtype">void</font>
<a name="l03039"></a><a class="code" href="context_c.html#a173">03039</a> <a class="code" href="context_c.html#a173">context_enterMacroFile</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03040 <font class="keyword"></font>{
03041   context_enterFileAux ();
03042 }
03043 
03044 <font class="keywordtype">bool</font> 
<a name="l03045"></a><a class="code" href="context_c.html#a174">03045</a> <a class="code" href="context_c.html#a174">context_inFunction</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03046 <font class="keyword"></font>{
03047   kcontext ck = gc.kind;
03048   
03049   <font class="keywordflow">return</font> ((ck == CX_FUNCTION) || (ck == CX_MACROFCN) || (ck == CX_INNER));
03050 }
03051 
03052 <font class="keywordtype">bool</font> 
<a name="l03053"></a><a class="code" href="context_c.html#a175">03053</a> <a class="code" href="context_c.html#a175">context_inFunctionLike</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03054 <font class="keyword"></font>{
03055   <font class="keywordflow">return</font> (gc.kind == CX_FUNCTION || gc.kind == CX_MACROFCN 
03056           || gc.kind == CX_UNKNOWNMACRO || gc.kind == CX_ITERDEF);
03057 }
03058 
03059 <font class="keywordtype">bool</font> 
<a name="l03060"></a><a class="code" href="context_c.html#a176">03060</a> <a class="code" href="context_c.html#a176">context_inRealFunction</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03061 <font class="keyword"></font>{
03062   kcontext ck = gc.kind;
03063   
03064   <font class="keywordflow">return</font> ((ck == CX_FUNCTION) || (ck == CX_MACROFCN));
03065 }
03066   
03067 <font class="keywordtype">void</font>
<a name="l03068"></a><a class="code" href="context_c.html#a177">03068</a> <a class="code" href="context_c.html#a177">context_processAllMacros</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03069 <font class="keyword"></font>{
03070   <a class="code" href="usymtab_c.html#a82">usymtab_enterFile</a> ();
03071 
03072   gc.inmacrocache = TRUE; 
03073   <a class="code" href="macrocache_c.html#a18">macrocache_processUndefinedElements</a> (gc.mc);
03074   <a class="code" href="llerror_c.html#a32">cleanupMessages</a> ();  
03075   <a class="code" href="usymtab_c.html#a83">usymtab_exitFile</a> ();
03076 
03077   gc.inmacrocache = FALSE;
03078   <a class="code" href="macrocache_c.html#a20">macrocache_finalize</a> ();
03079 }
03080 
03081 <font class="comment">/*</font>
03082 <font class="comment">** this happens once at the end of each C file</font>
03083 <font class="comment">**</font>
03084 <font class="comment">** check each Macro that was defined in current file.c or current file.h</font>
03085 <font class="comment">**</font>
03086 <font class="comment">*/</font>
03087 
03088 <font class="keyword">static</font> <font class="keywordtype">void</font>
03089 context_processMacros (<font class="keywordtype">void</font>)<font class="keyword"></font>
03090 <font class="keyword"></font>{
03091   <font class="keywordflow">if</font> (fileId_isValid (currentFile ()))
03092     {
03093       fileloc lastfl;
03094       cstring cbase = cstring_fromChars 
03095         (removePathFree
03096          (removeAnyExtension 
03097           (<a class="code" href="cstring_c.html#a29">cstring_toCharsSafe</a> (fileName (currentFile ())))));
03098       
03099       gc.inmacrocache = TRUE;
03100 
03101       DPRINTF ((<font class="stringliteral">"Processing macros: %s"</font>, cbase));
03102       lastfl = <a class="code" href="macrocache_c.html#a19">macrocache_processFileElements</a> (gc.mc, cbase);
03103       DPRINTF ((<font class="stringliteral">"Processing macros: %s"</font>, fileloc_unparse (lastfl)));
03104 
03105       <a class="code" href="cstring_c.html#a27">cstring_free</a> (cbase);
03106       
03107       <font class="keywordflow">if</font> (fileloc_isDefined (lastfl))
03108         {
03109           g_currentloc = <a class="code" href="fileloc_c.html#a6">fileloc_update</a> (g_currentloc, lastfl);
03110           <a class="code" href="llerror_c.html#a32">cleanupMessages</a> ();
03111         }
03112 
03113       gc.inmacrocache = FALSE;
03114     }
03115 }
03116 
03117 <font class="keywordtype">bool</font>
<a name="l03118"></a><a class="code" href="context_c.html#a179">03118</a> <a class="code" href="context_c.html#a179">context_processingMacros</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03119 <font class="keyword"></font>{
03120   <font class="keywordflow">return</font> (gc.inmacrocache);
03121 }
03122 
03123 <font class="keywordtype">void</font>
<a name="l03124"></a><a class="code" href="context_c.html#a180">03124</a> <a class="code" href="context_c.html#a180">context_exitFile</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03125 <font class="keyword"></font>{
03126   <font class="keywordflow">if</font> (gc.kind != CX_GLOBAL)
03127     {
03128       llfatalerrorLoc
03129         (cstring_makeLiteral (<font class="stringliteral">"File ended outside global scope"</font>));
03130     }
03131 
03132   <font class="keywordflow">if</font> (gc.insuppressregion)
03133     {
03134      <font class="comment">/* gack...don't reverse the order of these lines! ;-&gt; */</font>
03135       gc.insuppressregion = FALSE;
03136       llerrorlit (FLG_SYNTAX, 
03137                   <font class="stringliteral">"File ended in ignore errors region, "</font>
03138                   <font class="stringliteral">"possible missing /*@end*/"</font>);
03139     }
03140 
03141   <font class="comment">/* fix up parse errors */</font>
03142 
03143   <font class="keywordflow">while</font> (!<a class="code" href="usymtab_c.html#a138">usymtab_inFileScope</a> ())
03144     {
03145       <a class="code" href="usymtab_c.html#a106">usymtab_quietExitScope</a> (g_currentloc);
03146     }
03147 
03148   <font class="comment">/*</font>
03149 <font class="comment">  ** Clear the file-specific modifies information.</font>
03150 <font class="comment">  */</font>
03151   
03152   sRefSetList_elements (gc.modrecs, mods)<font class="keyword"></font>
03153 <font class="keyword">    </font>{
03154       <a class="code" href="sRefSet_c.html#a6">sRefSet_clearStatics</a> (mods);
03155           } end_sRefSetList_elements ;
03156   
03157   <a class="code" href="sRefSetList_c.html#a3">sRefSetList_clear</a> (gc.modrecs);
03158 
03159   context_processMacros ();
03160   <a class="code" href="llerror_c.html#a32">cleanupMessages</a> (); 
03161 
03162   <a class="code" href="usymtab_c.html#a83">usymtab_exitFile</a> ();
03163 
03164   gc.inDerivedFile = FALSE;
03165   <a class="code" href="filelocStack_c.html#a5">filelocStack_clear</a> (gc.locstack);
03166 
03167   gc.nacct = <a class="code" href="typeIdSet_c.html#a14">typeIdSet_emptySet</a> (); <font class="comment">/* empty noaccess */</font>
03168 
03169   gc.cont.glob = TRUE;
03170   
03171   <font class="keywordflow">if</font> (gc.savedFlags)
03172     {
03173       context_restoreFlagSettings ();
03174       gc.savedFlags = FALSE;
03175     }
03176 }
03177 
03178 <font class="keywordtype">void</font>
<a name="l03179"></a><a class="code" href="context_c.html#a181">03179</a> <a class="code" href="context_c.html#a181">context_exitMacroCache</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03180 <font class="keyword"></font>{
03181   <font class="keywordflow">if</font> (gc.kind != CX_GLOBAL)
03182     {
03183       <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a235">context_inMacro</a> ()) <font class="comment">/* this is okay, file could end without newline in macro */</font>
03184         {
03185           <a class="code" href="context_c.html#a129">context_exitFunction</a> ();
03186         }
03187       <font class="keywordflow">else</font>
03188         {
03189           llcontbug (message (<font class="stringliteral">"context_exitMacroCache: outside global scope: %q"</font>, 
03190                               context_unparse ()));
03191           gc.kind = CX_GLOBAL; 
03192         }
03193     }
03194 
03195   <font class="comment">/*</font>
03196 <font class="comment">  ** no longer valid here</font>
03197 <font class="comment">  ** if (gc.insuppressregion)</font>
03198 <font class="comment">  **   {</font>
03199 <font class="comment">  **     gc.insuppressregion = FALSE;</font>
03200 <font class="comment">  **     llerror ("File ended in ignore errors region, possible missing @");</font>
03201 <font class="comment">  **   }</font>
03202 <font class="comment">  */</font>
03203 
03204   gc.cont.glob = TRUE;
03205 }
03206 
03207 <font class="keywordtype">void</font>
<a name="l03208"></a><a class="code" href="context_c.html#a182">03208</a> <a class="code" href="context_c.html#a182">context_saveLocation</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03209 <font class="keyword"></font>{
03210   <font class="comment">/* was llassert (fileloc_isUndefined (gc.saveloc)) */</font>
03211       <a class="code" href="fileloc_c.html#a8">fileloc_free</a> (gc.saveloc);
03212     
03213 
03214   gc.saveloc = <a class="code" href="fileloc_c.html#a5">fileloc_copy</a> (g_currentloc);
03215   }
03216 
03217 fileloc
<a name="l03218"></a><a class="code" href="context_c.html#a183">03218</a> <a class="code" href="context_c.html#a183">context_getSaveLocation</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03219 <font class="keyword"></font>{
03220   fileloc fl = gc.saveloc;
03221 
03222     gc.saveloc = fileloc_undefined;
03223   <font class="keywordflow">return</font> fl;
03224 }
03225 
03226 <font class="comment">/*@observer@*/</font> cstring
<a name="l03227"></a><a class="code" href="context_c.html#a184">03227</a> <a class="code" href="context_c.html#a184">context_inFunctionName</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03228 <font class="keyword"></font>{
03229   <font class="keywordflow">if</font> (gc.kind == CX_FUNCTION
03230       || gc.kind == CX_MACROFCN || gc.kind == CX_UNKNOWNMACRO 
03231       || gc.kind == CX_MACROCONST 
03232       || gc.kind == CX_ITERDEF || gc.kind == CX_ITEREND)
03233     {
03234       <font class="keywordflow">return</font> (<a class="code" href="uentry_c.html#a194">uentry_rawName</a> (gc.cont.fcn));
03235     }
03236   <font class="keywordflow">else</font>
03237     {
03238       llcontbuglit (<font class="stringliteral">"context_inFunctionName: not in function"</font>);
03239       <font class="keywordflow">return</font> (cstring_undefined);
03240     }
03241 }
03242 
03243 <font class="keywordtype">void</font>
<a name="l03244"></a><a class="code" href="context_c.html#a185">03244</a> <a class="code" href="context_c.html#a185">context_userSetFlag</a> (flagcode f, <font class="keywordtype">bool</font> b)<font class="keyword"></font>
03245 <font class="keyword"></font>{
03246   DPRINTF ((<font class="stringliteral">"set flag: %s"</font>, flagcode_name (f)));
03247 
03248   <font class="keywordflow">if</font> (f == FLG_NEVERINCLUDE &amp;&amp; b)
03249     {
03250       <font class="keywordflow">if</font> (gc.flags[FLG_EXPORTHEADER])
03251         {
03252           <a class="code" href="llerror_c.html#a24">flagWarning</a> (cstring_makeLiteralTemp
03253                        (<font class="stringliteral">"setting +neverinclude after +exportheader.  "</font>
03254                         <font class="stringliteral">"Turning off exportheader, since headers are not checked "</font>
03255                         <font class="stringliteral">"when +neverinclude is used."</font>));
03256 
03257           gc.flags[FLG_EXPORTHEADER] = FALSE;
03258         }
03259     }
03260   <font class="keywordflow">else</font> 
03261     {
03262       <font class="keywordflow">if</font> (f == FLG_EXPORTHEADER &amp;&amp; b)
03263         {
03264           <font class="keywordflow">if</font> (gc.flags[FLG_NEVERINCLUDE])
03265             {
03266               <a class="code" href="llerror_c.html#a24">flagWarning</a> (cstring_makeLiteralTemp
03267                            (<font class="stringliteral">"setting +exportheader after +neverinclude.  "</font>
03268                             <font class="stringliteral">"Not setting exportheader, since headers are not checked "</font>
03269                             <font class="stringliteral">"when +neverinclude is used."</font>));
03270               gc.flags[FLG_EXPORTHEADER] = FALSE;
03271               <font class="keywordflow">return</font>;
03272             }
03273         }
03274     }
03275   
03276   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_WARNFLAGS) &amp;&amp; f != FLG_NOF &amp;&amp; f != FLG_OPTF)
03277     {
03278       <font class="keywordtype">bool</font> lastsetting = <a class="code" href="context_c.html#a189">context_getFlag</a> (f);
03279       
03280       <font class="keywordflow">if</font> (bool_equal (lastsetting, b)
03281           &amp;&amp; !<a class="code" href="flags_c.html#a15">flagcode_isSpecialFlag</a> (f) 
03282           &amp;&amp; !<a class="code" href="flags_c.html#a17">flagcode_isIdemFlag</a> (f)
03283           &amp;&amp; !<a class="code" href="flags_c.html#a41">flagcode_hasArgument</a> (f))
03284         {
03285           cstring warn = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"setting %s%s redundant with current value"</font>, 
03286                                   cstring_makeLiteralTemp (b ? <font class="stringliteral">"+"</font> : <font class="stringliteral">"-"</font>),
03287                                   <a class="code" href="flags_c.html#a34">flagcode_name</a> (f));
03288           <a class="code" href="llerror_c.html#a24">flagWarning</a> (warn);
03289           <a class="code" href="cstring_c.html#a27">cstring_free</a> (warn);
03290         }
03291     }
03292 
03293   <font class="keywordflow">if</font> (flagcode_isLibraryFlag (f)) 
03294     {
03295       <font class="keywordflow">if</font> (gc.library != FLG_ANSILIB
03296           &amp;&amp; gc.library != f)
03297         {
03298           cstring warn = <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"selecting library %s after library %s was "</font>
03299                                   <font class="stringliteral">"selected (only one library may be used)"</font>,
03300                                   flagcode_name (f),
03301                                   <a class="code" href="flags_c.html#a34">flagcode_name</a> (gc.library));
03302           <a class="code" href="llerror_c.html#a24">flagWarning</a> (warn);
03303           <a class="code" href="cstring_c.html#a27">cstring_free</a> (warn);
03304         }
03305 
03306       <font class="keywordflow">if</font> (f == FLG_UNIXLIB)
03307         {
03308           <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a189">context_getFlag</a> (FLG_WARNUNIXLIB))
03309             {
03310               <a class="code" href="llerror_c.html#a24">flagWarning</a> (cstring_makeLiteralTemp 
03311                            (<font class="stringliteral">"selecting unix library.  Unix library is "</font>
03312                             <font class="stringliteral">"ad hoc addition to POSIX library.  Recommend "</font>
03313                             <font class="stringliteral">"use +posixlib to select POSIX library instead. "</font>
03314                             <font class="stringliteral">"Use -warnunixlib to suppress this message."</font>));
03315             }
03316         }
03317       
03318       gc.library = f;
03319     }
03320   
03321   gc.setGlobally[f] = TRUE;
03322   context_setFlag (f, b);
03323 }
03324 
03325 <font class="keywordtype">void</font>
<a name="l03326"></a><a class="code" href="context_c.html#a186">03326</a> <a class="code" href="context_c.html#a186">context_fileSetFlag</a> (flagcode f, ynm set)<font class="keyword"></font>
03327 <font class="keyword"></font>{
03328   <font class="keywordflow">if</font> (!gc.savedFlags)
03329     {
03330       context_saveFlagSettings ();
03331     }
03332 
03333   <font class="keywordflow">if</font> (ynm_isOff (set))
03334     {
03335       context_setFlagAux (f, FALSE, TRUE, FALSE);
03336     }
03337   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (ynm_isOn (set))
03338     {
03339       context_setFlagAux (f, TRUE, TRUE, FALSE);
03340       gc.setLocally[f] = TRUE;
03341     }
03342   <font class="keywordflow">else</font>
03343     {
03344       context_restoreFlag (f);
03345     }
03346 }
03347 
03348 <font class="keyword">static</font> <font class="keywordtype">void</font>
03349 context_restoreFlag (flagcode f)<font class="keyword"></font>
03350 <font class="keyword"></font>{
03351   
03352   <font class="keywordflow">if</font> (!gc.savedFlags)
03353     {
03354       voptgenerror 
03355         (FLG_SYNTAX,
03356          <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Attempt to restore flag %s when no file scope flags "</font>
03357                   <font class="stringliteral">"have been set."</font>,
03358                   flagcode_unparse (f)),
03359          g_currentloc);
03360     }
03361   <font class="keywordflow">else</font>
03362     {
03363       context_addFlagMarker (f, MAYBE);
03364       context_setFlagAux (f, gc.saveflags[f], FALSE, TRUE);
03365     }
03366 
03367   }
03368 
03369 <font class="keyword">static</font> <font class="keywordtype">void</font>
03370 context_setFlag (flagcode f, <font class="keywordtype">bool</font> b)<font class="keyword"></font>
03371 <font class="keyword"></font>{
03372   context_setFlagAux (f, b, FALSE, FALSE);
03373 }
03374 
03375 <font class="keywordtype">void</font>
<a name="l03376"></a><a class="code" href="context_c.html#a187">03376</a> <a class="code" href="context_c.html#a187">context_setFlagTemp</a> (flagcode f, <font class="keywordtype">bool</font> b)<font class="keyword"></font>
03377 <font class="keyword"></font>{
03378   DPRINTF ((<font class="stringliteral">"Set flag temp: %s / %s"</font>, flagcode_unparse (f), bool_unparse (b)));
03379   gc.flags[f] = b;
03380 }
03381 
03382 <font class="comment">/*@notfunction@*/</font>
<a name="l03383"></a><a class="code" href="context_c.html#a1">03383</a> <font class="preprocessor"># define DOSET(ff,b) \</font>
03384 <font class="preprocessor">   do { if (inFile) { gc.setLocally[ff] = TRUE; \</font>
03385 <font class="preprocessor">                      context_addFlagMarker (ff, ynm_fromBool (b)); } \</font>
03386 <font class="preprocessor">        DPRINTF (("set flag: %s / %s", flagcode_name (ff), bool_unparse (b))); \</font>
03387 <font class="preprocessor">        gc.flags[ff] = b; } while (FALSE)</font>
03388 <font class="preprocessor"></font>
03389 <font class="keyword">static</font> <font class="keywordtype">void</font>
03390   context_setFlagAux (flagcode f, <font class="keywordtype">bool</font> b, <font class="keywordtype">bool</font> 
03391                       inFile, <font class="comment">/*@unused@*/</font> <font class="keywordtype">bool</font> isRestore)<font class="keyword"></font>
03392 <font class="keyword"></font>{
03393   DPRINTF ((<font class="stringliteral">"set flag: %s / %s"</font>, flagcode_unparse (f), bool_unparse (b)));
03394 
03395   <font class="keywordflow">if</font> (f == FLG_USESTDERR) 
03396     {
03397       <font class="keywordflow">if</font> (b) {
03398         g_msgstream = stderr;
03399       } <font class="keywordflow">else</font> {
03400         g_msgstream = stdout;
03401       }
03402     }
03403 
03404   <font class="keywordflow">if</font> (<a class="code" href="flags_c.html#a15">flagcode_isSpecialFlag</a> (f))
03405     {
03406       gc.flags[f] = b;
03407 
03408       
03409       <font class="keywordflow">switch</font> (f)
03410         {     
03411         <font class="keywordflow">case</font> FLG_ALLEMPTY:
03412           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ALLEMPTY, b);
03413           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_IFEMPTY, b);
03414           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_WHILEEMPTY, b);
03415           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_FOREMPTY, b);
03416           <font class="keywordflow">break</font>;
03417         <font class="keywordflow">case</font> FLG_PREDBOOL:
03418           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_PREDBOOL, b);
03419           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_PREDBOOLINT, b);
03420           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_PREDBOOLPTR, b);
03421           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_PREDBOOLOTHERS, b);
03422           <font class="keywordflow">break</font>;
03423         <font class="keywordflow">case</font> FLG_GLOBALIAS:
03424           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CHECKSTRICTGLOBALIAS, b);
03425           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CHECKEDGLOBALIAS, b);
03426           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CHECKMODGLOBALIAS, b);
03427           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_UNCHECKEDGLOBALIAS, b);
03428           <font class="keywordflow">break</font>;
03429         <font class="keywordflow">case</font> FLG_ALLBLOCK:
03430           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ALLBLOCK, b);
03431           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_IFBLOCK, b);
03432           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_WHILEBLOCK, b);
03433           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_FORBLOCK, b);
03434           <font class="keywordflow">break</font>;
03435         <font class="keywordflow">case</font> FLG_GRAMMAR:
03436           <font class="keywordflow">if</font> (b)
03437             {
03438               yydebug = 1;
03439             }
03440           <font class="keywordflow">else</font>
03441             {
03442               yydebug = 0;
03443             }
03444           
03445           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_GRAMMAR, b);
03446           <font class="keywordflow">break</font>;
03447         <font class="keywordflow">case</font> FLG_CODEIMPONLY:
03448           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CODEIMPONLY, b);
03449           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_GLOBIMPONLY, b);
03450           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_RETIMPONLY, b);
03451           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_STRUCTIMPONLY, b);
03452           <font class="keywordflow">break</font>;
03453         <font class="keywordflow">case</font> FLG_SPECALLIMPONLY:
03454                   <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SPECALLIMPONLY, b);
03455           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SPECGLOBIMPONLY, b);
03456           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SPECRETIMPONLY, b);
03457           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SPECSTRUCTIMPONLY, b);
03458           <font class="keywordflow">break</font>;
03459         <font class="keywordflow">case</font> FLG_ALLIMPONLY:
03460           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ALLIMPONLY, b);
03461           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_GLOBIMPONLY, b);
03462           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_RETIMPONLY, b);
03463           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_STRUCTIMPONLY, b);
03464           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SPECGLOBIMPONLY, b);
03465           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SPECRETIMPONLY, b);
03466           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SPECSTRUCTIMPONLY, b);
03467           <font class="keywordflow">break</font>;
03468         <font class="keywordflow">case</font> FLG_ANSILIMITS: 
03469           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ANSILIMITS, b);
03470           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CONTROLNESTDEPTH, b);
03471           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_STRINGLITERALLEN, b);
03472           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_INCLUDENEST, b);
03473           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NUMSTRUCTFIELDS, b);
03474           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NUMENUMMEMBERS, b);
03475           
03476           <font class="keywordflow">if</font> (b)
03477             {
03478               context_setValue (FLG_CONTROLNESTDEPTH, DEFAULT_CONTROLNESTDEPTH);
03479               context_setValue (FLG_STRINGLITERALLEN, DEFAULT_STRINGLITERALLEN);
03480               context_setValue (FLG_INCLUDENEST, DEFAULT_INCLUDENEST);
03481               context_setValue (FLG_NUMSTRUCTFIELDS, DEFAULT_NUMSTRUCTFIELDS);
03482               context_setValue (FLG_NUMENUMMEMBERS, DEFAULT_NUMENUMMEMBERS);
03483             }
03484           <font class="keywordflow">break</font>;
03485         <font class="keywordflow">case</font> FLG_EXTERNALNAMELEN:
03486           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_DISTINCTEXTERNALNAMES, TRUE);
03487           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXTERNALNAMELEN, TRUE);
03488           <font class="keywordflow">break</font>;
03489         <font class="keywordflow">case</font> FLG_INTERNALNAMELEN:
03490           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_DISTINCTINTERNALNAMES, TRUE);
03491           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_INTERNALNAMELEN, TRUE);
03492           <font class="keywordflow">break</font>;
03493         <font class="keywordflow">case</font> FLG_EXTERNALNAMECASEINSENSITIVE:
03494           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXTERNALNAMECASEINSENSITIVE, b);
03495 
03496           <font class="keywordflow">if</font> (b &amp;&amp; !gc.flags[FLG_DISTINCTEXTERNALNAMES])
03497             {
03498               <a class="code" href="context_c.html#a1">DOSET</a> (FLG_DISTINCTEXTERNALNAMES, TRUE);
03499               context_setValue (FLG_EXTERNALNAMELEN, 0);
03500             }
03501           <font class="keywordflow">break</font>;
03502         <font class="keywordflow">case</font> FLG_INTERNALNAMECASEINSENSITIVE:
03503           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_INTERNALNAMECASEINSENSITIVE, b);
03504 
03505           <font class="keywordflow">if</font> (b &amp;&amp; !gc.flags[FLG_DISTINCTINTERNALNAMES])
03506             {
03507               <a class="code" href="context_c.html#a1">DOSET</a> (FLG_DISTINCTINTERNALNAMES, TRUE);
03508               context_setValue (FLG_INTERNALNAMELEN, 0);
03509             }
03510           <font class="keywordflow">break</font>;
03511         <font class="keywordflow">case</font> FLG_INTERNALNAMELOOKALIKE:
03512           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_INTERNALNAMELOOKALIKE, b);
03513 
03514           <font class="keywordflow">if</font> (b &amp;&amp; !gc.flags[FLG_DISTINCTINTERNALNAMES])
03515             {
03516               <a class="code" href="context_c.html#a1">DOSET</a> (FLG_DISTINCTINTERNALNAMES, TRUE);
03517               context_setValue (FLG_INTERNALNAMELEN, 0);
03518             }
03519           <font class="keywordflow">break</font>;
03520         <font class="keywordflow">case</font> FLG_MODUNSPEC:
03521           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MODNOMODS, b);
03522           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MODGLOBSUNSPEC, b);
03523           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MODSTRICTGLOBSUNSPEC, b);
03524           <font class="keywordflow">break</font>;
03525         <font class="keywordflow">case</font> FLG_EXPORTANY: 
03526           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXPORTVAR, b);
03527           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXPORTFCN, b);
03528           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXPORTTYPE, b);
03529           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXPORTMACRO, b);
03530           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXPORTCONST, b);
03531           gc.anyExports = TRUE;
03532           <font class="keywordflow">break</font>;
03533         <font class="keywordflow">case</font> FLG_REPEXPOSE:
03534           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_RETEXPOSE, b); 
03535           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ASSIGNEXPOSE, b); 
03536           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CASTEXPOSE, b); 
03537           <font class="keywordflow">break</font>;
03538         <font class="keywordflow">case</font> FLG_RETVAL:
03539           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_RETVALBOOL, b);
03540           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_RETVALINT, b);
03541           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_RETVALOTHER, b);
03542           <font class="keywordflow">break</font>;
03543         <font class="keywordflow">case</font> FLG_PARTIAL:
03544           <font class="keywordflow">if</font> (b)
03545             {
03546               <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXPORTLOCAL, FALSE);
03547               <a class="code" href="context_c.html#a1">DOSET</a> (FLG_DECLUNDEF, FALSE);
03548               <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SPECUNDEF, FALSE);
03549               <a class="code" href="context_c.html#a1">DOSET</a> (FLG_TOPUNUSED, FALSE);
03550             }
03551           <font class="keywordflow">break</font>;
03552         <font class="keywordflow">case</font> FLG_DEEPBREAK:
03553           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_LOOPLOOPBREAK, b);
03554           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_LOOPSWITCHBREAK, b);
03555           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SWITCHLOOPBREAK, b);
03556           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SWITCHSWITCHBREAK, b);
03557           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_LOOPLOOPCONTINUE, b);
03558           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_DEEPBREAK, b);
03559           <font class="keywordflow">break</font>;
03560         <font class="keywordflow">case</font> FLG_ACCESSALL:
03561           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ACCESSMODULE, b);
03562           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ACCESSFILE, b);
03563           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ACCESSCZECH, b);
03564           <font class="keywordflow">break</font>;
03565         <font class="keywordflow">case</font> FLG_ALLMACROS:
03566           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ALLMACROS, b);
03567           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_FCNMACROS, b);
03568           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CONSTMACROS, b);
03569           <font class="keywordflow">break</font>;
03570         <font class="keywordflow">case</font> FLG_CZECH:
03571           <font class="keywordflow">if</font> (b) { <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ACCESSCZECH, b); }
03572           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CZECHFUNCTIONS, b);
03573           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CZECHVARS, b);
03574           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CZECHCONSTANTS, b);
03575           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CZECHTYPES, b);
03576           <font class="keywordflow">break</font>;
03577         <font class="keywordflow">case</font> FLG_SLOVAK:
03578           <font class="keywordflow">if</font> (b) { <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ACCESSSLOVAK, b); }
03579           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SLOVAKFUNCTIONS, b);
03580           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SLOVAKVARS, b);
03581           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SLOVAKCONSTANTS, b);
03582           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SLOVAKTYPES, b);
03583           <font class="keywordflow">break</font>;
03584         <font class="keywordflow">case</font> FLG_CZECHOSLOVAK:
03585           <font class="keywordflow">if</font> (b) { <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ACCESSCZECHOSLOVAK, b); }
03586           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CZECHOSLOVAKFUNCTIONS, b);
03587           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CZECHOSLOVAKVARS, b);
03588           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CZECHOSLOVAKCONSTANTS, b);
03589           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_CZECHOSLOVAKTYPES, b);
03590           <font class="keywordflow">break</font>;
03591         <font class="keywordflow">case</font> FLG_NULL:
03592           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLSTATE, b);
03593           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLDEREF, b);
03594           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLASSIGN, b);
03595           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLPASS, b);
03596           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLRET, b);
03597           <font class="keywordflow">break</font>;
03598         <font class="keywordflow">case</font> FLG_MEMCHECKS:
03599           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLSTATE, b);
03600           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLDEREF, b);
03601           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLASSIGN, b);
03602           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLPASS, b);
03603           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NULLRET, b);
03604           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_COMPDEF, b);
03605           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_COMPMEMPASS, b);
03606           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_UNIONDEF, b);
03607           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MEMTRANS, b);
03608           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_USERELEASED, b);
03609           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ALIASUNIQUE, b);
03610           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MAYALIASUNIQUE, b);
03611           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MUSTFREE, b);
03612           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MUSTDEFINE, b);
03613           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_GLOBSTATE, b); 
03614           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_COMPDESTROY, b);
03615           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MUSTNOTALIAS, b);
03616           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MEMIMPLICIT, b);
03617           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_BRANCHSTATE, b); 
03618           <font class="comment">/*@fallthrough@*/</font> <font class="comment">/* also sets memtrans flags */</font>
03619         <font class="keywordflow">case</font> FLG_MEMTRANS:
03620           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_MEMTRANS, b);
03621           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_EXPOSETRANS, b);
03622           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_OBSERVERTRANS, b);
03623           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_DEPENDENTTRANS, b);
03624           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_NEWREFTRANS, b);
03625           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_ONLYTRANS, b);
03626           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_OWNEDTRANS, b);
03627           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_FRESHTRANS, b);
03628           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_SHAREDTRANS, b);
03629           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_TEMPTRANS, b);
03630           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_KEPTTRANS, b);
03631           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_REFCOUNTTRANS, b);
03632           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_STATICTRANS, b);
03633           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_UNKNOWNTRANS, b);
03634           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_KEEPTRANS, b);
03635           <a class="code" href="context_c.html#a1">DOSET</a> (FLG_IMMEDIATETRANS, b);
03636           <font class="keywordflow">break</font>;
03637 
03638         <font class="keywordflow">default</font>:
03639           llcontbug (message (<font class="stringliteral">"Unhandled special flag: %s"</font>, 
03640                               flagcode_unparse (f)));
03641           <font class="keywordflow">break</font>;
03642         }
03643     }
03644   <font class="keywordflow">else</font>
03645     {
03646       <font class="keywordflow">if</font> (<a class="code" href="flags_c.html#a17">flagcode_isIdemFlag</a> (f))
03647         {
03648           <a class="code" href="context_c.html#a1">DOSET</a> (f, TRUE);
03649         }
03650       <font class="keywordflow">else</font>
03651         {
03652           <font class="keywordflow">if</font> (b &amp;&amp; !gc.anyExports
03653               &amp;&amp; (f == FLG_EXPORTVAR || f == FLG_EXPORTFCN
03654                   || f == FLG_EXPORTTYPE || f == FLG_EXPORTMACRO
03655                   || f == FLG_EXPORTCONST
03656                   || f == FLG_EXPORTANY))
03657             {
03658               gc.anyExports = TRUE;
03659             }
03660 
03661           <a class="code" href="context_c.html#a1">DOSET</a> (f, b);
03662         }
03663     }
03664 }
03665 
03666 <font class="keywordtype">bool</font> 
<a name="l03667"></a><a class="code" href="context_c.html#a188">03667</a> <a class="code" href="context_c.html#a188">context_maybeSet</a> (flagcode d)<font class="keyword"></font>
03668 <font class="keyword"></font>{
03669   <font class="keywordflow">return</font> (gc.flags[d] || gc.setLocally[d]);
03670 }
03671 
03672 <font class="keywordtype">bool</font>
<a name="l03673"></a><a class="code" href="context_c.html#a189">03673</a> <a class="code" href="context_c.html#a189">context_getFlag</a> (flagcode d)<font class="keyword"></font>
03674 <font class="keyword"></font>{
03675   <font class="keywordflow">return</font> (gc.flags[d]);
03676 }
03677 
03678 <font class="keyword">static</font> <font class="keywordtype">void</font> context_saveFlagSettings (<font class="keywordtype">void</font>)<font class="keyword"></font>
03679 <font class="keyword"></font>{
03680   gc.savedFlags = TRUE;
03681   llassert (<font class="keyword">sizeof</font> (gc.saveflags) == <font class="keyword">sizeof</font> (gc.flags));
03682   memcpy (gc.saveflags, gc.flags, sizeof (gc.flags));
03683 }
03684 
03685 <font class="keyword">static</font> <font class="keywordtype">void</font> context_restoreFlagSettings (<font class="keywordtype">void</font>)<font class="keyword"></font>
03686 <font class="keyword"></font>{
03687   llassert (<font class="keyword">sizeof</font> (gc.saveflags) == <font class="keyword">sizeof</font> (gc.flags));
03688   memcpy (gc.flags, gc.saveflags, sizeof (gc.flags));
03689   gc.savedFlags = FALSE;
03690 }
03691 
<a name="l03692"></a><a class="code" href="context_c.html#a190">03692</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a190">context_setFilename</a> (fileId fid, <font class="keywordtype">int</font> lineno) 
03693    <font class="comment">/*@globals fileloc g_currentloc;@*/</font>
03694    <font class="comment">/*@modifies g_currentloc@*/</font>
03695 {
03696   <font class="keywordflow">if</font> (fileId_baseEqual (currentFile (), fid))
03697     {
03698       setLine (lineno);
03699       <font class="keywordflow">return</font>;
03700     }
03701   <font class="keywordflow">else</font>
03702     {
03703       fileloc_setColumn (g_currentloc, 0);
03704 
03705       <font class="keywordflow">if</font> (<a class="code" href="fileloc_c.html#a42">fileloc_isSpecialFile</a> (g_currentloc))
03706         {
03707           gc.inDerivedFile = TRUE;
03708         }
03709 
03710       <font class="keywordflow">if</font> (<a class="code" href="filelocStack_c.html#a6">filelocStack_popPushFile</a> (gc.locstack, g_currentloc))
03711         {
03712           <font class="keywordtype">int</font> maxdepth = <a class="code" href="context_c.html#a151">context_getValue</a> (FLG_INCLUDENEST);
03713 
03714           <font class="keywordflow">if</font> (filelocStack_size (gc.locstack) &gt; maxdepth)
03715             {
03716               <font class="keywordtype">int</font> depth = <a class="code" href="filelocStack_c.html#a8">filelocStack_includeDepth</a> (gc.locstack);
03717               
03718               <font class="keywordflow">if</font> (depth &gt; maxdepth)
03719                 {
03720                   <font class="keywordflow">if</font> (optgenerror 
03721                       (FLG_INCLUDENEST,
03722                        <a class="code" href="message_c.html#a18">message</a> (<font class="stringliteral">"Maximum include nesting depth "</font>
03723                                 <font class="stringliteral">"(%d, current depth %d) exceeded"</font>,
03724                                 maxdepth,
03725                                 depth),
03726                        <a class="code" href="filelocStack_c.html#a4">filelocStack_nextTop</a> (gc.locstack)))
03727                     {
03728                       <a class="code" href="filelocStack_c.html#a9">filelocStack_printIncludes</a> (gc.locstack);
03729                     }
03730                 }
03731             }
03732         }
03733       
03734       g_currentloc = <a class="code" href="fileloc_c.html#a34">fileloc_create</a> (fid, lineno, 1);
03735       gc.inheader = fileId_isHeader (currentFile ());
03736 
03737       context_enterFileAux ();
03738     }
03739 }
03740 
<a name="l03741"></a><a class="code" href="context_c.html#a191">03741</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a191">context_enterIterDef</a> (<font class="comment">/*@observer@*/</font> uentry le)<font class="keyword"></font>
03742 <font class="keyword"></font>{
03743     <a class="code" href="context_c.html#a71">context_enterMacro</a> (le);
03744   gc.acct = <a class="code" href="typeIdSet_c.html#a23">typeIdSet_subtract</a> (gc.facct, gc.nacct);
03745   gc.kind = CX_ITERDEF;
03746 }
03747 
<a name="l03748"></a><a class="code" href="context_c.html#a192">03748</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a192">context_enterIterEnd</a> (<font class="comment">/*@observer@*/</font> uentry le)<font class="keyword"></font>
03749 <font class="keyword"></font>{
03750     <a class="code" href="context_c.html#a71">context_enterMacro</a> (le);
03751   gc.kind = CX_ITEREND;
03752 }
03753 
03754 <font class="keywordtype">void</font> 
<a name="l03755"></a><a class="code" href="context_c.html#a193">03755</a> <a class="code" href="context_c.html#a193">context_destroyMod</a> (<font class="keywordtype">void</font>) 
03756    <font class="comment">/*@globals killed gc@*/</font>
03757 {
03758   setCodePoint ();
03759   <a class="code" href="ctype_c.html#a18">ctype_destroyMod</a> ();
03760   setCodePoint ();
03761   <a class="code" href="usymtab_c.html#a136">usymtab_free</a> ();
03762   setCodePoint ();
03763   <a class="code" href="fileTable_c.html#a34">fileTable_free</a> (gc.ftab);
03764   <a class="code" href="filelocStack_c.html#a10">filelocStack_free</a> (gc.locstack);
03765   setCodePoint ();
03766   gc.ftab = fileTable_undefined;
03767 
03768   <a class="code" href="macrocache_c.html#a12">macrocache_free</a> (gc.mc);
03769   <a class="code" href="general_c.html#a0">sfree</a> (gc.moduleaccess);
03770   setCodePoint ();
03771 
03772   <a class="code" href="fileloc_c.html#a8">fileloc_free</a> (gc.saveloc); gc.saveloc = fileloc_undefined;
03773   <a class="code" href="fileloc_c.html#a8">fileloc_free</a> (gc.pushloc); gc.pushloc = fileloc_undefined;
03774 
03775   setCodePoint ();
03776   <a class="code" href="sRefSetList_c.html#a4">sRefSetList_free</a> (gc.modrecs);
03777   setCodePoint ();
03778   <a class="code" href="flagMarkerList_c.html#a6">flagMarkerList_free</a> (gc.markers); 
03779   setCodePoint ();
03780   <a class="code" href="messageLog_c.html#a9">messageLog_free</a> (gc.msgLog);
03781   setCodePoint ();
03782   <a class="code" href="clauseStack_c.html#a10">clauseStack_free</a> (gc.clauses);
03783   setCodePoint ();
03784   
03785   <a class="code" href="cstring_c.html#a27">cstring_free</a> (gc.msgAnnote);
03786   <a class="code" href="globSet_c.html#a8">globSet_free</a> (gc.globs_used);
03787   }
03788 
03789 <font class="comment">/*</font>
03790 <font class="comment">** Flag shortcuts.</font>
03791 <font class="comment">*/</font>
03792 
<a name="l03793"></a><a class="code" href="context_c.html#a194">03793</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a194">context_msgBoolInt</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03794 <font class="keyword"></font>{
03795   <font class="keywordflow">return</font> gc.flags [FLG_BOOLINT];
03796 }
03797 
<a name="l03798"></a><a class="code" href="context_c.html#a195">03798</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a195">context_msgCharInt</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03799 <font class="keyword"></font>{
03800   <font class="keywordflow">return</font> gc.flags [FLG_CHARINT];
03801 }
03802 
<a name="l03803"></a><a class="code" href="context_c.html#a196">03803</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a196">context_msgEnumInt</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03804 <font class="keyword"></font>{
03805   <font class="keywordflow">return</font> gc.flags [FLG_ENUMINT];
03806 }
03807 
<a name="l03808"></a><a class="code" href="context_c.html#a197">03808</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a197">context_msgPointerArith</a> (<font class="keywordtype">void</font>)<font class="keyword"> </font>
03809 <font class="keyword"></font>{
03810   <font class="keywordflow">return</font> gc.flags [FLG_POINTERARITH];
03811 }
03812 
<a name="l03813"></a><a class="code" href="context_c.html#a198">03813</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a198">context_msgStrictOps</a> (<font class="keywordtype">void</font>)<font class="keyword"> </font>
03814 <font class="keyword"></font>{
03815   <font class="keywordflow">return</font> gc.flags [FLG_STRICTOPS];
03816 }
03817 
03818 <font class="preprocessor"># ifndef NOLCL</font>
<a name="l03819"></a><a class="code" href="context_c.html#a199">03819</a> <font class="preprocessor"></font><font class="keywordtype">bool</font> <a class="code" href="context_c.html#a199">context_msgLh</a> (<font class="keywordtype">void</font>)<font class="keyword">           </font>
03820 <font class="keyword"></font>{
03821   <font class="keywordflow">return</font> gc.flags [FLG_DOLH];
03822 }
03823 <font class="preprocessor"># endif</font>
03824 <font class="preprocessor"></font>
<a name="l03825"></a><a class="code" href="context_c.html#a200">03825</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a200">context_pushLoc</a> (<font class="keywordtype">void</font>)<font class="keyword"> </font>
03826 <font class="keyword"></font>{
03827   <a class="code" href="fileloc_c.html#a8">fileloc_free</a> (gc.pushloc);
03828   gc.pushloc = gc.saveloc;
03829   gc.saveloc = fileloc_undefined;
03830 }
03831 
<a name="l03832"></a><a class="code" href="context_c.html#a201">03832</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a201">context_popLoc</a> (<font class="keywordtype">void</font>)<font class="keyword"> </font>
03833 <font class="keyword"></font>{
03834   gc.saveloc = <a class="code" href="fileloc_c.html#a6">fileloc_update</a> (gc.saveloc, gc.pushloc);
03835 }
03836 
<a name="l03837"></a><a class="code" href="context_c.html#a202">03837</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a202">context_inGlobalScope</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03838 <font class="keyword"></font>{
03839   <font class="keywordflow">return</font> (<a class="code" href="usymtab_c.html#a138">usymtab_inFileScope</a>() || <a class="code" href="usymtab_c.html#a137">usymtab_inGlobalScope</a> ());
03840 }
03841 
<a name="l03842"></a><a class="code" href="context_c.html#a203">03842</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a203">context_inInnerScope</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03843 <font class="keyword"></font>{
03844   <font class="keywordflow">return</font> (gc.kind == CX_INNER);
03845 }
03846 
<a name="l03847"></a><a class="code" href="context_c.html#a204">03847</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a204">context_setProtectVars</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03848 <font class="keyword"></font>{
03849   gc.protectVars = TRUE;
03850 }
03851 
<a name="l03852"></a><a class="code" href="context_c.html#a205">03852</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a205">context_anyErrors</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03853 <font class="keyword"></font>{
03854   <font class="keywordflow">return</font> (gc.numerrors &gt; 0);
03855 }
03856 
<a name="l03857"></a><a class="code" href="context_c.html#a206">03857</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a206">context_hasError</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03858 <font class="keyword"></font>{
03859   gc.numerrors++;
03860 }
03861 
<a name="l03862"></a><a class="code" href="context_c.html#a207">03862</a> <font class="keywordtype">int</font> <a class="code" href="context_c.html#a207">context_numErrors</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03863 <font class="keyword"></font>{
03864   <font class="keywordflow">return</font> gc.numerrors;
03865 }
03866 
<a name="l03867"></a><a class="code" href="context_c.html#a208">03867</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a208">context_neednl</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03868 <font class="keyword"></font>{
03869   <font class="keywordflow">return</font> gc.neednl;
03870 }
03871 
<a name="l03872"></a><a class="code" href="context_c.html#a209">03872</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a209">context_setNeednl</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03873 <font class="keyword"></font>{
03874   gc.neednl = TRUE;
03875 }
03876 
<a name="l03877"></a><a class="code" href="context_c.html#a210">03877</a> <font class="keywordtype">int</font> <a class="code" href="context_c.html#a210">context_getExpect</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03878 <font class="keyword"></font>{
03879   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a151">context_getValue</a> (FLG_EXPECT));
03880 }
03881 
03882 <font class="preprocessor"># ifndef NOLCL</font>
<a name="l03883"></a><a class="code" href="context_c.html#a211">03883</a> <font class="preprocessor"></font><font class="keywordtype">int</font> <a class="code" href="context_c.html#a211">context_getLCLExpect</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03884 <font class="keyword"></font>{
03885   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a151">context_getValue</a> (FLG_LCLEXPECT));
03886 }
03887 <font class="preprocessor"># endif</font>
03888 <font class="preprocessor"></font>
<a name="l03889"></a><a class="code" href="context_c.html#a212">03889</a> <font class="keywordtype">int</font> <a class="code" href="context_c.html#a212">context_getLimit</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03890 <font class="keyword"></font>{
03891   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a151">context_getValue</a> (FLG_LIMIT));
03892 }
03893 
<a name="l03894"></a><a class="code" href="context_c.html#a213">03894</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a213">context_unlimitedMessages</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03895 <font class="keyword"></font>{
03896   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a212">context_getLimit</a> () &lt; 0);
03897 }
03898 
<a name="l03899"></a><a class="code" href="context_c.html#a214">03899</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a214">context_releaseVars</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03900 <font class="keyword"></font>{
03901   llassert (gc.protectVars);
03902   gc.protectVars = FALSE;
03903 }
03904 
<a name="l03905"></a><a class="code" href="context_c.html#a215">03905</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a215">context_sizeofReleaseVars</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03906 <font class="keyword"></font>{
03907   <font class="comment">/* If there is a nested sizeof, this might not hold:</font>
03908 <font class="comment">     llassert (gc.protectVars);</font>
03909 <font class="comment">     */</font>
03910 
03911   gc.protectVars = FALSE;
03912 }
03913 
<a name="l03914"></a><a class="code" href="context_c.html#a216">03914</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a216">context_inProtectVars</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03915 <font class="keyword"></font>{
03916   <font class="keywordflow">return</font> (gc.protectVars);
03917 }
03918 
<a name="l03919"></a><a class="code" href="context_c.html#a217">03919</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a217">context_hideShowscan</a> (<font class="keywordtype">void</font>)<font class="keyword"> </font>
03920 <font class="keyword"></font>{
03921   gc.flags[FLG_SHOWSCAN] = FALSE;
03922 }
03923 
<a name="l03924"></a><a class="code" href="context_c.html#a218">03924</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a218">context_unhideShowscan</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03925 <font class="keyword"></font>{
03926   gc.flags[FLG_SHOWSCAN] = TRUE;
03927 }
03928 
<a name="l03929"></a><a class="code" href="context_c.html#a219">03929</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a219">context_inHeader</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03930 <font class="keyword"></font>{
03931   <font class="keywordflow">return</font> (gc.inheader);
03932 }
03933 
<a name="l03934"></a><a class="code" href="context_c.html#a220">03934</a> fileTable <a class="code" href="context_c.html#a220">context_fileTable</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03935 <font class="keyword"></font>{
03936   <font class="keywordflow">return</font> gc.ftab;
03937 }
03938 
<a name="l03939"></a><a class="code" href="context_c.html#a221">03939</a> cstring <a class="code" href="context_c.html#a221">context_tmpdir</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03940 <font class="keyword"></font>{
03941   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a157">context_getString</a> (FLG_TMPDIR));
03942 }
03943 
<a name="l03944"></a><a class="code" href="context_c.html#a222">03944</a> messageLog <a class="code" href="context_c.html#a222">context_messageLog</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03945 <font class="keyword"></font>{
03946   <font class="keywordflow">return</font> gc.msgLog;
03947 }
03948 
<a name="l03949"></a><a class="code" href="context_c.html#a223">03949</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a223">context_inMacroFunction</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03950 <font class="keyword"></font>{
03951   <font class="keywordflow">return</font> (gc.kind == CX_MACROFCN);
03952 }
03953 
<a name="l03954"></a><a class="code" href="context_c.html#a224">03954</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a224">context_inMacroConstant</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03955 <font class="keyword"></font>{   
03956   <font class="keywordflow">return</font> (gc.kind == CX_MACROCONST);
03957 }
03958 
<a name="l03959"></a><a class="code" href="context_c.html#a225">03959</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a225">context_inMacroUnknown</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03960 <font class="keyword"></font>{   
03961   <font class="keywordflow">return</font> (gc.kind == CX_UNKNOWNMACRO);
03962 }
03963 
<a name="l03964"></a><a class="code" href="context_c.html#a226">03964</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a226">context_setShownFunction</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03965 <font class="keyword"></font>{
03966   gc.showfunction = FALSE;
03967 }
03968 
<a name="l03969"></a><a class="code" href="context_c.html#a227">03969</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a227">context_doDump</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03970 <font class="keyword"></font>{   
03971   <font class="keywordflow">return</font> cstring_isNonEmpty (context_getString (FLG_DUMP));
03972 }
03973 
<a name="l03974"></a><a class="code" href="context_c.html#a228">03974</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a228">context_doMerge</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03975 <font class="keyword"></font>{
03976   <font class="keywordflow">return</font> cstring_isNonEmpty (context_getString (FLG_MERGE));
03977 }
03978 
<a name="l03979"></a><a class="code" href="context_c.html#a229">03979</a> cstring <a class="code" href="context_c.html#a229">context_getDump</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03980 <font class="keyword"></font>{           
03981   <font class="keywordflow">return</font> <a class="code" href="context_c.html#a157">context_getString</a> (FLG_DUMP);
03982 }
03983 
<a name="l03984"></a><a class="code" href="context_c.html#a230">03984</a> cstring <a class="code" href="context_c.html#a230">context_getMerge</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03985 <font class="keyword"></font>{
03986   <font class="keywordflow">return</font> <a class="code" href="context_c.html#a157">context_getString</a> (FLG_MERGE);
03987 }
03988 
03989 <font class="preprocessor"># ifndef NOLCL</font>
<a name="l03990"></a><a class="code" href="context_c.html#a231">03990</a> <font class="preprocessor"></font><font class="keywordtype">bool</font> <a class="code" href="context_c.html#a231">context_inLCLLib</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03991 <font class="keyword"></font>{   
03992   <font class="keywordflow">return</font> (gc.kind == CX_LCLLIB);
03993 }
03994 
<a name="l03995"></a><a class="code" href="context_c.html#a232">03995</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a232">context_inImport</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
03996 <font class="keyword"></font>{
03997   <font class="keywordflow">return</font> (gc.inimport);
03998 }
03999 
<a name="l04000"></a><a class="code" href="context_c.html#a233">04000</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a233">context_enterImport</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04001 <font class="keyword"></font>{ 
04002   gc.inimport = TRUE;
04003 }
04004 
<a name="l04005"></a><a class="code" href="context_c.html#a234">04005</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a234">context_leaveImport</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04006 <font class="keyword"></font>{ 
04007   gc.inimport = FALSE;
04008 }
04009 <font class="preprocessor"># endif</font>
04010 <font class="preprocessor"></font>
<a name="l04011"></a><a class="code" href="context_c.html#a235">04011</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a235">context_inMacro</a> (<font class="keywordtype">void</font>)<font class="keyword"> </font>
04012 <font class="keyword"></font>{
04013   <font class="keywordflow">return</font> (gc.kind == CX_MACROFCN || gc.kind == CX_MACROCONST 
04014           || gc.kind == CX_UNKNOWNMACRO
04015           || gc.kind == CX_ITERDEF || gc.kind == CX_ITEREND);
04016 }
04017 
<a name="l04018"></a><a class="code" href="context_c.html#a236">04018</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a236">context_inIterDef</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04019 <font class="keyword"></font>{
04020   <font class="keywordflow">return</font> (gc.kind == CX_ITERDEF);
04021 }
04022 
<a name="l04023"></a><a class="code" href="context_c.html#a237">04023</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a237">context_inIterEnd</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04024 <font class="keyword"></font>{
04025   <font class="keywordflow">return</font> (gc.kind == CX_ITEREND);
04026 }
04027 
<a name="l04028"></a><a class="code" href="context_c.html#a238">04028</a> <font class="keywordtype">int</font> <a class="code" href="context_c.html#a238">context_getLinesProcessed</a> (<font class="keywordtype">void</font>)<font class="keyword">    </font>
04029 <font class="keyword"></font>{
04030   <font class="keywordflow">return</font> (gc.linesprocessed);
04031 }
04032 
<a name="l04033"></a><a class="code" href="context_c.html#a239">04033</a> <font class="keywordtype">int</font> <a class="code" href="context_c.html#a239">context_getSpecLinesProcessed</a> (<font class="keywordtype">void</font>)<font class="keyword">    </font>
04034 <font class="keyword"></font>{
04035   <font class="keywordflow">return</font> (gc.speclinesprocessed);
04036 }
04037 
04038 <font class="preprocessor"># ifndef NOLCL</font>
<a name="l04039"></a><a class="code" href="context_c.html#a240">04039</a> <font class="preprocessor"></font><font class="keywordtype">void</font> <a class="code" href="context_c.html#a240">context_processedSpecLine</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04040 <font class="keyword"></font>{
04041   gc.speclinesprocessed++;
04042 }
04043 
<a name="l04044"></a><a class="code" href="context_c.html#a241">04044</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a241">context_resetSpecLines</a> (<font class="keywordtype">void</font>)<font class="keyword">    </font>
04045 <font class="keyword"></font>{
04046   gc.speclinesprocessed = 0;
04047 }
04048 <font class="preprocessor"># endif</font>
04049 <font class="preprocessor"></font>
<a name="l04050"></a><a class="code" href="context_c.html#a242">04050</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a242">context_inGlobalContext</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04051 <font class="keyword"></font>{
04052   <font class="keywordflow">return</font> (gc.kind == CX_GLOBAL);
04053 }
04054 
<a name="l04055"></a><a class="code" href="context_c.html#a243">04055</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a243">context_setFileId</a> (fileId s)<font class="keyword"></font>
04056 <font class="keyword"></font>{
04057   g_currentloc = <a class="code" href="fileloc_c.html#a7">fileloc_updateFileId</a> (g_currentloc, s); 
04058 }
04059 
<a name="l04060"></a><a class="code" href="context_c.html#a244">04060</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a244">context_setBoolName</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04061 <font class="keyword"></font>{
04062   <font class="keywordflow">return</font> (!cstring_equalLit (context_getString (FLG_BOOLTYPE),
04063                              DEFAULT_BOOLTYPE));
04064 }
04065 
<a name="l04066"></a><a class="code" href="context_c.html#a245">04066</a> cstring <a class="code" href="context_c.html#a245">context_printBoolName</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04067 <font class="keyword"></font>{
04068   <font class="keywordflow">if</font> (<a class="code" href="context_c.html#a244">context_setBoolName</a> ()) 
04069     {
04070       <font class="keywordflow">return</font> <a class="code" href="context_c.html#a246">context_getBoolName</a> ();
04071     }
04072   <font class="keywordflow">else</font>
04073     {
04074       <font class="keywordflow">return</font> cstring_makeLiteralTemp (<font class="stringliteral">"boolean"</font>);
04075     }
04076 }
04077 
<a name="l04078"></a><a class="code" href="context_c.html#a246">04078</a> cstring <a class="code" href="context_c.html#a246">context_getBoolName</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04079 <font class="keyword"></font>{
04080   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a157">context_getString</a> (FLG_BOOLTYPE));
04081 }
04082 
<a name="l04083"></a><a class="code" href="context_c.html#a247">04083</a> cstring <a class="code" href="context_c.html#a247">context_getFalseName</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04084 <font class="keyword"></font>{
04085   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a157">context_getString</a> (FLG_BOOLFALSE));
04086 }
04087 
<a name="l04088"></a><a class="code" href="context_c.html#a248">04088</a> cstring <a class="code" href="context_c.html#a248">context_getTrueName</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04089 <font class="keyword"></font>{
04090   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a157">context_getString</a> (FLG_BOOLTRUE));
04091 }
04092 
<a name="l04093"></a><a class="code" href="context_c.html#a249">04093</a> cstring <a class="code" href="context_c.html#a249">context_getLarchPath</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04094 <font class="keyword"></font>{
04095   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a157">context_getString</a> (FLG_LARCHPATH));
04096 }
04097 
<a name="l04098"></a><a class="code" href="context_c.html#a250">04098</a> cstring <a class="code" href="context_c.html#a250">context_getLCLImportDir</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04099 <font class="keyword"></font>{
04100   <font class="keywordflow">return</font> (<a class="code" href="context_c.html#a157">context_getString</a> (FLG_LCLIMPORTDIR));
04101 }
04102 
04103 <font class="keyword">static</font> <font class="keywordtype">void</font> context_setJustPopped (<font class="keywordtype">void</font>)<font class="keyword"></font>
04104 <font class="keyword"></font>{
04105   gc.justpopped = TRUE;
04106 }
04107 
<a name="l04108"></a><a class="code" href="context_c.html#a251">04108</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a251">context_clearJustPopped</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04109 <font class="keyword"></font>{
04110   gc.justpopped = FALSE;
04111 }
04112 
<a name="l04113"></a><a class="code" href="context_c.html#a252">04113</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a252">context_justPopped</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04114 <font class="keyword"></font>{
04115   <font class="keywordflow">return</font> (gc.justpopped);
04116 }
04117 
<a name="l04118"></a><a class="code" href="context_c.html#a253">04118</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a253">context_setMacroMissingParams</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04119 <font class="keyword"></font>{
04120   gc.macroMissingParams = TRUE;
04121 }
04122 
<a name="l04123"></a><a class="code" href="context_c.html#a254">04123</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a254">context_resetMacroMissingParams</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04124 <font class="keyword"></font>{
04125   gc.macroMissingParams = FALSE;
04126 }
04127 
<a name="l04128"></a><a class="code" href="context_c.html#a255">04128</a> <font class="keywordtype">bool</font> <a class="code" href="context_c.html#a255">context_isMacroMissingParams</a> (<font class="keywordtype">void</font>)<font class="keyword"></font>
04129 <font class="keyword"></font>{
04130   <font class="keywordflow">return</font> (gc.macroMissingParams);
04131 }
04132 
<a name="l04133"></a><a class="code" href="context_c.html#a256">04133</a> <font class="keywordtype">void</font> <a class="code" href="context_c.html#a256">context_showFilelocStack</a> (<font class="keywordtype">void</font>)<font class="keyword"> </font>
04134 <font class="keyword"></font>{
04135   <a class="code" href="filelocStack_c.html#a9">filelocStack_printIncludes</a> (gc.locstack);
04136 }
04137 
04138 
04139 
04140 
04141 
04142 
04143 
</div></pre><hr><address><small>Generated at Fri Nov 3 18:57:39 2000 for LCLint by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.3 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
