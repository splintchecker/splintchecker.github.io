<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cstring.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.3 on Fri Nov 3 18:57:40 2000 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>cstring.c</h1><a href="cstring_c.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">** LCLint - annotation-assisted static program checker</font>
00003 <font class="comment">** Copyright (C) 1994-2000 University of Virginia,</font>
00004 <font class="comment">**         Massachusetts Institute of Technology</font>
00005 <font class="comment">**</font>
00006 <font class="comment">** This program is free software; you can redistribute it and/or modify it</font>
00007 <font class="comment">** under the terms of the GNU General Public License as published by the</font>
00008 <font class="comment">** Free Software Foundation; either version 2 of the License, or (at your</font>
00009 <font class="comment">** option) any later version.</font>
00010 <font class="comment">** </font>
00011 <font class="comment">** This program is distributed in the hope that it will be useful, but</font>
00012 <font class="comment">** WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00013 <font class="comment">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</font>
00014 <font class="comment">** General Public License for more details.</font>
00015 <font class="comment">** </font>
00016 <font class="comment">** The GNU General Public License is available from http://www.gnu.org/ or</font>
00017 <font class="comment">** the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston,</font>
00018 <font class="comment">** MA 02111-1307, USA.</font>
00019 <font class="comment">**</font>
00020 <font class="comment">** For information on lclint: lclint-request@cs.virginia.edu</font>
00021 <font class="comment">** To report a bug: lclint-bug@cs.virginia.edu</font>
00022 <font class="comment">** For more information: http://lclint.cs.virginia.edu</font>
00023 <font class="comment">*/</font>
00024 <font class="comment">/*</font>
00025 <font class="comment">** cstring.c</font>
00026 <font class="comment">*/</font>
00027 
00028 <font class="comment">/*</font>
00029 <font class="comment"> * Herbert 06/12/2000</font>
00030 <font class="comment"> * - use drive spec specials with OS2 like with WIN32</font>
00031 <font class="comment"> * - cstring_replaceAll () needed in cpplib.c</font>
00032 <font class="comment"> */</font>
00033 
00034 <font class="preprocessor"># include "lclintMacros.nf"</font>
00035 <font class="preprocessor"># include "basic.h"</font>
00036 <font class="preprocessor"># include "osd.h"</font>
00037 <font class="preprocessor"># include "portab.h"</font>
00038 
00039 <font class="keyword">static</font> <font class="comment">/*@only@*/</font> <font class="comment">/*@notnull@*/</font> 
00040 cstring cstring_newEmpty (<font class="keywordtype">void</font>)<font class="keyword"></font>
00041 <font class="keyword"></font>{
00042   <font class="keywordflow">return</font> (<a class="code" href="cstring_c.html#a46">cstring_create</a> (0));
00043 }
00044 
<a name="l00045"></a><a class="code" href="cstring_c.html#a1">00045</a> <font class="keywordtype">char</font> <a class="code" href="cstring_c.html#a1">cstring_firstChar</a> (cstring s)<font class="keyword"> </font>
00046 <font class="keyword"></font>{
00047   llassert (cstring_isDefined (s));
00048   llassert (cstring_length (s) &gt; 0);
00049 
00050   <font class="keywordflow">return</font> (s[0]);
00051 }
00052 
<a name="l00053"></a><a class="code" href="cstring_c.html#a2">00053</a> <font class="keywordtype">char</font> <a class="code" href="cstring_c.html#a2">cstring_getChar</a> (cstring s, <font class="keywordtype">int</font> n)<font class="keyword"> </font>
00054 <font class="keyword"></font>{
00055   <font class="keywordtype">int</font> length = <a class="code" href="cstring_c.html#a30">cstring_length</a> (s);
00056 
00057   llassert (cstring_isDefined (s));
00058   llassert (n &gt;= 1 &amp;&amp; n &lt;= length);
00059 
00060   <font class="keywordflow">return</font> (s[n - 1]);
00061 }
00062 
<a name="l00063"></a><a class="code" href="cstring_c.html#a3">00063</a> cstring <a class="code" href="cstring_c.html#a3">cstring_suffix</a> (cstring s, <font class="keywordtype">int</font> n)<font class="keyword"> </font>
00064 <font class="keyword"></font>{
00065   llassert (cstring_isDefined (s));
00066   llassert (n &lt;= cstring_length (s));
00067 
00068   <font class="keywordflow">return</font> (s + n);
00069 }
00070 
<a name="l00071"></a><a class="code" href="cstring_c.html#a4">00071</a> cstring <a class="code" href="cstring_c.html#a4">cstring_prefix</a> (cstring s, <font class="keywordtype">int</font> n)<font class="keyword"> </font>
00072 <font class="keyword"></font>{
00073   cstring t;
00074   <font class="keywordtype">char</font> c;
00075   llassert (cstring_isDefined (s));
00076   llassert (n &lt;= cstring_length (s));
00077 
00078   c = *(s + n);
00079   <font class="comment">/*@-mods@*/</font>  <font class="comment">/* The modifications cancel out. */</font>
00080   *(s + n) = <font class="charliteral">'\0'</font>;
00081   t = <a class="code" href="cstring_c.html#a9">cstring_copy</a> (s);
00082   *(s + n) = c;
00083   <font class="comment">/*@=mods@*/</font>
00084 
00085   <font class="keywordflow">return</font> t;
00086 }
00087 
00088 <font class="comment">/* effects If s = [0-9]*, returns s as an int.</font>
00089 <font class="comment">**         else returns -1.</font>
00090 <font class="comment">*/</font>
00091 
<a name="l00092"></a><a class="code" href="cstring_c.html#a5">00092</a> <font class="keywordtype">int</font> <a class="code" href="cstring_c.html#a5">cstring_toPosInt</a> (cstring s)<font class="keyword"></font>
00093 <font class="keyword"></font>{
00094   <font class="keywordtype">int</font> val = 0;
00095 
00096   cstring_chars (s, c)<font class="keyword"></font>
00097 <font class="keyword">    </font>{
00098       <font class="keywordflow">if</font> (isdigit ((<font class="keywordtype">unsigned</font> <font class="keywordtype">char</font>) c))
00099         {
00100           val = (val * 10) + (<font class="keywordtype">int</font>)(c - <font class="charliteral">'0'</font>);
00101         }
00102       <font class="keywordflow">else</font>
00103         {
00104           <font class="keywordflow">return</font> -1;
00105         }
00106     } end_cstring_chars ; 
00107 
00108   <font class="keywordflow">return</font> val;
00109 }
00110 
<a name="l00111"></a><a class="code" href="cstring_c.html#a6">00111</a> cstring <a class="code" href="cstring_c.html#a6">cstring_beforeChar</a> (cstring s, <font class="keywordtype">char</font> c)<font class="keyword"></font>
00112 <font class="keyword"></font>{
00113   <font class="keywordflow">if</font> (cstring_isDefined (s))
00114     {
00115       <font class="keywordtype">char</font> *cp = strchr (s, c);
00116 
00117       <font class="keywordflow">if</font> (cp != NULL)
00118         {
00119           cstring ret;
00120 
00121           <font class="comment">/*@-mods@*/</font>
00122           *cp = <font class="charliteral">'\0'</font>;
00123           ret = <a class="code" href="cstring_c.html#a9">cstring_copy</a> (s);
00124           *cp = c;
00125           <font class="comment">/*@=mods@*/</font> <font class="comment">/* modification is undone */</font>
00126           
00127           <font class="keywordflow">return</font> ret;
00128         }
00129     }
00130 
00131   <font class="keywordflow">return</font> cstring_undefined;
00132 }
00133 
<a name="l00134"></a><a class="code" href="cstring_c.html#a7">00134</a> <font class="keywordtype">void</font> <a class="code" href="cstring_c.html#a7">cstring_setChar</a> (cstring s, <font class="keywordtype">int</font> n, <font class="keywordtype">char</font> c)<font class="keyword"> </font>
00135 <font class="keyword"></font>{
00136   llassert (cstring_isDefined (s));
00137   llassert (n &gt; 0 &amp;&amp; n &lt;= cstring_length (s));
00138 
00139   s[n - 1] = c;
00140 }
00141 
<a name="l00142"></a><a class="code" href="cstring_c.html#a8">00142</a> <font class="keywordtype">char</font> <a class="code" href="cstring_c.html#a8">cstring_lastChar</a> (cstring s)<font class="keyword"> </font>
00143 <font class="keyword"></font>{
00144   <font class="keywordtype">int</font> length;
00145 
00146   llassert (cstring_isDefined (s));
00147 
00148   length = <a class="code" href="cstring_c.html#a30">cstring_length</a> (s);
00149   llassert (length &gt; 0);
00150 
00151   <font class="keywordflow">return</font> (s[length - 1]);
00152 }
00153 
<a name="l00154"></a><a class="code" href="cstring_c.html#a9">00154</a> <font class="comment">/*@only@*/</font> cstring <a class="code" href="cstring_c.html#a9">cstring_copy</a> (cstring s)<font class="keyword"> </font>
00155 <font class="keyword"></font>{
00156   <font class="keywordflow">if</font> (cstring_isDefined (s))
00157     {
00158       <font class="keywordflow">return</font> (<a class="code" href="general_c.html#a27">mstring_copy</a> (s));
00159     }
00160   <font class="keywordflow">else</font>
00161     {
00162       <font class="keywordflow">return</font> cstring_undefined;
00163     }
00164 }
00165 
<a name="l00166"></a><a class="code" href="cstring_c.html#a10">00166</a> <font class="comment">/*@only@*/</font> cstring <a class="code" href="cstring_c.html#a10">cstring_copyLength</a> (<font class="keywordtype">char</font> *s, <font class="keywordtype">int</font> len)<font class="keyword"></font>
00167 <font class="keyword"></font>{
00168   <font class="keywordtype">char</font> *res = <a class="code" href="general_c.html#a29">mstring_create</a> (len + 1);
00169 
00170   strncpy (res, s, size_fromInt (len));
00171   res[len] = <font class="charliteral">'\0'</font>;
00172   <font class="keywordflow">return</font> res;
00173 }
00174 
<a name="l00175"></a><a class="code" href="cstring_c.html#a11">00175</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a11">cstring_containsChar</a> (cstring c, <font class="keywordtype">char</font> ch)<font class="keyword"></font>
00176 <font class="keyword"></font>{
00177   <font class="keywordflow">if</font> (cstring_isDefined (c))
00178     {
00179       <font class="keywordflow">return</font> (strchr (c, ch) != NULL);
00180     }
00181   <font class="keywordflow">else</font>
00182     {
00183       <font class="keywordflow">return</font> FALSE;
00184     }
00185 }
00186 
00187 <font class="comment">/*</font>
00188 <font class="comment">** Replaces all occurances of old in s with new.</font>
00189 <font class="comment">*/</font>
00190 
00191 <font class="preprocessor"># if defined (WIN32) || defined (OS2)</font>
00192 <font class="preprocessor"></font><font class="keywordtype">void</font> cstring_replaceAll (cstring s, <font class="keywordtype">char</font> old, <font class="keywordtype">char</font> snew)<font class="keyword"></font>
00193 <font class="keyword"></font>{
00194   
00195   llassert (old != snew);
00196 
00197   <font class="keywordflow">if</font> (cstring_isDefined (s))
00198     {
00199       <font class="keywordtype">char</font> *sp = strchr (s, old);
00200 
00201       <font class="keywordflow">while</font> (sp != NULL)
00202         {
00203           *sp = snew;
00204           sp = strchr (sp, old);
00205         }
00206 
00207           }
00208 }
00209 <font class="preprocessor"># endif</font>
00210 <font class="preprocessor"></font>
<a name="l00211"></a><a class="code" href="cstring_c.html#a12">00211</a> <font class="keywordtype">void</font> <a class="code" href="cstring_c.html#a12">cstring_replaceLit</a> (<font class="comment">/*@unique@*/</font> cstring s, <font class="keywordtype">char</font> *old, <font class="keywordtype">char</font> *snew)<font class="keyword"></font>
00212 <font class="keyword"></font>{
00213   
00214   llassert (strlen (old) &gt;= strlen (snew));
00215 
00216   <font class="keywordflow">if</font> (cstring_isDefined (s))
00217     {
00218       <font class="keywordtype">char</font> *sp = strstr (s, old);
00219 
00220       <font class="keywordflow">while</font> (sp != NULL)
00221         {
00222           <font class="keywordtype">int</font> lendiff = <a class="code" href="general_c.html#a34">size_toInt</a> (strlen (old) - strlen (snew));
00223           <font class="keywordtype">char</font> *tsnew = snew;
00224           
00225           <font class="keywordflow">while</font> (*tsnew != <font class="charliteral">'\0'</font>)
00226             {
00227               *sp++ = *tsnew++;
00228             }
00229 
00230           <font class="keywordflow">if</font> (lendiff &gt; 0)
00231             {
00232               <font class="keywordflow">while</font> (*(sp + lendiff) != <font class="charliteral">'\0'</font>)
00233                 {
00234                   *sp = *(sp + lendiff);
00235                   sp++;
00236                 }
00237 
00238               *sp = <font class="charliteral">'\0'</font>;
00239             }
00240 
00241           sp = strstr (s, old);
00242         }
00243           }
00244 }
00245 
00246 <font class="comment">/*</font>
00247 <font class="comment">** removes all chars in clist from s</font>
00248 <font class="comment">*/</font>
00249 
<a name="l00250"></a><a class="code" href="cstring_c.html#a13">00250</a> <font class="keywordtype">void</font> <a class="code" href="cstring_c.html#a13">cstring_stripChars</a> (cstring s, <font class="keyword">const</font> <font class="keywordtype">char</font> *clist)<font class="keyword"></font>
00251 <font class="keyword"></font>{
00252   <font class="keywordflow">if</font> (cstring_isDefined (s))
00253     {
00254       <font class="keywordtype">int</font> i;
00255       <font class="keywordtype">int</font> size = <a class="code" href="cstring_c.html#a30">cstring_length</a> (s);
00256 
00257       <font class="keywordflow">for</font> (i = 0; i &lt; size; i++)
00258         {
00259           <font class="keywordtype">char</font> c = s[i];
00260           
00261           <font class="keywordflow">if</font> (strchr (clist, c) != NULL)
00262             {
00263               <font class="comment">/* strip this char */</font>
00264               <font class="keywordtype">int</font> j;
00265               
00266               size--;
00267 
00268               <font class="keywordflow">for</font> (j = i; j &lt; size; j++)
00269                 {
00270                   s[j] = s[j+1];
00271                 }
00272 
00273               s[size] = <font class="charliteral">'\0'</font>; 
00274               i--;
00275             }
00276         }
00277     }
00278 }
00279 
<a name="l00280"></a><a class="code" href="cstring_c.html#a14">00280</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a14">cstring_contains</a> (<font class="comment">/*@unique@*/</font> cstring c, cstring sub)<font class="keyword"></font>
00281 <font class="keyword"></font>{
00282   <font class="keywordflow">if</font> (cstring_isDefined (c))
00283     {
00284       llassert (cstring_isDefined (sub));
00285       
00286       <font class="keywordflow">return</font> (strstr (c, sub) != NULL);
00287     }
00288   <font class="keywordflow">else</font>
00289     {
00290       <font class="keywordflow">return</font> FALSE;
00291     }
00292 }
00293 
00294 <font class="keyword">static</font> <font class="keywordtype">char</font> lookLike (<font class="keywordtype">char</font> c) <font class="comment">/*@*/</font>
00295 {
00296   <font class="keywordflow">if</font> (c == <font class="charliteral">'I'</font> || c == <font class="charliteral">'l'</font>)
00297     {
00298       <font class="keywordflow">return</font> <font class="charliteral">'1'</font>;
00299     }
00300   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (c == <font class="charliteral">'O'</font> || c == <font class="charliteral">'o'</font>)
00301     {
00302       <font class="keywordflow">return</font> <font class="charliteral">'0'</font>;
00303     }
00304   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (c == <font class="charliteral">'Z'</font>)
00305     {
00306       <font class="keywordflow">return</font> <font class="charliteral">'2'</font>;
00307     }
00308   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (c == <font class="charliteral">'S'</font>)
00309     {
00310       <font class="keywordflow">return</font> <font class="charliteral">'5'</font>;
00311     }
00312   <font class="keywordflow">else</font>
00313     {
00314       <font class="keywordflow">return</font> c;
00315     }
00316 }
00317 
<a name="l00318"></a><a class="code" href="cstring_c.html#a16">00318</a> cmpcode <a class="code" href="cstring_c.html#a16">cstring_genericEqual</a> (cstring s, cstring t,
00319                               <font class="keywordtype">int</font> nchars,
00320                               <font class="keywordtype">bool</font> caseinsensitive,
00321                               <font class="keywordtype">bool</font> lookalike)<font class="keyword"></font>
00322 <font class="keyword"></font>{
00323   <font class="keywordflow">if</font> (s == t) <font class="keywordflow">return</font> CGE_SAME;
00324   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (s))
00325     {
00326       <font class="keywordflow">return</font> cstring_isEmpty (t) ? CGE_SAME : CGE_DISTINCT;
00327     }
00328   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (t))
00329     {
00330       <font class="keywordflow">return</font> cstring_isEmpty (s) ? CGE_SAME : CGE_DISTINCT;
00331     }
00332   <font class="keywordflow">else</font>
00333     {
00334       <font class="keywordtype">int</font> i = 0;
00335       <font class="keywordtype">bool</font> diffcase = FALSE;
00336       <font class="keywordtype">bool</font> difflookalike = FALSE;
00337 
00338       <font class="keywordflow">while</font> (*s != <font class="charliteral">'\0'</font>)
00339         {
00340           <font class="keywordflow">if</font> (nchars &gt; 0 &amp;&amp; i &gt;= nchars)
00341             {
00342               <font class="keywordflow">break</font>;
00343             }
00344 
00345           <font class="keywordflow">if</font> (*t == *s)
00346             {
00347               ; <font class="comment">/* no difference */</font>
00348             }
00349           <font class="keywordflow">else</font> <font class="keywordflow">if</font> (caseinsensitive 
00350                    &amp;&amp; (toupper ((<font class="keywordtype">int</font>) *t) == toupper ((<font class="keywordtype">int</font>) *s)))
00351             {
00352               diffcase = TRUE;
00353             }
00354           <font class="keywordflow">else</font> <font class="keywordflow">if</font> (lookalike &amp;&amp; (lookLike (*t) == lookLike (*s)))
00355             {
00356               difflookalike = TRUE;
00357             }
00358           <font class="keywordflow">else</font> 
00359             {
00360               <font class="keywordflow">return</font> CGE_DISTINCT;
00361             }
00362           i++;
00363           s++;
00364           t++;
00365         }
00366 
00367       <font class="keywordflow">if</font> (*s == <font class="charliteral">'\0'</font> &amp;&amp; *t != <font class="charliteral">'\0'</font>)
00368         {
00369           <font class="keywordflow">return</font> CGE_DISTINCT;
00370         }
00371 
00372       <font class="keywordflow">if</font> (diffcase)
00373         {
00374           <font class="keywordflow">return</font> CGE_CASE;
00375         }
00376       <font class="keywordflow">else</font> <font class="keywordflow">if</font> (difflookalike)
00377         {
00378           <font class="keywordflow">return</font> CGE_LOOKALIKE;
00379         }
00380       <font class="keywordflow">else</font>
00381         {
00382           <font class="keywordflow">return</font> CGE_SAME;
00383         }
00384     }
00385 }
00386 
00387 
00388 
<a name="l00389"></a><a class="code" href="cstring_c.html#a17">00389</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a17">cstring_equalFree</a> (<font class="comment">/*@only@*/</font> cstring c1, <font class="comment">/*@only@*/</font> cstring c2)<font class="keyword"></font>
00390 <font class="keyword"></font>{
00391   <font class="keywordtype">bool</font> res = <a class="code" href="cstring_c.html#a18">cstring_equal</a> (c1, c2);
00392   <a class="code" href="cstring_c.html#a27">cstring_free</a> (c1);
00393   <a class="code" href="cstring_c.html#a27">cstring_free</a> (c2);
00394   <font class="keywordflow">return</font> res;
00395 }
00396 
<a name="l00397"></a><a class="code" href="cstring_c.html#a18">00397</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a18">cstring_equal</a> (cstring c1, cstring c2)<font class="keyword"></font>
00398 <font class="keyword"></font>{
00399   <font class="keywordflow">if</font> (c1 == c2) <font class="keywordflow">return</font> TRUE;
00400   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c1)) <font class="keywordflow">return</font> cstring_isEmpty (c2);
00401   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c2)) <font class="keywordflow">return</font> cstring_isEmpty (c1);
00402   <font class="keywordflow">else</font> <font class="keywordflow">return</font> (strcmp (c1, c2) == 0);
00403 }
00404 
<a name="l00405"></a><a class="code" href="cstring_c.html#a19">00405</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a19">cstring_equalLen</a> (cstring c1, cstring c2, <font class="keywordtype">int</font> len)<font class="keyword"></font>
00406 <font class="keyword"></font>{
00407   <font class="keywordflow">if</font> (c1 == c2) <font class="keywordflow">return</font> TRUE;
00408   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c1)) <font class="keywordflow">return</font> cstring_isEmpty (c2);
00409   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c2)) <font class="keywordflow">return</font> cstring_isEmpty (c1);
00410   <font class="keywordflow">else</font> <font class="keywordflow">return</font> (strncmp (c1, c2, size_fromInt (len)) == 0);
00411 }
00412 
<a name="l00413"></a><a class="code" href="cstring_c.html#a20">00413</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a20">cstring_equalCaseInsensitive</a> (cstring c1, cstring c2)<font class="keyword"></font>
00414 <font class="keyword"></font>{
00415   <font class="keywordflow">if</font> (c1 == c2) <font class="keywordflow">return</font> TRUE;
00416   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c1)) <font class="keywordflow">return</font> cstring_isEmpty (c2);
00417   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c2)) <font class="keywordflow">return</font> cstring_isEmpty (c1);
00418   <font class="keywordflow">else</font> <font class="keywordflow">return</font> (<a class="code" href="cstring_c.html#a16">cstring_genericEqual</a> (c1, c2, 0, TRUE, FALSE) != CGE_DISTINCT);
00419 }
00420 
<a name="l00421"></a><a class="code" href="cstring_c.html#a21">00421</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a21">cstring_equalLenCaseInsensitive</a> (cstring c1, cstring c2, <font class="keywordtype">int</font> len)<font class="keyword"></font>
00422 <font class="keyword"></font>{
00423   llassert (len &gt;= 0);
00424 
00425   <font class="keywordflow">if</font> (c1 == c2) <font class="keywordflow">return</font> TRUE;
00426   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c1)) <font class="keywordflow">return</font> cstring_isEmpty (c2);
00427   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c2)) <font class="keywordflow">return</font> cstring_isEmpty (c1);
00428   <font class="keywordflow">else</font> <font class="keywordflow">return</font> (<a class="code" href="cstring_c.html#a16">cstring_genericEqual</a> (c1, c2, len, TRUE, FALSE) != CGE_DISTINCT);
00429 }
00430 
<a name="l00431"></a><a class="code" href="cstring_c.html#a22">00431</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a22">cstring_equalPrefix</a> (cstring c1, <font class="keywordtype">char</font> *c2)<font class="keyword"></font>
00432 <font class="keyword"></font>{
00433   llassert (c2 != NULL);
00434 
00435   <font class="keywordflow">if</font> (cstring_isUndefined (c1)) 
00436     {
00437       <font class="keywordflow">return</font> (strlen (c2) == 0);
00438     }
00439 
00440   <font class="keywordflow">return</font> (strncmp (c1, c2, strlen (c2)) == 0);
00441 }
00442 
<a name="l00443"></a><a class="code" href="cstring_c.html#a23">00443</a> <font class="keywordtype">bool</font> <a class="code" href="cstring_c.html#a23">cstring_equalCanonicalPrefix</a> (cstring c1, <font class="keywordtype">char</font> *c2)<font class="keyword"></font>
00444 <font class="keyword"></font>{
00445   llassert (c2 != NULL);
00446 
00447   <font class="keywordflow">if</font> (cstring_isUndefined (c1)) 
00448     {
00449       <font class="keywordflow">return</font> (strlen (c2) == 0);
00450     }
00451 
00452 <font class="preprocessor"># if defined (WIN32) || defined (OS2)</font>
00453 <font class="preprocessor"></font>  <font class="comment">/*</font>
00454 <font class="comment">  ** If one has a drive specification, but the other doesn't, skip it.</font>
00455 <font class="comment">  */</font>
00456   
00457   <font class="keywordflow">if</font> (strchr (c1, <font class="charliteral">':'</font>) == NULL
00458       &amp;&amp; strchr (c2, <font class="charliteral">':'</font>) != NULL)
00459     {
00460       c2 = strchr (c2 + 1, <font class="charliteral">':'</font>);
00461     }
00462   <font class="keywordflow">else</font> 
00463     {
00464       <font class="keywordflow">if</font> (strchr (c2, <font class="charliteral">':'</font>) == NULL
00465           &amp;&amp; strchr (c1, <font class="charliteral">':'</font>) != NULL)
00466         {
00467           c1 = strchr (c1 + 1, <font class="charliteral">':'</font>);
00468         }
00469     }
00470 
00471   {
00472     <font class="keywordtype">int</font> len = <a class="code" href="general_c.html#a34">size_toInt</a> (strlen (c2));
00473     <font class="keywordtype">int</font> i = 0;
00474     <font class="keywordtype">int</font> slen = 0;
00475 
00476     <font class="keywordflow">if</font> (<a class="code" href="cstring_c.html#a30">cstring_length</a> (c1) &lt; len)
00477       {
00478         <font class="keywordflow">return</font> FALSE;
00479       }
00480 
00481     <font class="keywordflow">for</font> (i = 0; i &lt; len; i++)
00482       {
00483         <font class="keywordflow">if</font> (c1[slen] == c2[i]
00484             || (<a class="code" href="osd_c.html#a19">osd_isConnectChar</a> (c1[slen]) &amp;&amp; <a class="code" href="osd_c.html#a19">osd_isConnectChar</a> (c2[i])))
00485           {
00486             ;
00487           }
00488         <font class="keywordflow">else</font> 
00489           {
00490             <font class="comment">/*</font>
00491 <font class="comment">            ** We allow \\ to match \ because MS-DOS screws up the directory</font>
00492 <font class="comment">            ** names.</font>
00493 <font class="comment">            */</font>
00494             
00495             <font class="keywordflow">if</font> (c1[slen] == <font class="charliteral">'\\'</font>
00496                 &amp;&amp; (slen &gt; 0
00497                     &amp;&amp; c1[slen - 1] == <font class="charliteral">'\\'</font>
00498                     &amp;&amp; c2[i - 1] == <font class="charliteral">'\\'</font>))
00499               {
00500                 slen++;
00501                 <font class="keywordflow">if</font> (c1[slen] != c2[i])
00502                   {
00503                     <font class="keywordflow">return</font> FALSE;
00504                   }
00505               }
00506             <font class="keywordflow">else</font>
00507               {
00508                 <font class="keywordflow">return</font> FALSE;
00509               }
00510           }
00511 
00512         slen++;
00513         <font class="keywordflow">if</font> (slen &gt;= <a class="code" href="cstring_c.html#a30">cstring_length</a> (c1))
00514           {
00515             <font class="keywordflow">return</font> FALSE;
00516           }
00517       }
00518   }
00519 
00520   <font class="keywordflow">return</font> TRUE;
00521 <font class="preprocessor"># else</font>
00522 <font class="preprocessor"></font>  <font class="keywordflow">return</font> (strncmp (c1, c2, strlen (c2)) == 0);
00523 <font class="preprocessor"># endif</font>
00524 <font class="preprocessor"></font>}
00525 
<a name="l00526"></a><a class="code" href="cstring_c.html#a24">00526</a> <font class="keywordtype">int</font> <a class="code" href="cstring_c.html#a24">cstring_xcompare</a> (cstring *c1, cstring *c2)<font class="keyword"></font>
00527 <font class="keyword"></font>{
00528   <font class="keywordflow">return</font> (<a class="code" href="cstring_c.html#a25">cstring_compare</a> (*c1, *c2));
00529 }
00530 
<a name="l00531"></a><a class="code" href="cstring_c.html#a25">00531</a> <font class="keywordtype">int</font> <a class="code" href="cstring_c.html#a25">cstring_compare</a> (cstring c1, cstring c2)<font class="keyword"></font>
00532 <font class="keyword"></font>{
00533   <font class="keywordtype">int</font> res;
00534 
00535   <font class="keywordflow">if</font> (c1 == c2)
00536     {
00537       res = 0;
00538     }
00539   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c1))
00540     {
00541       <font class="keywordflow">if</font> (cstring_isEmpty (c2))
00542         {
00543           res = 0;
00544         }
00545       <font class="keywordflow">else</font>
00546         {
00547           res = 1;
00548         }
00549     }
00550   <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cstring_isUndefined (c2))
00551     {
00552       <font class="keywordflow">if</font> (cstring_isEmpty (c1))
00553         {
00554           res = 0;
00555         }
00556       <font class="keywordflow">else</font>
00557         {
00558           res = -1;
00559         }
00560     }
00561   <font class="keywordflow">else</font>
00562     {
00563       res = strcmp (c1, c2);
00564     }
00565 
00566     <font class="keywordflow">return</font> (res);
00567 }
00568 
<a name="l00569"></a><a class="code" href="cstring_c.html#a26">00569</a> <font class="keywordtype">void</font> <a class="code" href="cstring_c.html#a26">cstring_markOwned</a> (<font class="comment">/*@owned@*/</font> cstring s)<font class="keyword"></font>
00570 <font class="keyword"></font>{
00571   <a class="code" href="general_c.html#a1">sfreeEventually</a> (s);
00572 }
00573 
<a name="l00574"></a><a class="code" href="cstring_c.html#a27">00574</a> <font class="keywordtype">void</font> <a class="code" href="cstring_c.html#a27">cstring_free</a> (<font class="comment">/*@only@*/</font> cstring s)<font class="keyword"></font>
00575 <font class="keyword"></font>{
00576   <font class="keywordflow">if</font> (cstring_isDefined (s)) 
00577     {
00578       <a class="code" href="general_c.html#a0">sfree</a> (s);
00579     }
00580 }
00581 
<a name="l00582"></a><a class="code" href="cstring_c.html#a28">00582</a> cstring <a class="code" href="cstring_c.html#a28">cstring_fromChars</a> (<font class="comment">/*@exposed@*/</font> <font class="keyword">const</font> <font class="keywordtype">char</font> *cp)<font class="keyword"></font>
00583 <font class="keyword"></font>{
00584   <font class="keywordflow">return</font> (cstring) cp;
00585 }
00586 
<a name="l00587"></a><a class="code" href="cstring_c.html#a29">00587</a> <font class="comment">/*@exposed@*/</font> <font class="keywordtype">char</font> *<a class="code" href="cstring_c.html#a29">cstring_toCharsSafe</a> (cstring s)<font class="keyword"></font>
00588 <font class="keyword"></font>{
00589   <font class="keyword">static</font> <font class="comment">/*@only@*/</font> cstring emptystring = cstring_undefined;
00590 
00591   <font class="keywordflow">if</font> (cstring_isDefined (s))
00592     {
00593       <font class="keywordflow">return</font> (<font class="keywordtype">char</font> *) s;
00594     }
00595   <font class="keywordflow">else</font>
00596     {
00597       <font class="keywordflow">if</font> (cstring_isUndefined (emptystring))
00598         {
00599           emptystring = cstring_newEmpty ();
00600         }
00601 
00602       <font class="keywordflow">return</font> emptystring;
00603     }
00604 }
00605 
<a name="l00606"></a><a class="code" href="cstring_c.html#a30">00606</a> <font class="keywordtype">int</font> <a class="code" href="cstring_c.html#a30">cstring_length</a> (cstring s)<font class="keyword"></font>
00607 <font class="keyword"></font>{
00608   <font class="keywordflow">if</font> (cstring_isDefined (s))
00609     {
00610       <font class="keywordflow">return</font> <a class="code" href="general_c.html#a34">size_toInt</a> (strlen (s));
00611     }
00612   <font class="keywordflow">return</font> 0;
00613 }
00614 
00615 cstring
<a name="l00616"></a><a class="code" href="cstring_c.html#a31">00616</a> <a class="code" href="cstring_c.html#a31">cstring_capitalize</a> (cstring s)<font class="keyword"></font>
00617 <font class="keyword"></font>{
00618   <font class="keywordflow">if</font> (!cstring_isEmpty (s))
00619     {
00620       cstring ret = <a class="code" href="cstring_c.html#a9">cstring_copy</a> (s);
00621 
00622       <a class="code" href="cstring_c.html#a7">cstring_setChar</a> (ret, 1, (<font class="keywordtype">char</font>) toupper ((<font class="keywordtype">int</font>) <a class="code" href="cstring_c.html#a1">cstring_firstChar</a> (ret)));
00623       <font class="keywordflow">return</font> ret;
00624     }
00625   
00626   <font class="keywordflow">return</font> cstring_undefined;
00627 }
00628 
00629 cstring
<a name="l00630"></a><a class="code" href="cstring_c.html#a32">00630</a> <a class="code" href="cstring_c.html#a32">cstring_capitalizeFree</a> (cstring s)<font class="keyword"></font>
00631 <font class="keyword"></font>{
00632   <font class="keywordflow">if</font> (!cstring_isEmpty (s))
00633     {
00634       <a class="code" href="cstring_c.html#a7">cstring_setChar</a> (s, 1, (<font class="keywordtype">char</font>) toupper ((<font class="keywordtype">int</font>) <a class="code" href="cstring_c.html#a1">cstring_firstChar</a> (s)));
00635       <font class="keywordflow">return</font> s;
00636     }
00637   
00638   <font class="keywordflow">return</font> s;
00639 }
00640 
00641 cstring
<a name="l00642"></a><a class="code" href="cstring_c.html#a33">00642</a> <a class="code" href="cstring_c.html#a33">cstring_clip</a> (cstring s, <font class="keywordtype">int</font> len)<font class="keyword"></font>
00643 <font class="keyword"></font>{
00644   <font class="keywordflow">if</font> (cstring_isUndefined (s) || <a class="code" href="cstring_c.html#a30">cstring_length</a> (s) &lt;= len)
00645     {
00646       ;
00647     }
00648   <font class="keywordflow">else</font>
00649     {
00650       llassert (s != NULL);
00651       *(s + len) = <font class="charliteral">'\0'</font>;
00652     }
00653 
00654   <font class="keywordflow">return</font> s;
00655 }
00656 
00657 <font class="comment">/*@only@*/</font> cstring
<a name="l00658"></a><a class="code" href="cstring_c.html#a34">00658</a> <a class="code" href="cstring_c.html#a34">cstring_elide</a> (cstring s, <font class="keywordtype">int</font> len)<font class="keyword"></font>
00659 <font class="keyword"></font>{
00660   <font class="keywordflow">if</font> (cstring_isUndefined (s) || <a class="code" href="cstring_c.html#a30">cstring_length</a> (s) &lt;= len)
00661     {
00662       <font class="keywordflow">return</font> <a class="code" href="cstring_c.html#a9">cstring_copy</a> (s);
00663     }
00664   <font class="keywordflow">else</font>
00665     {
00666       cstring sc = <a class="code" href="cstring_c.html#a46">cstring_create</a> (len);
00667      
00668       strncpy (sc, s, size_fromInt (len));
00669       *(sc + len - 1) = <font class="charliteral">'\0'</font>;
00670       *(sc + len - 2) = <font class="charliteral">'.'</font>;      
00671       *(sc + len - 3) = <font class="charliteral">'.'</font>;      
00672       *(sc + len - 4) = <font class="charliteral">'.'</font>;      
00673       <font class="keywordflow">return</font> sc;
00674     }
00675 }
00676 
00677 <font class="comment">/*@only@*/</font> cstring
<a name="l00678"></a><a class="code" href="cstring_c.html#a35">00678</a> <a class="code" href="cstring_c.html#a35">cstring_fill</a> (cstring s, <font class="keywordtype">int</font> n)<font class="keyword"></font>
00679 <font class="keyword"></font>{
00680   cstring t = <a class="code" href="cstring_c.html#a46">cstring_create</a> (n + 1);
00681   cstring ot = t;
00682   <font class="keywordtype">int</font> len = <a class="code" href="cstring_c.html#a30">cstring_length</a> (s);
00683   <font class="keywordtype">int</font> i;
00684   
00685   <font class="keywordflow">if</font> (len &gt; n)
00686     {
00687       <font class="keywordflow">for</font> (i = 0; i &lt; n; i++)
00688         {
00689           *t++ = *s++;
00690         }
00691       *t = <font class="charliteral">'\0'</font>;
00692     }
00693   <font class="keywordflow">else</font>
00694     {
00695       <font class="keywordflow">for</font> (i = 0; i &lt; len; i++)
00696         {
00697           *t++ = *s++;
00698         }
00699       <font class="keywordflow">for</font> (i = 0; i &lt; n - len; i++)
00700         {
00701           *t++ = <font class="charliteral">' '</font>;
00702         }
00703       *t = <font class="charliteral">'\0'</font>;
00704     }
00705 
00706   <font class="keywordflow">return</font> ot;
00707 }
00708 
00709 cstring
<a name="l00710"></a><a class="code" href="cstring_c.html#a36">00710</a> <a class="code" href="cstring_c.html#a36">cstring_downcase</a> (cstring s)<font class="keyword"></font>
00711 <font class="keyword"></font>{
00712   <font class="keywordflow">if</font> (cstring_isDefined (s))
00713     {
00714       cstring t = <a class="code" href="cstring_c.html#a46">cstring_create</a> (strlen (s) + 1);
00715       cstring ot = t;
00716       <font class="keywordtype">char</font> c;
00717       
00718       <font class="keywordflow">while</font> ((c = *s) != <font class="charliteral">'\0'</font>)
00719         {
00720           <font class="keywordflow">if</font> (c &gt;= <font class="charliteral">'A'</font> &amp;&amp; c &lt;= <font class="charliteral">'Z'</font>)
00721             {
00722               c = c - <font class="charliteral">'A'</font> + <font class="charliteral">'a'</font>;
00723             }
00724           *t++ = c;
00725           s++;
00726         }
00727       *t = <font class="charliteral">'\0'</font>;
00728       
00729       <font class="keywordflow">return</font> ot;
00730     }
00731   <font class="keywordflow">else</font>
00732     {
00733       <font class="keywordflow">return</font> cstring_undefined;
00734     }
00735 }
00736 
00737 <font class="comment">/*@notnull@*/</font> cstring 
<a name="l00738"></a><a class="code" href="cstring_c.html#a37">00738</a> <a class="code" href="cstring_c.html#a37">cstring_appendChar</a> (<font class="comment">/*@only@*/</font> cstring s1, <font class="keywordtype">char</font> c)<font class="keyword"></font>
00739 <font class="keyword"></font>{
00740   <font class="keywordtype">int</font> l = <a class="code" href="cstring_c.html#a30">cstring_length</a> (s1);
00741   <font class="keywordtype">char</font> *s;
00742 
00743   s = (<font class="keywordtype">char</font> *) dmalloc (<font class="keyword">sizeof</font> (*s) * (l + 2));
00744 
00745   <font class="keywordflow">if</font> (cstring_isDefined (s1))
00746     {  
00747       strcpy (s, s1);
00748       *(s + l) = c;
00749       *(s + l + 1) = <font class="charliteral">'\0'</font>;
00750       <a class="code" href="general_c.html#a0">sfree</a> (s1); 
00751     }
00752   <font class="keywordflow">else</font>
00753     {
00754       *(s) = c;
00755       *(s + 1) = <font class="charliteral">'\0'</font>;
00756     } 
00757 
00758   <font class="keywordflow">return</font> s;
00759 }
00760 
00761 <font class="comment">/*@only@*/</font> cstring 
<a name="l00762"></a><a class="code" href="cstring_c.html#a38">00762</a> <a class="code" href="cstring_c.html#a38">cstring_concatFree</a> (cstring s, cstring t)<font class="keyword"></font>
00763 <font class="keyword"></font>{
00764   cstring res = <a class="code" href="cstring_c.html#a42">cstring_concat</a> (s, t);
00765   <a class="code" href="cstring_c.html#a27">cstring_free</a> (s);
00766   <a class="code" href="cstring_c.html#a27">cstring_free</a> (t);
00767   <font class="keywordflow">return</font> res;
00768 }
00769 
00770 <font class="comment">/*@only@*/</font> cstring 
<a name="l00771"></a><a class="code" href="cstring_c.html#a39">00771</a> <a class="code" href="cstring_c.html#a39">cstring_concatFree1</a> (cstring s, cstring t)<font class="keyword"></font>
00772 <font class="keyword"></font>{
00773   cstring res = <a class="code" href="cstring_c.html#a42">cstring_concat</a> (s, t);
00774   <a class="code" href="cstring_c.html#a27">cstring_free</a> (s);
00775   <font class="keywordflow">return</font> res;
00776 }
00777 
00778 <font class="preprocessor"># ifndef NOLCL</font>
00779 <font class="preprocessor"></font><font class="comment">/*@only@*/</font> cstring 
<a name="l00780"></a><a class="code" href="cstring_c.html#a40">00780</a> <a class="code" href="cstring_c.html#a40">cstring_concatChars</a> (cstring s, <font class="keywordtype">char</font> *t)<font class="keyword"></font>
00781 <font class="keyword"></font>{
00782   cstring res = <a class="code" href="cstring_c.html#a42">cstring_concat</a> (s, cstring_fromChars (t));
00783   <a class="code" href="cstring_c.html#a27">cstring_free</a> (s);
00784   <font class="keywordflow">return</font> res;
00785 }
00786 <font class="preprocessor"># endif</font>
00787 <font class="preprocessor"></font>
00788 <font class="comment">/*@only@*/</font> cstring 
<a name="l00789"></a><a class="code" href="cstring_c.html#a41">00789</a> <a class="code" href="cstring_c.html#a41">cstring_concatLength</a> (cstring s1, <font class="keywordtype">char</font> *s2, <font class="keywordtype">int</font> len)<font class="keyword"></font>
00790 <font class="keyword"></font>{
00791   cstring tmp = <a class="code" href="cstring_c.html#a10">cstring_copyLength</a> (s2, len);
00792   cstring res = <a class="code" href="cstring_c.html#a42">cstring_concat</a> (s1, tmp);
00793   <a class="code" href="cstring_c.html#a27">cstring_free</a> (tmp);
00794   <a class="code" href="cstring_c.html#a27">cstring_free</a> (s1);
00795 
00796   <font class="keywordflow">return</font> res;
00797 }
00798 
00799 <font class="comment">/*@only@*/</font> cstring 
<a name="l00800"></a><a class="code" href="cstring_c.html#a42">00800</a> <a class="code" href="cstring_c.html#a42">cstring_concat</a> (cstring s, cstring t)<font class="keyword"></font>
00801 <font class="keyword"></font>{
00802   <font class="keywordtype">char</font> *ret = <a class="code" href="general_c.html#a29">mstring_create</a> (cstring_length (s) + <a class="code" href="cstring_c.html#a30">cstring_length</a> (t));
00803 
00804   <font class="keywordflow">if</font> (cstring_isDefined (s))
00805     {
00806       strcpy (ret, s);
00807     }
00808   <font class="keywordflow">if</font> (cstring_isDefined (t))
00809     {
00810       strcat (ret, t);
00811     }
00812 
00813   <font class="keywordflow">return</font> ret;
00814 }
00815 
00816 <font class="comment">/*@notnull@*/</font> <font class="comment">/*@only@*/</font> cstring 
<a name="l00817"></a><a class="code" href="cstring_c.html#a43">00817</a> <a class="code" href="cstring_c.html#a43">cstring_prependCharO</a> (<font class="keywordtype">char</font> c, <font class="comment">/*@only@*/</font> cstring s1)<font class="keyword"></font>
00818 <font class="keyword"></font>{
00819   cstring res = <a class="code" href="cstring_c.html#a44">cstring_prependChar</a> (c, s1);
00820 
00821   <a class="code" href="cstring_c.html#a27">cstring_free</a> (s1);
00822   <font class="keywordflow">return</font> (res);
00823 }
00824 
00825 <font class="comment">/*@notnull@*/</font> <font class="comment">/*@only@*/</font> cstring 
<a name="l00826"></a><a class="code" href="cstring_c.html#a44">00826</a> <a class="code" href="cstring_c.html#a44">cstring_prependChar</a> (<font class="keywordtype">char</font> c, <font class="comment">/*@temp@*/</font> cstring s1)<font class="keyword"></font>
00827 <font class="keyword"></font>{
00828   <font class="keywordtype">int</font> l = <a class="code" href="cstring_c.html#a30">cstring_length</a> (s1);
00829   <font class="keywordtype">char</font> *s = (<font class="keywordtype">char</font> *) dmalloc (<font class="keyword">sizeof</font> (*s) * (l + 2));
00830   
00831   *(s) = c;
00832 
00833   <font class="keywordflow">if</font> (cstring_isDefined (s1)) 
00834     {
00835       <font class="comment">/*@-mayaliasunique@*/</font> 
00836       strcpy (s + 1, s1);
00837       <font class="comment">/*@=mayaliasunique@*/</font> 
00838     }
00839 
00840   *(s + l + 1) = <font class="charliteral">'\0'</font>;
00841   <font class="keywordflow">return</font> s;
00842 }
00843 
00844 <font class="preprocessor"># ifndef NOLCL</font>
00845 <font class="preprocessor"></font><font class="keywordtype">bool</font>
<a name="l00846"></a><a class="code" href="cstring_c.html#a45">00846</a> <a class="code" href="cstring_c.html#a45">cstring_hasNonAlphaNumBar</a> (cstring s)<font class="keyword"></font>
00847 <font class="keyword"></font>{
00848   <font class="keywordtype">int</font> c;
00849 
00850   <font class="keywordflow">if</font> (cstring_isUndefined (s)) <font class="keywordflow">return</font> FALSE;
00851 
00852   <font class="keywordflow">while</font> ((c = (<font class="keywordtype">int</font>) *s) != (<font class="keywordtype">int</font>) <font class="charliteral">'\0'</font>)
00853     {
00854       <font class="keywordflow">if</font> ((isalnum (c) == 0) &amp;&amp; (c != (<font class="keywordtype">int</font>) <font class="charliteral">'_'</font>)
00855           &amp;&amp; (c != (<font class="keywordtype">int</font>) <font class="charliteral">'.'</font>) &amp;&amp; (c != (<font class="keywordtype">int</font>) CONNECTCHAR))
00856         {
00857           <font class="keywordflow">return</font> TRUE;
00858         }
00859 
00860       s++;
00861     }
00862   <font class="keywordflow">return</font> FALSE;
00863 }
00864 <font class="preprocessor"># endif</font>
00865 <font class="preprocessor"></font>
00866 <font class="comment">/*@only@*/</font> <font class="comment">/*@notnull@*/</font> cstring 
<a name="l00867"></a><a class="code" href="cstring_c.html#a46">00867</a> <a class="code" href="cstring_c.html#a46">cstring_create</a> (<font class="keywordtype">int</font> n)<font class="keyword"></font>
00868 <font class="keyword"></font>{
00869   <font class="keywordtype">char</font> *s = dmalloc (<font class="keyword">sizeof</font> (*s) * (n + 1));
00870 
00871   *s = <font class="charliteral">'\0'</font>;
00872   <font class="keywordflow">return</font> s;
00873 }
00874 
00875 <font class="preprocessor"># ifndef NOLCL</font>
<a name="l00876"></a><a class="code" href="cstring_c.html#a47">00876</a> <font class="preprocessor"></font>lsymbol <a class="code" href="cstring_c.html#a47">cstring_toSymbol</a> (cstring s)<font class="keyword"></font>
00877 <font class="keyword"></font>{
00878   lsymbol res = <a class="code" href="lsymbol_c.html#a14">lsymbol_fromChars</a> (cstring_toCharsSafe (s));
00879 
00880   <a class="code" href="cstring_c.html#a27">cstring_free</a> (s);
00881   <font class="keywordflow">return</font> res;
00882 }
00883 <font class="preprocessor"># endif</font>
00884 <font class="preprocessor"></font>
<a name="l00885"></a><a class="code" href="cstring_c.html#a48">00885</a> cstring <a class="code" href="cstring_c.html#a48">cstring_bsearch</a> (cstring key, <font class="keywordtype">char</font> **table, <font class="keywordtype">int</font> nentries)<font class="keyword"></font>
00886 <font class="keyword"></font>{
00887   <font class="keywordflow">if</font> (cstring_isDefined (key))
00888     {
00889       <font class="keywordtype">int</font> low = 0;
00890       <font class="keywordtype">int</font> high = nentries;
00891       <font class="keywordtype">int</font> mid = (high + low + 1) / 2;
00892       <font class="keywordtype">int</font> last = -1;
00893       cstring res = cstring_undefined;
00894 
00895       <font class="keywordflow">while</font> (low &lt;= high &amp;&amp; mid &lt; nentries)
00896         {
00897           <font class="keywordtype">int</font> cmp;
00898 
00899           llassert (mid != last);
00900           llassert (mid &gt;= 0 &amp;&amp; mid &lt; nentries);
00901 
00902           cmp = <a class="code" href="cstring_c.html#a25">cstring_compare</a> (key, table[mid]);
00903           
00904           <font class="keywordflow">if</font> (cmp == 0)
00905             {
00906               res = table[mid];
00907               <font class="keywordflow">break</font>;
00908             }
00909           <font class="keywordflow">else</font> <font class="keywordflow">if</font> (cmp &lt; 0) <font class="comment">/* key is before table[mid] */</font>
00910             {
00911               high = mid - 1;
00912             }
00913           <font class="keywordflow">else</font> <font class="comment">/* key of after table[mid] */</font>
00914             {
00915               low = mid + 1;
00916             }
00917 
00918           last = mid;
00919           mid = (high + low + 1) / 2;
00920         }
00921 
00922       <font class="keywordflow">if</font> (mid != 0 &amp;&amp; mid &lt; nentries - 1)
00923         {
00924           llassert (cstring_compare (key, table[mid - 1]) &gt; 0);
00925           llassert (cstring_compare (key, table[mid + 1]) &lt; 0);
00926         }
00927 
00928       <font class="keywordflow">return</font> res;
00929     }
00930   
00931   <font class="keywordflow">return</font> cstring_undefined;
00932 }
00933 
<a name="l00934"></a><a class="code" href="cstring_c.html#a49">00934</a> <font class="keyword">extern</font> <font class="comment">/*@observer@*/</font> cstring <a class="code" href="cstring_c.html#a49">cstring_advanceWhiteSpace</a> (cstring s)<font class="keyword"></font>
00935 <font class="keyword"></font>{
00936   <font class="keywordflow">if</font> (cstring_isDefined (s)) {
00937     <font class="keywordtype">char</font> *t = s;
00938 
00939     <font class="keywordflow">while</font> (*t != <font class="charliteral">'\0'</font> &amp;&amp; isspace ((<font class="keywordtype">int</font>) *t)) {
00940       t++;
00941     }
00942 
00943     <font class="keywordflow">return</font> t;
00944   }
00945   
00946   <font class="keywordflow">return</font> cstring_undefined;
00947 }
00948     
00949 
00950 
</div></pre><hr><address><small>Generated at Fri Nov 3 18:57:40 2000 for LCLint by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.3 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2000</small></address>
</body>
</html>
